"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[4429],{14563:(e,t,l)=>{l.r(t),l.d(t,{default:()=>f});var a=l(57560),i=l(4139),r=l(87233),n=l(64661),o=l(14341),s=l(67535),d=l(9950),c=l(86898),u=l(9912),m=l(25411),x=l(61977),v=l(87125),p=l(44414);const h=(0,d.memo)((e=>{let{index:t,style:l,data:a}=e;const{segments:i,handleOnChange:r,onPaste:n}=a,s=i[t],[c,u]=(0,d.useState)("");(0,d.useEffect)((()=>{u(s)}),[s]);return(0,p.jsxs)(v.tf,{index:t,style:l,children:[(0,p.jsx)(v.VW,{width:"20%",children:t+1}),(0,p.jsx)(v.VW,{width:"80%",children:(0,p.jsx)(o.A,{type:"text",value:c,onChange:e=>{let{value:l}=e.target;l=l.replace(/[^\w]/gi,"").toUpperCase(),u(l),r(l,t)},onPaste:e=>{e.preventDefault();const l=e.clipboardData.getData("Text");if(l.includes("\n"))n(e,t);else{let a=e.target.value+l;a=a.replace(/[^\w]/gi,"").toUpperCase(),u(a),r(a,t)}}})})]},t)}));var y=l(22759),j=l(14351);const b="ENTER_SERIAL_NUMBERS",A="GENERATE_SERIAL_NUMBERS",f=e=>{let{handleCloseSerial:t,closeCss:l,quantity:f,serialNumbers:g,setSerialNumbers:S,hideAuto:I=!1}=e;const[N,D]=(0,d.useState)(b),[C,k]=(0,d.useState)(""),[w,q]=(0,d.useState)(""),[R,T]=(0,d.useState)(""),[F,L]=(0,d.useState)(!1),[E,M]=(0,d.useState)([]),[_,O]=(0,d.useState)([]),z=(e,t)=>{const l=E;l[t]=e,M(l)},B=(e,t)=>{const l=e.clipboardData.getData("text/plain"),a=E.slice();for(let r=0,n=l.split("\n");r<f&&r<n.length&&r+t<E.length;r++){var i;let e=null===(i=n[r])||void 0===i?void 0:i.replace(/[^\w]/gi,"").toUpperCase().trim();a[r+t]=e}M(a)},W=(e,t,l)=>{if(l){const a=parseInt(l)+parseInt(f),i=Array(a-l).fill().map(((a,i)=>`${e}${i+parseInt(l)}${t}`));O(i)}};return(0,d.useEffect)((()=>{null!==g&&void 0!==g&&g.length?M(g):M(Array(parseInt(f)).fill(""))}),[f,g]),(0,p.jsxs)(j.A,{sx:{width:520},modal:!0,darkTitle:!0,content:!1,children:[(0,p.jsx)(i.Ay,{container:!0,spacing:2,alignItems:"center",sx:{mt:-1},children:(0,p.jsx)(i.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",marginRight:1},children:(0,p.jsx)(a.A,{onClick:t,style:l})})}),(0,p.jsxs)(i.Ay,{container:!0,spacing:2,alignItems:"center",sx:{mt:0},children:[(0,p.jsxs)(i.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"center",padding:"0px"},children:[(0,p.jsxs)(c.A,{children:[N===b&&(0,p.jsx)(c.A,{position:"absolute",marginLeft:"-61px",children:(0,p.jsx)(x.A,{segments:E,setSegments:M})}),(0,p.jsx)(r.A,{color:N===b?"#FFFFFF":"#111111",onClick:()=>{D(b)},style:{cursor:"pointer",fontWeight:700,padding:10,background:N===b?"#1677FF":"#FFFFFF"},children:"Multiple Serial Number"})]}),!I&&(0,p.jsx)(r.A,{color:N===A?"#FFFFFF":"#111111",onClick:()=>{D(A)},style:{cursor:"pointer",fontWeight:700,padding:10,background:N===A?"#1677FF":"#FFFFFF"},children:"With Serial Number"})]}),N===b&&(0,p.jsx)(i.Ay,{item:!0,xs:12,m:5,mt:1,style:{height:400,display:"flex",flexDirection:"column"},children:(0,p.jsxs)(n.A,{style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,p.jsxs)(c.A,{display:"flex",children:[(0,p.jsx)(v.A3,{width:"20%",children:"S.No."}),(0,p.jsx)(v.A3,{width:"80%",children:"Serial Number"})]}),(0,p.jsx)(c.A,{style:{flex:1,display:"flex"},children:(0,p.jsx)(m.Ay,{children:e=>{let{height:t,width:l}=e;return(0,p.jsx)(u.Y1,{height:t,width:l,itemCount:E.length,itemSize:60,itemData:{segments:E,handleOnChange:z,onPaste:B},overscanCount:5,children:h})}})})]})}),N===A&&!I&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(i.Ay,{container:!0,xs:12,m:1,ml:6,mr:6,children:[(0,p.jsx)(i.Ay,{item:!0,xs:2,m:1,children:"Prefix"}),(0,p.jsx)(i.Ay,{item:!0,xs:3,mr:3,children:(0,p.jsx)(o.A,{name:"prefix",value:C,onChange:e=>{if(e.target.value){let t=e.target.value;t=t.replace(/[^\w]/gi,"").toUpperCase(),k(t),W(t,w,R)}else k(""),W("",w,R)}})}),(0,p.jsx)(i.Ay,{item:!0,xs:2,m:1,children:"Suffix"}),(0,p.jsx)(i.Ay,{item:!0,xs:3,children:(0,p.jsx)(o.A,{name:"suffix",value:w,onChange:e=>{if(e.target.value){let t=e.target.value;t=t.replace(/[^\w]/gi,"").toUpperCase(),q(t),W(C,t,R)}else q(""),W(C,"",R)}})})]}),(0,p.jsxs)(i.Ay,{container:!0,xs:12,ml:6,mr:7,pr:.5,children:[(0,p.jsx)(i.Ay,{item:!0,xs:3,p:1,children:"Range From"}),(0,p.jsx)(i.Ay,{item:!0,xs:9,mb:1,children:(0,p.jsx)(o.A,{fullWidth:!0,type:"text",name:"rangeFrom",value:R,onChange:e=>{(""===e.target.value||/^[0-9\b]+$/.test(e.target.value))&&(T(e.target.value),W(C,w,e.target.value),""===e.target.value&&O([]))}})}),(0,p.jsx)(i.Ay,{item:!0,xs:3,p:1,children:"Range To"}),(0,p.jsx)(i.Ay,{item:!0,xs:9,children:(0,p.jsx)(o.A,{fullWidth:!0,name:"rangeTo",type:"number",value:parseInt(R)+parseInt(f)-1,disabled:!0})})]}),(0,p.jsx)(i.Ay,{item:!0,xs:12,mx:5,mt:1,mb:2,style:{height:300,display:"flex",flexDirection:"column"},children:(0,p.jsxs)(n.A,{style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,p.jsxs)(c.A,{display:"flex",style:{height:45},children:[(0,p.jsx)(v.A3,{width:"20%",children:"S.No."}),(0,p.jsx)(v.A3,{width:"80%",children:"Serial Number"})]}),(0,p.jsx)(c.A,{style:{flex:1,display:"flex"},children:(0,p.jsx)(m.Ay,{children:e=>{let{height:t,width:l}=e;return(0,p.jsx)(u.Y1,{height:t,width:l,itemCount:_.length,itemSize:45,itemData:{originalData:_},overscanCount:5,children:y.Ay})}})})]})})]})]}),F&&(0,p.jsx)(r.A,{m:5,mt:-4,color:"red",children:"Enter valid serial numbers"}),(0,p.jsx)(i.Ay,{item:!0,xs:12,mb:2,sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,p.jsx)(s.A,{size:"small",onClick:()=>{let e=[];e=N===A?_:E.filter((e=>""!==e));const l=e.length!==parseInt(f);L(l),l||(S(e),t(!0))},variant:"contained",color:"primary",children:"Save"})})]})}},54429:(e,t,l)=>{l.r(t),l.d(t,{default:()=>W});var a=l(28429),i=l(9950),r=l(27081),n=l(62472),o=l(88848),s=l(9449),d=l(60666),c=l(4139),u=l(67535),m=l(74745),x=l(26473),v=l(3147),p=l(96951),h=l(84601),y=l(29024),j=l(52867),b=l(46091),A=l(44414);const f=e=>{var t,l;let{reqData:a,strTransactionTypeId:n,setUpdatedReqData:o,showMaterials:f,onNext:g,onBack:S}=e;const[I,N]=(0,i.useState)(),D=(0,s.mN)({resolver:(0,x.t)(d.Ik().shape({toStoreId:h.A.toStore,actualReceiptDate:h.A.actualReceiptDate,...!(0,j.g6)(I)&&{eWayBillDate:h.A.requiredWithLabel("E-Way Bill Date")}})),defaultValues:{},mode:"all"}),{setValue:C,handleSubmit:k,watch:w}=D,q=(0,r.wA)(),[R,T]=(0,i.useState)([]),[F,L]=(0,i.useState)([]),[E,M]=(0,i.useState)([]),[_,O]=(0,i.useState)(null),{organizationStores:z}=(0,v.E)(),B=(null===z||void 0===z||null===(t=z.organizationStoreObject)||void 0===t?void 0:t.rows)||[];(0,i.useEffect)((()=>{const e=e=>{Object.entries(e||{}).forEach((e=>{let[t,l]=e;"remarks"===t?C("remarks",""):C(t,l||"")}))};if(a&&a.length>0){var t,l,i,r,n,o,s,d,c,u,m,x,v,p,h,y,j,b,A,f;const g=a,S=null===g||void 0===g?void 0:g.filter((e=>+e.quantity<0));T([null===S||void 0===S||null===(t=S[0])||void 0===t?void 0:t.project]),L([null===S||void 0===S||null===(l=S[0])||void 0===l?void 0:l.organization]),M([null===S||void 0===S||null===(i=S[0])||void 0===i?void 0:i.organization_store_location]),e(null===g||void 0===g?void 0:g[0]),e(null===S||void 0===S||null===(r=S[0])||void 0===r?void 0:r.stock_ledger_detail),C("invoiceDate",null===S||void 0===S||null===(n=S[0])||void 0===n||null===(o=n.stock_ledger_detail)||void 0===o||null===(s=o.invoiceDate)||void 0===s||null===(d=s.split("T"))||void 0===d?void 0:d[0]),C("ewayBillDate",null===g||void 0===g||null===(c=g[0])||void 0===c||null===(u=c.ewayBillDate)||void 0===u||null===(m=u.split("T"))||void 0===m?void 0:m[0]),C("actualReceiptDate",null===g||void 0===g||null===(x=g[0])||void 0===x||null===(v=x.actualReceiptDate)||void 0===v||null===(p=v.split("T"))||void 0===p?void 0:p[0]),C("invoiceNumber",null===S||void 0===S||null===(h=S[0])||void 0===h||null===(y=h.stock_ledger_detail)||void 0===y?void 0:y.referenceDocumentNumber),C("projectId",null===g||void 0===g||null===(j=g[0])||void 0===j||null===(b=j.project)||void 0===b?void 0:b.id),C("fromStoreId",null===S||void 0===S||null===(A=S[0])||void 0===A?void 0:A.storeId),C("fromStoreLocationId",null===S||void 0===S||null===(f=S[0])||void 0===f?void 0:f.storeLocationId)}}),[a,C]);const W=w("eWayBillNumber");(0,i.useEffect)((()=>{N(W)}),[W]),(0,i.useEffect)((()=>{if(a&&a.length>0&&a[0]&&a[0].stock_ledger_detail&&a[0].stock_ledger_detail.toStoreId)C("toStoreId",a[0].stock_ledger_detail.toStoreId);else if(H){var e;C("toStoreId",null===(e=H[0])||void 0===e?void 0:e.toStoreId)}}));(0,i.useEffect)((()=>{a&&O(a[0].requestNumber)}),[a]),(0,i.useEffect)((()=>{var e,t,l,i,r;null!==a&&void 0!==a&&null!==(e=a[0])&&void 0!==e&&e.otherStoreId&&null!==(null===a||void 0===a||null===(t=a[0])||void 0===t?void 0:t.otherStoreId)?C("toStoreId",null===a||void 0===a||null===(l=a[0])||void 0===l?void 0:l.otherStoreId):q((0,y.exE)({transactionTypeId:n,referenceDocumentNumber:_,projectId:null===a||void 0===a||null===(i=a[0])||void 0===i?void 0:i.projectId,fromStoreId:null===a||void 0===a||null===(r=a[0])||void 0===r?void 0:r.storeId}))}),[q,n,_,C,a]);const{transactionRequest:U}=(0,b.b)(),H=null===U||void 0===U||null===(l=U.requestDetails)||void 0===l?void 0:l.rows;return(0,A.jsx)(A.Fragment,{children:a&&(0,A.jsx)(p.Op,{methods:D,onSubmit:k((e=>{const{toStoreId:t,eWayBillNumber:l,eWayBillDate:i,actualReceiptDate:r,remarks:n,projectId:s}=e,d=a.map((e=>{var o;return{...e,...null===a||void 0===a||null===(o=a[0])||void 0===o?void 0:o.stock_ledger_detail,quantity:e.quantity,projectId:s,toStoreId:t,eWayBillNumber:l,eWayBillDate:i,actualReceiptDate:r,remarks:n,stock_ledgers:a}}));o(d),g()})),children:(0,A.jsxs)(c.Ay,{container:!0,spacing:4,mt:4,children:[(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,style:{display:"none"},children:(0,A.jsx)(p.eu,{name:"projectId",label:"Project",menus:R,disable:!0,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,style:{display:"none"},children:(0,A.jsx)(p.eu,{name:"fromStoreId",label:"Company Store",menus:F,disable:!0,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,style:{display:"none"},children:(0,A.jsx)(p.eu,{name:"fromStoreLocationId",label:"Company Store Location",menus:E,disable:!0,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,style:{display:"none"},children:(0,A.jsx)(p.eu,{name:"toStoreId",label:"To Company Store",menus:B,disable:!0,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:(0,A.jsx)(p.o3,{name:"invoiceNumber",type:"text",label:"Invoice Number",disabled:!0,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:(0,A.jsx)(p.o3,{name:"invoiceDate",type:"date",label:"Invoice Date",disabled:!0,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:(0,A.jsx)(p.o3,{name:"transporterName",type:"text",label:"Transporter Name",disabled:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:(0,A.jsx)(p.o3,{name:"transporterContactNumber",type:"number",label:"Contact Number",disabled:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:(0,A.jsx)(p.o3,{name:"vehicleNumber",type:"text",label:"Vehicle Number",disabled:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:(0,A.jsx)(p.o3,{name:"lrNumber",type:"text",label:"LR Number",disabled:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:(0,A.jsx)(p.o3,{name:"eWayBillNumber",type:"text",label:"E-Way Bill Number",disabled:f})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:(0,A.jsx)(p.o3,{name:"eWayBillDate",type:"date",label:"E-Way Bill Date",disabled:f||(0,j.g6)(I)})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:(0,A.jsx)(p.o3,{name:"actualReceiptDate",type:"date",label:"Actual Receipt Date",disabled:f,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:(0,A.jsx)(p.o3,{name:"remarks",type:"text",label:"Remarks",disabled:f})}),f?(0,A.jsx)(c.Ay,{container:!0,sx:{mt:3,mb:3},children:(0,A.jsx)(c.Ay,{item:!0,md:12,xl:12,children:(0,A.jsx)(m.A,{})})}):(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(c.Ay,{container:!0,spacing:4,children:(0,A.jsxs)(c.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px",mt:3},children:[(0,A.jsx)(u.A,{onClick:S,size:"small",variant:"outlined",color:"primary",children:"Back"}),(0,A.jsx)(u.A,{type:"submit",size:"small",variant:"contained",color:"primary",children:"Next"})]})})})]})})})};var g=l(87233),S=l(65669),I=l(12952),N=l(62605),D=l(99635),C=l(53065),k=l(57073),w=l(36089),q=l(10158);const R=e=>{let{onEdit:t,onDelete:l}=e;return(0,A.jsxs)("div",{children:[(0,A.jsx)(C.A,{title:"Edit",placement:"bottom",children:(0,A.jsx)(k.A,{color:"secondary",onClick:t,children:(0,A.jsx)(w.A,{})})}),l&&(0,A.jsx)(C.A,{title:"Delete",placement:"bottom",children:(0,A.jsx)(k.A,{color:"secondary",onClick:l,children:(0,A.jsx)(q.A,{})})})]})};var T=l(95615),F=l(14563);const L=[{Header:"Actions",accessor:"actions"},{Header:"Name",accessor:"material.name"},{Header:"Code",accessor:"material.code"},{Header:"Quantity",accessor:"quantity"},{Header:"UOM",accessor:"uom.name"},{Header:"To Store Location",accessor:"toStoreLocationName"}],E={cursor:"pointer",fontSize:24},M=e=>{var t,l;let{pending:a,updatedReqData:n,setUpdatedReqData:o,onBack:m,onSubmit:v}=e;const[j,b]=(0,i.useState)(null),[f,C]=(0,i.useState)(!1),[k,w]=(0,i.useState)([]),[q,M]=(0,i.useState)(!1),_=(0,r.wA)(),O=(0,s.mN)({resolver:(0,x.t)(d.Ik().shape({toStoreLocationId:h.A.toStoreLocationId})),defaultValues:{},mode:"all"}),{setValue:z,handleSubmit:B}=O,W=(0,i.useMemo)((()=>(null===n||void 0===n?void 0:n.map(((e,t)=>({...e,quantity:Math.abs(e.quantity),actions:(0,A.jsx)(R,{onEdit:()=>b(t)})}))))||[]),[n]),U=null===W||void 0===W?void 0:W[j],H=!isNaN(j)&&!!U;(0,i.useEffect)((()=>{if(!U)return;var e;e=U,Object.entries(e).forEach((e=>{let[t,l]=e;z(t,l)}))}),[U,z]);const{companyStoreLocations:V}=(0,I.V)(),P=(null===V||void 0===V||null===(t=V.companyStoreLocationsObject)||void 0===t?void 0:t.rows)||[],$=P.filter((e=>{var t;return e.organizationStoreId===(null===n||void 0===n||null===(t=n[0])||void 0===t?void 0:t.toStoreId)})),{allSerialNumbers:G}=(0,N.t)(),{serialNumbersData:Y}=(0,i.useMemo)((()=>{var e;return{serialNumbersData:(null===G||void 0===G?void 0:G.data.rows)||[],countSN:(null===G||void 0===G||null===(e=G.data)||void 0===e?void 0:e.count)||0}}),[G]),Q=()=>{M(!1)},X=e=>{let t=[];return e&&e.length>0&&e.map((e=>{t.push(e.serialNumber)})),w(t),t};(0,i.useEffect)((()=>{if(U){var e,t,l,a;const i=U.stock_ledgers.filter((e=>e.materialId===(null===U||void 0===U?void 0:U.materialId)));_((0,y.qau)({project:null===(e=i[0])||void 0===e?void 0:e.projectId,store:null===(t=i[0])||void 0===t?void 0:t.storeId,storeLocation:null===(l=i[0])||void 0===l?void 0:l.storeLocationId,stockLedger:null===(a=i[0])||void 0===a?void 0:a.id,material:null===U||void 0===U?void 0:U.materialId}))}}),[U,_]);const Z=["faulty","scrap","missing","consumed","billing","installed","installer","old","service-center","service center","defective","damage","non-repairable","non repairable"];return(0,A.jsxs)(p.Op,{methods:O,onSubmit:B((e=>{var t;const{toStoreLocationId:l}=e;let a=[...n];a[j]={...a[j],toStoreLocationId:l,serialNumber:Y,toStoreLocationName:null===P||void 0===P||null===(t=P.find((e=>e.id===l)))||void 0===t?void 0:t.name},o(a),b(null)})),children:[U&&(0,A.jsxs)(c.Ay,{container:!0,spacing:2,sx:{mb:4},children:[(0,A.jsx)(c.Ay,{item:!0,xs:12,md:4,children:(0,A.jsx)(p.o3,{name:"material.code",type:"text",label:"Code",disabled:!0,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,xs:12,md:4,children:(0,A.jsx)(p.o3,{name:"material.name",type:"text",label:"Material",disabled:!0,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,xs:12,md:4,xl:2,children:(0,A.jsx)(p.eu,{name:"toStoreLocationId",label:"To Store Location",menus:$&&$.filter((e=>Z.every((t=>!e.name.toLowerCase().includes(t))))),required:!0})}),(0,A.jsx)(c.Ay,{item:!0,xs:12,md:2,children:(0,A.jsx)(p.o3,{name:"quantity",type:"number",label:"Quantity",disabled:!0,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,xs:12,md:2,children:(0,A.jsx)(p.o3,{name:"uom.name",type:"text",label:"UOM",disabled:!0,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,xs:12,md:1,style:{display:"none"},children:(0,A.jsx)(p.o3,{name:"uomId",type:"text",label:"UOMId",disabled:!0,required:!0})}),(0,A.jsx)(c.Ay,{item:!0,md:2,sx:{textAlign:"center"},children:(null===U||void 0===U||null===(l=U.material)||void 0===l?void 0:l.isSerialNumber)&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(g.A,{mb:-1,children:"Serial No"})," ",(0,A.jsx)("br",{}),(0,A.jsx)(u.A,{size:"small",onClick:()=>{X(Y),C(!0)},variant:"contained",color:"primary",children:"View"})]})}),(0,A.jsx)(c.Ay,{item:!0,xs:12,md:6,mt:3.5,sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:(0,A.jsx)(u.A,{size:"small",type:"submit",variant:"contained",color:"primary",children:"Update"})})]}),(0,A.jsx)(S.A,{open:q,onClose:Q,"aria-labelledby":"modal-modal-title",children:(0,A.jsx)(F.default,{handleCloseSerial:Q,closeCss:E,quantity:n.quantity<0?Math.abs(n.quantity):n.quantity,setSerialNumbers:X})}),f&&(0,A.jsx)(T.default,{open:f,onClose:()=>{C(!1)},serialNumberData:k.slice(0,n.quantity<0?Math.abs(n.quantity):n.quantity)}),(0,A.jsx)(D.default,{title:"MIN",hideHeader:!0,hideActions:!0,hidePagination:!0,data:W,columns:L,count:W.length}),(0,A.jsx)(c.Ay,{container:!0,spacing:2,alignItems:"center",sx:{mt:2},children:(0,A.jsxs)(c.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px"},children:[(0,A.jsx)(u.A,{onClick:m,size:"small",variant:"outlined",color:"primary",children:"Back"}),(0,A.jsx)(u.A,{disabled:H||a,size:"small",type:"submit",variant:"contained",onClick:v,color:"primary",children:"Submit"})]})})]})};var _=l(14351),O=l(71826),z=l(62054),B=l(52351);const W=()=>{const[e,t]=(0,i.useState)(null),[l,s]=(0,i.useState)([]),[d,c]=(0,i.useState)(!1),[u,m]=(0,i.useState)(!1),x=(0,a.Zp)(),v=(0,r.wA)(),{masterMakerLovs:p}=(0,o.$)(),h=p.masterMakerLovsObject.rows,b=(0,j.x)(h,"STOGRN"),g=(0,j.x)(h,"COMPANY"),S=(0,j.x)(h,"STR"),I=(0,j.x)(h,"STO"),N=e=>{let t=[];return e&&e.length>0&&e.map((e=>{t.push(e.serialNumber)})),t},D=e=>{let t=[];return e&&e.length>0&&e.map((e=>{t.push(e.id)})),t};return(0,i.useEffect)((()=>{v((0,y.Ru7)({organizationId:g}))}),[v,g]),(0,A.jsxs)(A.Fragment,{children:[u&&(0,A.jsx)(B.A,{}),(0,A.jsxs)(_.A,{title:"STOGRN (Stock Transfer Order GRN)",children:[(0,A.jsx)(n.A,{type:"stockLedger",transactionType:"STO",showFromStoreAddress:!0,fromStoreLabel:"Company Store",fromStoreType:"COMPANY",disableAll:!!e,setReqData:e=>{t(e)},showBranchAlso:!0,getFromOtherStore:!0}),(0,A.jsx)(f,{reqData:e,setUpdatedReqData:e=>{s(e)},showMaterials:d,onNext:()=>c(!0),onBack:()=>{t(null),s(null)},strTransactionTypeId:S,stoTransactionTypeId:I}),d&&(0,A.jsx)(M,{pending:u,onSubmit:async()=>{var t,a,i;m(!0);const{referenceDocumentNumber:r,projectId:n,poNumber:o,poDate:s,lrNumber:d,transporterName:c,transporterContactNumber:u,vehicleNumber:v,invoiceDate:p,actualReceiptDate:h,remarks:y,toStoreId:A,storeId:f}=(null===l||void 0===l?void 0:l[0])||{},g=await(async e=>{const t=await(0,O.default)("/organization-store-details",{params:e});var l;return null!==t&&void 0!==t&&t.success?null===t||void 0===t||null===(l=t.data)||void 0===l?void 0:l.data:((0,z.A)("Something went wrong",{variant:"error"}),!1)})(A);if(!g)return;const S={transactionTypeId:b,requestNumber:r,poNumber:o,poDate:s,lrNumber:d,transporterName:c,transporterContactNumber:u,vehicleNumber:v,invoiceDate:p,invoiceNumber:r,actualReceiptDate:h,remarks:y,stoIds:D(e),fromStoreId:f,stock_ledgers:(null===l||void 0===l?void 0:l.map((e=>{var t;const{toStoreLocationId:l,materialId:a,uomId:i,quantity:o,rate:s,value:d,tax:c,storeLocationId:u}=e;return{organizationId:null===(t=j.ow.getTopmostOrganization(g))||void 0===t?void 0:t.id,transactionTypeId:b,projectId:n,requestNumber:r,storeId:A,storeLocationId:l,fromStoreLocationId:u,materialId:a,uomId:i,quantity:Math.abs(o),rate:s||0,value:d,tax:c,remarks:y,serialNumber:N(e.serialNumber)||[]}})))||[]};if((0,j.Rh)(S.stock_ledgers,"storeLocationId"))return void m(!1);const I=await(0,O.default)("/sto-grn-transaction-create",{method:"POST",body:S,timeoutOverride:12e4});var C;if(!I.success)return(0,z.A)((null===I||void 0===I||null===(C=I.error)||void 0===C?void 0:C.message)||"Operation failed. Please try again!",{variant:"error"}),void m(!1);const k=null!==(t=null===(a=I.data)||void 0===a?void 0:a.data)&&void 0!==t?t:{},w=k.referenceDocumentNumber||(null===(i=k[0])||void 0===i?void 0:i.referenceDocumentNumber);(0,z.A)(w?`Transaction created with reference number: ${w}`:"Transaction created successfully!",{variant:"success",autoHideDuration:1e4}),m(!1),x("/sto-grn-receipt")},updatedReqData:l,setUpdatedReqData:s,getSerials:N,onBack:()=>c(!1)})]})]})}},10158:(e,t,l)=>{var a=l(24994);t.A=void 0;var i=a(l(79526)),r=l(44414);t.A=(0,i.default)((0,r.jsx)("path",{d:"M16 9v10H8V9zm-1.5-6h-5l-1 1H5v2h14V4h-3.5zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2z"}),"DeleteOutlined")},64661:(e,t,l)=>{l.d(t,{A:()=>v});var a=l(58168),i=l(98587),r=l(9950),n=l(72004),o=l(88465),s=l(18463),d=l(59254),c=l(86957),u=l(44414);const m=["className","component"],x=(0,d.Ay)("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,t)=>t.root})({width:"100%",overflowX:"auto"}),v=r.forwardRef((function(e,t){const l=(0,s.b)({props:e,name:"MuiTableContainer"}),{className:r,component:d="div"}=l,v=(0,i.A)(l,m),p=(0,a.A)({},l,{component:d}),h=(e=>{const{classes:t}=e;return(0,o.A)({root:["root"]},c.I,t)})(p);return(0,u.jsx)(x,(0,a.A)({ref:t,as:d,className:(0,n.A)(h.root,r),ownerState:p},v))}))},86957:(e,t,l)=>{l.d(t,{A:()=>n,I:()=>r});var a=l(1763),i=l(423);function r(e){return(0,i.Ay)("MuiTableContainer",e)}const n=(0,a.A)("MuiTableContainer",["root"])}}]);