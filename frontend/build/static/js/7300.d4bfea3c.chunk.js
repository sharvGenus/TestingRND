"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[7300],{88848:(e,t,r)=>{r.d(t,{$:()=>o});var s=r(9950),a=r(27081);const o=()=>{const[e,t]=(0,s.useState)({masterMakerLovsObject:{},error:"",loading:!0}),[r,o]=(0,s.useState)({masterMakerLovsObject:{},error:"",loading:!0}),[i,n]=(0,s.useState)({masterObject:[],error:"",loading:!0}),[l,d]=(0,s.useState)({masterObject:[],error:"",loading:!0}),[c,u]=(0,s.useState)({masterObject:[],error:"",loading:!0}),[m,v]=(0,s.useState)({currencyObject:[],error:"",loading:!0}),[g,S]=(0,s.useState)({gstStatusObject:[],error:"",loading:!0}),[f,p]=(0,s.useState)({paymentTermObject:[],error:"",loading:!0}),[k,b]=(0,s.useState)({incotermsObject:[],error:"",loading:!0}),[y,O]=(0,s.useState)({titleObject:[],error:"",loading:!0}),[j,M]=(0,s.useState)({masterMakerLovHistoryObject:{},error:"",loading:!0}),h=(0,a.d4)((e=>e.masterMakerLov||{})),L=(0,a.d4)((e=>e.masterMakerLovList||{})),A=(0,a.d4)((e=>e.lovsForMasterName||[])),N=(0,a.d4)((e=>e.lovsForMasterNameSecond||[])),T=(0,a.d4)((e=>e.lovsForMasterNameThird||[])),w=(0,a.d4)((e=>e.currency||[])),x=(0,a.d4)((e=>e.gstStatus||[])),C=(0,a.d4)((e=>e.paymentTerm||[])),P=(0,a.d4)((e=>e.incoterms||[])),D=(0,a.d4)((e=>e.title||[])),E=(0,a.d4)((e=>e.masterMakerLovHistory||{}));return(0,s.useEffect)((()=>{t((e=>({...e,...h})))}),[h]),(0,s.useEffect)((()=>{o((e=>({...e,...L})))}),[L]),(0,s.useEffect)((()=>{n((e=>({...e,...A})))}),[A]),(0,s.useEffect)((()=>{d((e=>({...e,...N})))}),[N]),(0,s.useEffect)((()=>{u((e=>({...e,...T})))}),[T]),(0,s.useEffect)((()=>{v((e=>({...e,...w})))}),[w]),(0,s.useEffect)((()=>{S((e=>({...e,...x})))}),[x]),(0,s.useEffect)((()=>{p((e=>({...e,...C})))}),[C]),(0,s.useEffect)((()=>{b((e=>({...e,...P})))}),[P]),(0,s.useEffect)((()=>{O((e=>({...e,...D})))}),[D]),(0,s.useEffect)((()=>{M((e=>({...e,...E})))}),[E]),{masterMakerLovs:e,masterMakerLovsList:r,masterMakerOrgType:i,masterMakerOrgTypeSecond:l,masterMakerOrgTypeThird:c,masterMakerCurrency:m,masterMakerGstStatus:g,masterMakerIncoterms:k,masterMakerPaymentTerm:f,masterMakerLovHistory:j,masterMakerTitle:y}}},60535:(e,t,r)=>{r.r(t),r.d(t,{default:()=>O});var s=r(96583),a=r(9950),o=r(27081),i=r(28429),n=r(88848),l=r(62605),d=r(29024),c=r(52867),u=r(99635),m=r(89649),v=r(14846),g=r(3252),S=r(75682),f=r(83456),p=r(39225),k=r(44414);const b=(0,g.A)((0,a.lazy)((()=>r.e(8820).then(r.bind(r,46439))))),y=[{Header:"Actions",accessor:"actionButtons",disableSortBy:!0},{Header:"Receipt Number",accessor:"referenceDocumentNumber"},{Header:"Project",accessor:"fromProject.name"},{Header:"Organization",accessor:"fromStore.organization.name"},{Header:"Store",accessor:"fromStore.name"},{Header:"Status",accessor:"status",exportAccessor:"isActive"},{Header:"Created Date",accessor:"createdAt"},{Header:"Updated Date",accessor:"updatedAt"},{Header:"Remarks",accessor:"remarks"}],O=()=>{var e,t,r;const g=(0,o.wA)(),{transactionId:O}=(0,i.g)(),[j,M]=(0,a.useState)("closed"),[h,L]=(0,a.useState)(null),[A,N]=(0,a.useState)(!1),[T,w]=(0,a.useState)(null),[x,C]=(0,a.useState)(!1),[P,D]=(0,a.useState)(null),[E,H]=(0,a.useState)(null),{paginations:{pageSize:B,pageIndex:I,forceUpdate:z},setPageIndex:W,refreshPagination:R,setPageSize:_}=(0,m.A)(),{searchString:F,setSearchString:U,accessorsRef:Y,setAccessors:$,forceSearch:G,searchStringTrimmed:J}=(0,p.A)(),{stockLedgerDetailList:K}=(0,l.t)(),{masterMakerOrgType:Q}=(0,n.$)(),V=null===Q||void 0===Q?void 0:Q.masterObject,{data:q,count:X}=(0,a.useMemo)((()=>{var e,t;return{data:(0,c.yN)(null===K||void 0===K||null===(e=K.stockLedgerDetailListObject)||void 0===e?void 0:e.rows).map(((e,t)=>{var r,s,a,o,i,n,l,d;return{...e,...!0===(null===e||void 0===e||null===(r=e.stock_ledgers[0])||void 0===r?void 0:r.isCancelled)?{status:"Cancelled"}:!0===(null===e||void 0===e||null===(s=e.stock_ledgers[0])||void 0===s?void 0:s.isProcessed)?{status:"Processed"}:{status:null},serialNumber:(I*B-B+t+1).toString(),actionButtons:(0,k.jsx)(v.w,{editButton:!0,openPreview:()=>se(t),initiatePrint:()=>ie(t),initiateDownload:()=>oe(t),updateReceipt:()=>ae(e),viewSerialNumbers:()=>{w(t)},disablePrint:+e.sumOfAmounts>(null===(a=e.stock_ledgers)||void 0===a||null===(o=a[0])||void 0===o||null===(i=o.project)||void 0===i?void 0:i.eWayBillLimit)&&!e.eWayBillDate&&!e.eWayBillNumber,disableDownload:+e.sumOfAmounts>(null===(n=e.stock_ledgers)||void 0===n||null===(l=n[0])||void 0===l||null===(d=l.project)||void 0===d?void 0:d.eWayBillLimit)&&!e.eWayBillDate&&!e.eWayBillNumber,noMargins:!0})}}))||[],count:null===K||void 0===K||null===(t=K.stockLedgerDetailListObject)||void 0===t?void 0:t.count,isLoading:null===K||void 0===K?void 0:K.loading,error:null===K||void 0===K?void 0:K.error}}),[K,I,B]),Z=(null===q||void 0===q||null===(e=q[T])||void 0===e?void 0:e.materialData)||[],ee=null===q||void 0===q||null===(t=q[h])||void 0===t?void 0:t.id,te=null===q||void 0===q||null===(r=q[h])||void 0===r?void 0:r.referenceDocumentNumber,re=(0,c.x)(V,"CONSUMPTION");(0,a.useEffect)((()=>{g((0,d.VOH)("TRANSACTION TYPE"))}),[g]),(0,a.useEffect)((()=>{re&&g((0,d.rYL)({pageIndex:I,pageSize:B,transactionTypeId:re,...J&&{searchString:J,accessors:JSON.stringify(Y.current)},sortBy:(null===E||void 0===E?void 0:E[0])||"createdAt",sortOrder:(null===E||void 0===E?void 0:E[1])||"DESC"}))}),[g,O,I,B,re,J,z,E,Y,G]);const se=e=>{M("view"),L(e)},ae=e=>{D(e),N(!0),C(!0)},oe=e=>{M("download"),L(e)},ie=e=>{M("print"),L(e)};return(0,k.jsxs)(k.Fragment,{children:["closed"!==j&&(0,k.jsx)(b,{fetchFromRoute:"/consumption-receipt",apiParams:ee,previewAction:j,onClose:()=>{M("hidden"),L(null)},fileNameForDownload:te}),null!==T&&(0,k.jsx)(f.A,{selectedMaterialList:Z,onClose:()=>{w(null)}}),A&&(0,k.jsx)(s.A,{open:x,onClose:()=>C(!1),scroll:"paper",maxWidth:"xs",disableEscapeKeyDown:!0,children:(0,k.jsx)(S.W,{rowData:P,setOpen:C,refreshPagination:R,title:"Consumption"})}),(0,k.jsx)(u.default,{title:"Consumption Receipt",setPageIndex:W,setPageSize:_,pageIndex:I,pageSize:B,columns:y,data:re?q:[],count:re?X:0,hideAddButton:!0,hideActions:!0,searchConfig:{searchString:F,searchStringTrimmed:J,setSearchString:U,setAccessors:$},sortConfig:{sort:E,setSort:H},exportConfig:{tableName:"consumption_receipt",apiQuery:{transactionTypeId:re}}})]})}}}]);