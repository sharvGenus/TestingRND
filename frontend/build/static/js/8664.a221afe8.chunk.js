"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[8664],{88848:(e,t,r)=>{r.d(t,{$:()=>o});var a=r(9950),s=r(27081);const o=()=>{const[e,t]=(0,a.useState)({masterMakerLovsObject:{},error:"",loading:!0}),[r,o]=(0,a.useState)({masterMakerLovsObject:{},error:"",loading:!0}),[i,l]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[n,d]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[c,u]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[v,m]=(0,a.useState)({currencyObject:[],error:"",loading:!0}),[g,S]=(0,a.useState)({gstStatusObject:[],error:"",loading:!0}),[f,p]=(0,a.useState)({paymentTermObject:[],error:"",loading:!0}),[k,y]=(0,a.useState)({incotermsObject:[],error:"",loading:!0}),[b,j]=(0,a.useState)({titleObject:[],error:"",loading:!0}),[O,M]=(0,a.useState)({masterMakerLovHistoryObject:{},error:"",loading:!0}),h=(0,s.d4)((e=>e.masterMakerLov||{})),L=(0,s.d4)((e=>e.masterMakerLovList||{})),N=(0,s.d4)((e=>e.lovsForMasterName||[])),A=(0,s.d4)((e=>e.lovsForMasterNameSecond||[])),D=(0,s.d4)((e=>e.lovsForMasterNameThird||[])),w=(0,s.d4)((e=>e.currency||[])),E=(0,s.d4)((e=>e.gstStatus||[])),x=(0,s.d4)((e=>e.paymentTerm||[])),T=(0,s.d4)((e=>e.incoterms||[])),C=(0,s.d4)((e=>e.title||[])),H=(0,s.d4)((e=>e.masterMakerLovHistory||{}));return(0,a.useEffect)((()=>{t((e=>({...e,...h})))}),[h]),(0,a.useEffect)((()=>{o((e=>({...e,...L})))}),[L]),(0,a.useEffect)((()=>{l((e=>({...e,...N})))}),[N]),(0,a.useEffect)((()=>{d((e=>({...e,...A})))}),[A]),(0,a.useEffect)((()=>{u((e=>({...e,...D})))}),[D]),(0,a.useEffect)((()=>{m((e=>({...e,...w})))}),[w]),(0,a.useEffect)((()=>{S((e=>({...e,...E})))}),[E]),(0,a.useEffect)((()=>{p((e=>({...e,...x})))}),[x]),(0,a.useEffect)((()=>{y((e=>({...e,...T})))}),[T]),(0,a.useEffect)((()=>{j((e=>({...e,...C})))}),[C]),(0,a.useEffect)((()=>{M((e=>({...e,...H})))}),[H]),{masterMakerLovs:e,masterMakerLovsList:r,masterMakerOrgType:i,masterMakerOrgTypeSecond:n,masterMakerOrgTypeThird:c,masterMakerCurrency:v,masterMakerGstStatus:g,masterMakerIncoterms:k,masterMakerPaymentTerm:f,masterMakerLovHistory:O,masterMakerTitle:b}}},46019:(e,t,r)=>{r.r(t),r.d(t,{default:()=>j});var a=r(96583),s=r(9950),o=r(27081),i=r(28429),l=r(29024),n=r(52867),d=r(99635),c=r(89649),u=r(14846),v=r(3252),m=r(75682),g=r(83456),S=r(39225),f=r(62605),p=r(88848),k=r(44414);const y=(0,v.A)((0,s.lazy)((()=>r.e(8820).then(r.bind(r,46439))))),b=[{Header:"Actions",accessor:"actionButtons"},{Header:"Receipt Number",accessor:"referenceDocumentNumber"},{Header:"Project",accessor:"stock_ledgers[0].project.name"},{Header:"Contractor",accessor:"stock_ledgers[0].organization.name"},{Header:"Contractor Store",accessor:"projectSiteStore"},{Header:"Status",accessor:"status",exportAccessor:"isActive"},{Header:"E-Way Bill Number",accessor:"eWayBillNumber"},{Header:"E-Way Bill Date",accessor:"eWayBillDate"},{Header:"Vehicle Number",accessor:"vehicleNumber"},{Header:"Created Date",accessor:"createdAt"},{Header:"Updated Date",accessor:"updatedAt"},{Header:"Remarks",accessor:"remarks"}],j=()=>{var e,t,r,v,j;const O=(0,o.wA)(),{transactionId:M}=(0,i.g)(),[h,L]=(0,s.useState)("closed"),[N,A]=(0,s.useState)(null),[D,w]=(0,s.useState)(!1),[E,x]=(0,s.useState)(null),[T,C]=(0,s.useState)(!1),[H,P]=(0,s.useState)(null),[B,_]=(0,s.useState)(null),{paginations:{pageSize:W,pageIndex:I,forceUpdate:R},setPageIndex:z,refreshPagination:F,setPageSize:q}=(0,c.A)(),{searchString:Q,setSearchString:U,accessorsRef:V,setAccessors:Y,forceSearch:$,searchStringTrimmed:G}=(0,S.A)(),{stockLedgerDetailList:J}=(0,f.t)(),{masterMakerOrgType:K}=(0,p.$)(),X=null===K||void 0===K?void 0:K.masterObject,{data:Z,count:ee}=(0,s.useMemo)((()=>{var e,t;return{data:(0,n.yN)(null===J||void 0===J||null===(e=J.stockLedgerDetailListObject)||void 0===e?void 0:e.rows).map(((e,t)=>{var r,a,s,o,i,l,n,d,c,v,m,g,S,f;return{...e,...!0===(null===e||void 0===e||null===(r=e.stock_ledgers[0])||void 0===r?void 0:r.isCancelled)?{status:"Cancelled"}:!0===(null===e||void 0===e||null===(a=e.stock_ledgers[0])||void 0===a?void 0:a.isProcessed)?{status:"Processed"}:{status:null},serialNumber:(I*W-W+t+1).toString(),projectSiteStore:null===(s=e.stock_ledgers)||void 0===s||null===(o=s.find((e=>e.quantity<0)))||void 0===o||null===(i=o.organization_store)||void 0===i?void 0:i.name,firmStore:null===(l=e.stock_ledgers)||void 0===l||null===(n=l.find((e=>e.quantity>0)))||void 0===n||null===(d=n.organization_store)||void 0===d?void 0:d.name,actionButtons:(0,k.jsx)(u.w,{editButton:!0,openPreview:()=>oe(t),initiatePrint:()=>ne(t),initiateDownload:()=>le(t),updateReceipt:()=>ie(e),viewSerialNumbers:()=>{x(t)},disablePrint:+e.sumOfAmounts>(null===(c=e.stock_ledgers)||void 0===c||null===(v=c[0])||void 0===v||null===(m=v.project)||void 0===m?void 0:m.eWayBillLimit)&&!e.eWayBillDate&&!e.eWayBillNumber,disableDownload:+e.sumOfAmounts>(null===(g=e.stock_ledgers)||void 0===g||null===(S=g[0])||void 0===S||null===(f=S.project)||void 0===f?void 0:f.eWayBillLimit)&&!e.eWayBillDate&&!e.eWayBillNumber,noMargins:!0})}}))||[],count:null===J||void 0===J||null===(t=J.stockLedgerDetailListObject)||void 0===t?void 0:t.count,isLoading:null===J||void 0===J?void 0:J.loading,error:null===J||void 0===J?void 0:J.error}}),[I,W,null===J||void 0===J?void 0:J.error,null===J||void 0===J?void 0:J.loading,null===J||void 0===J||null===(e=J.stockLedgerDetailListObject)||void 0===e?void 0:e.count,null===J||void 0===J||null===(t=J.stockLedgerDetailListObject)||void 0===t?void 0:t.rows]),te=(null===Z||void 0===Z||null===(r=Z[E])||void 0===r?void 0:r.materialDataNegativeQty)||[],re=null===Z||void 0===Z||null===(v=Z[N])||void 0===v?void 0:v.referenceDocumentNumber,ae=(0,n.x)(X,"MRN");(0,s.useEffect)((()=>{O((0,l.VOH)("TRANSACTION TYPE"))}),[O]),(0,s.useEffect)((()=>{ae&&O((0,l.rYL)({pageIndex:I,pageSize:W,transactionTypeId:ae,...G&&{searchString:G,accessors:JSON.stringify(V.current)},sortBy:(null===B||void 0===B?void 0:B[0])||"createdAt",sortOrder:(null===B||void 0===B?void 0:B[1])||"DESC"}))}),[O,M,I,W,R,ae,G,B,V,$]);const se=null===Z||void 0===Z||null===(j=Z[N])||void 0===j?void 0:j.id,oe=e=>{L("view"),A(e)},ie=e=>{P(e),w(!0),C(!0)},le=e=>{L("download"),A(e)},ne=e=>{L("print"),A(e)};return(0,k.jsxs)(k.Fragment,{children:["closed"!==h&&(0,k.jsx)(y,{fetchFromRoute:"/mrn-receipt",apiParams:se,previewAction:h,onClose:()=>{L("hidden"),A(null)},fileNameForDownload:re}),null!==E&&(0,k.jsx)(g.A,{selectedMaterialList:te,onClose:()=>{x(null)}}),D&&(0,k.jsx)(a.A,{open:T,onClose:()=>C(!1),scroll:"paper",maxWidth:"xs",disableEscapeKeyDown:!0,children:(0,k.jsx)(m.W,{rowData:H,setOpen:C,refreshPagination:F,title:"MRN",editPlaceOfSupply:!0})}),(0,k.jsx)(d.default,{title:"MRN Receipt",setPageIndex:z,setPageSize:q,pageIndex:I,pageSize:W,columns:b,data:ae?Z:[],count:ae?ee:0,hideAddButton:!0,hideActions:!0,searchConfig:{searchString:Q,searchStringTrimmed:G,setSearchString:U,setAccessors:Y},sortConfig:{sort:B,setSort:_},exportConfig:{tableName:"mrn_receipt",apiQuery:{transactionTypeId:ae}}})]})}}}]);