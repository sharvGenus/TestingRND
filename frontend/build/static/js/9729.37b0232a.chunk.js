"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[9729],{79729:(e,t,o)=>{o.r(t),o.d(t,{default:()=>_});var a=o(9950),r=o(27081),i=o(12257),n=o(4139),l=o(67535),d=o(74745),s=o(60666),u=o(9449),c=o(26473),v=o(28429),m=o(88848),f=o(80733),g=o(3147),S=o(55519),I=o(62605),y=o(87233),p=o(65669),x=o(14563),h=o(96951),j=o(84601),b=o(14351),O=o(29024),z=o(95615),A=o(52867),k=o(12952),L=o(94826),q=o(44414);const T={cursor:"pointer",fontSize:24},w=e=>{let{onMaterailsInput:t,formData:o,view:i,update:d,showData:v,material:m,selectedItems:f,setSelectedStoreLocId:g,selectedStoreLocId:S}=e;const[w,F]=(0,a.useState)(!1),[M,N]=(0,a.useState)(null),[E,C]=(0,a.useState)(null),[_,D]=(0,a.useState)(v&&v.rate?null===v||void 0===v?void 0:v.rate:null),[B,R]=(0,a.useState)([]),[H,P]=(0,a.useState)(null),[V,G]=(0,a.useState)(""),[$,Q]=(0,a.useState)(""),[U,Y]=(0,a.useState)([]),[J,Z]=(0,a.useState)(!1),[W,X]=(0,a.useState)(!1),[K,ee]=(0,a.useState)(!1),te=(0,r.wA)(),{firmStoreLocations:{firmStoreLocationsObject:{rows:oe=[]}},companyStoreLocations:{companyStoreLocationsObject:{rows:ae=[]}}}=(0,k.V)(),re="decb6c57-6d85-4f83-9cc2-50e0630003df",ie="420e7b13-25fd-4d23-9959-af1c07c7e94b";(0,a.useEffect)((()=>{re&&te((0,O.c1B)({organizationType:re}))}),[te,re]),(0,a.useEffect)((()=>{ie&&te((0,O.Ru7)({organizationType:ie}))}),[te,ie]),(0,a.useEffect)((()=>{F(!!i)}),[i,d]);const ne=(0,u.mN)({resolver:(0,c.t)(s.Ik().shape({materialId:j.A.requiredWithLabel("Material"),quantity:W?j.A.checkForInteger("Quantity",E):j.A.maxQuantity(E,!0),fromStoreLocationId:j.A.fromStoreLocationId})),defaultValues:{},mode:"all"}),{handleSubmit:le,setValue:de,reset:se,watch:ue}=ne,ce=ue("uom");(0,a.useEffect)((()=>{var e;d&&v&&(Z(!0),P(v),te((0,O.a2o)({project:null===o||void 0===o?void 0:o.projectId,store:null===o||void 0===o?void 0:o.fromStoreId,storeLocation:null===v||void 0===v?void 0:v.fromStoreLocationId,material:null===v||void 0===v?void 0:v.materialId})),te((0,O.J9T)({project:null===o||void 0===o?void 0:o.projectId,store:null===o||void 0===o?void 0:o.fromStoreId,storeLocation:null===v||void 0===v?void 0:v.fromStoreLocationId,material:null===v||void 0===v?void 0:v.materialId})),e=v,Object.entries(e).forEach((e=>{let[t,o]=e;"actions"!==t&&de(t,o),"uom"===t&&de(t,"string"===typeof o?o:o.name)})))}),[i,d,v,de,te,o]);const ve=(0,a.useMemo)((()=>[...oe,...ae]),[oe,ae]);(0,a.useEffect)((()=>{if(ve){const e=ve.filter((e=>{var t,a;return!(null!==e&&void 0!==e&&null!==(t=e.name)&&void 0!==t&&null!==(a=t.toLowerCase())&&void 0!==a&&a.includes("installer"))&&e.organizationStoreId===o.fromStoreId}));R(e)}}),[ve,o,v]);const me=(e,t,o,a,r,i)=>(0,q.jsx)(h.eu,{name:e,label:t,onChange:r,InputLabelProps:{shrink:!0},menus:o,...i&&{disable:!0},...a&&{required:!0}}),fe=function(e,t,o,a,r){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],n=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return(0,q.jsx)(h.o3,{name:e,type:o,label:t,..."function"===typeof r&&{handleChange:r},InputLabelProps:{shrink:n},...(i||w)&&{disabled:!0},...a&&{required:!0}})},[ge,Se]=(0,a.useState)([]),[Ie,ye]=(0,a.useState)([]),[pe,xe]=(0,a.useState)(!1),[he,je]=(0,a.useState)(!1),be=e=>{Se(e)},Oe=()=>{xe(!1)},{txnByLocationMaterial:ze,serialNumbers:Ae}=(0,I.t)(),{projectSLData:ke}=(0,a.useMemo)((()=>({projectSLData:(null===ze||void 0===ze?void 0:ze.stocksObject)||[],isLoading:ze.loading||!1})),[ze]);(0,a.useEffect)((()=>{ke&&Y(ke)}),[ke]),(0,a.useEffect)((()=>{U&&U.length>0?(ee(!1),de("qtyStk",(0,A.$G)(U[0].quantity)),de("rate",parseFloat(U[0].rate).toFixed(2)),D(parseFloat(U[0].rate).toFixed(2)),de("tax",U[0].tax),de("value",parseFloat(U[0].rate*v.quantity).toFixed(2)),C((0,A.$G)(U[0].quantity))):(ee(!1),de("qtyStk","0"),de("rate","0"),D(0),de("tax","0"),de("value","0"),C(0))}),[U,de,v]);const{serialNumbersData:Le}=(0,a.useMemo)((()=>{var e;return{serialNumbersData:(null===Ae||void 0===Ae?void 0:Ae.data)||[],countSN:(null===Ae||void 0===Ae||null===(e=Ae.data)||void 0===e?void 0:e.count)||0}}),[Ae]);(0,a.useEffect)((()=>{if(U&&U.length>0&&null!==S){if(f&&H&&H.id&&S&&f[H.id+S]){let e=f[H.id+S];de("qtyStk",(0,A.$G)(U[0].quantity)),de("quantity",e.quantity),Se(e.material_serial_numbers)}else de("qtyStk",(0,A.$G)(U[0].quantity)),de("quantity",d&&v&&v.quantity?v.quantity:0),Se(d&&v&&v.material_serial_numbers?v.material_serial_numbers:[]);C((0,A.$G)(U[0].quantity)),de("rate",parseFloat(U[0].rate).toFixed(2)),D(parseFloat(U[0].rate).toFixed(2)),de("tax",U[0].tax),de("value",parseFloat(U[0].rate*v.quantity).toFixed(2))}else de("qtyStk",null!==S?0:null),de("rate","0"),D(0),de("tax","0"),de("value","0"),C(null)}),[U,de,f,d,H,S,v]);const qe=["faulty","scrap","missing","consumed","billing","installed","installer","old","service-center","service center","defective","damage","non-repairable","non repairable"];return(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(b.A,{sx:{mb:2,pb:4},children:(0,q.jsxs)(h.Op,{methods:ne,children:[K&&(0,q.jsx)(L.A,{}),(0,q.jsxs)(n.Ay,{container:!0,spacing:3,sx:{mt:2},children:[(0,q.jsx)(n.Ay,{item:!0,xs:12,sm:4,children:me("materialId","Material",(0,A.Jw)(m),!0,(e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){const{row:t}=e.target;de("code",null===t||void 0===t?void 0:t.code),de("uom",null===t||void 0===t?void 0:t.uomName),de("fromStoreLocationId",null),g(null),de("quantity",null),C(null),de("qtyStk",null),P(t)}}),!!d)}),(0,q.jsx)(n.Ay,{item:!0,xs:12,sm:3,children:fe("uom","UOM","text",!0,void 0,!0)}),(0,q.jsx)(n.Ay,{item:!0,xs:12,sm:2,style:{display:"none"},children:fe("uomId","UOMId","text",!0)}),(0,q.jsx)(n.Ay,{item:!0,xs:12,sm:4,children:me("fromStoreLocationId","From Store Location",B&&B.filter((e=>qe.every((t=>!e.name.toLowerCase().includes(t))))),!0,(e=>{var t,a,r,i,n;null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value&&(ee(!0),v.material_serial_numbers=[],ye([]),Se([]),de("qtyStk","0"),C("0"),Q(null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.name),g(null===e||void 0===e||null===(r=e.target)||void 0===r?void 0:r.value),te((0,O.a2o)({project:null===o||void 0===o?void 0:o.projectId,store:null===o||void 0===o?void 0:o.fromStoreId,storeLocation:null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.value,material:null===H||void 0===H?void 0:H.id})),te((0,O.J9T)({project:null===o||void 0===o?void 0:o.projectId,store:null===o||void 0===o?void 0:o.fromStoreId,storeLocation:null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value,material:null===H||void 0===H?void 0:H.id})))}),!1)}),(0,q.jsx)(n.Ay,{item:!0,xs:12,sm:2,children:fe("quantity","Quantity",(0,A.VF)(ce)?"text":"number",!0,(e=>{var t,o;(0,A.VF)(ce)?X(!1):X(!0),N(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value),de("value",((null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.value)*_).toFixed(2))}))}),(0,q.jsx)(n.Ay,{item:!0,xs:12,sm:2,children:fe("qtyStk","Qty In Stock","number",!1,void 0,!0)}),(0,q.jsx)(n.Ay,{item:!0,xs:12,sm:2,style:{display:"none"},children:fe("rate","Rate","text",!0,(e=>{var t;D(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)}),!0)}),(0,q.jsx)(n.Ay,{item:!0,xs:12,sm:2,style:{display:"none"},children:fe("tax","Tax%","text",!0,void 0,!0)}),(0,q.jsx)(n.Ay,{item:!0,xs:12,sm:2,style:{display:"none"},children:fe("value","Value","number",!0,void 0,!0)}),(0,q.jsxs)(n.Ay,{item:!0,xs:12,sm:2,sx:{textAlign:"center"},children:[((null===H||void 0===H?void 0:H.isSerialNumber)||d&&(null===H||void 0===H?void 0:H.isSerialNumber))&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(y.A,{mb:-1,children:"SerialNumber"})," ",(0,q.jsx)("br",{})," ",(0,q.jsx)(l.A,{size:"small",onClick:()=>{ye(Le[(null===H||void 0===H?void 0:H.id)||(null===v||void 0===v?void 0:v.materialId)]),je(!0)},variant:"contained",color:"primary",children:"View"})]}),V&&""!==V&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("br",{}),(0,q.jsx)(y.A,{color:"error",sx:{fontSize:12,marginTop:2},children:V})]})]}),(0,q.jsx)(n.Ay,{item:!0,xs:12,sm:2,mt:4,textAlign:"right",children:!i&&(0,q.jsx)(l.A,{size:"small",onClick:le((e=>{H&&null!==H&&void 0!==H&&H.isSerialNumber&&0===ge.length?G("Serial Number is required"):H&&null!==H&&void 0!==H&&H.isSerialNumber&&ge.length!==e.quantity?G(`Please select a total of ${e.quantity} serial numbers`):(G(!1),ge&&(e.material_serial_numbers=ge),e.tax=0===e.tax?"0":e.tax,e.fromStoreLocationName=$,t(e,null===H||void 0===H?void 0:H.id,(null===H||void 0===H?void 0:H.id)+S),Se([]),P(null),Y([]),de("qtyStk",null),C(null),Z(!1),se())})),variant:"contained",color:"primary",children:J?"Update":"Add"})})]}),(0,q.jsx)(p.A,{open:pe,onClose:Oe,"aria-labelledby":"modal-modal-title",children:(0,q.jsx)(x.default,{handleCloseSerial:Oe,closeCss:T,quantity:M,setSerialNumbers:be})}),he&&(0,q.jsx)(z.default,{open:he,onClose:()=>{je(!1)},maxQuantity:M,serialNumberData:Ie,showCheckboxes:!0,onSave:e=>{be(e)},selectedSerials:ge})]})})})};var F=o(99635),M=o(62054),N=o(52351),E=o(71826),C=o(68388);const _=()=>{var e,t;const o=(0,v.Zp)(),[y,p]=(0,a.useState)(!1),[x,z]=(0,a.useState)([]),[k,L]=(0,a.useState)(!1),[T,_]=(0,a.useState)(null),[D,B]=(0,a.useState)(null),[R,H]=(0,a.useState)([]),[P,V]=(0,a.useState)({}),[G,$]=(0,a.useState)(null),[Q,U]=(0,a.useState)(null),[Y,J]=(0,a.useState)(null),[Z,W]=(0,a.useState)([]),[X,K]=(0,a.useState)({}),[ee,te]=(0,a.useState)(null),[oe,ae]=(0,a.useState)([]),[re,ie]=(0,a.useState)(!1),[ne,le]=(0,a.useState)(!1),[de,se]=(0,a.useState)(!1),[ue,ce]=(0,a.useState)(""),ve=(0,u.mN)({resolver:(0,c.t)(s.Ik().shape({projectId:j.A.project,fromOrganizationTypeId:j.A.organizationType,fromOrganizationId:j.A.organizationId,fromStoreId:j.A.store,toOrganizationId:j.A.organizationId,toStoreId:j.A.store})),defaultValues:{},mode:"all"}),me=(0,a.useMemo)((()=>[{Header:"Name",accessor:"name"},{Header:"Code",accessor:"code"},{Header:"Quantity",accessor:"quantity"},{Header:"UOM",accessor:"uom"},{Header:"From Store Location",accessor:"fromStoreLocationName"}]),[]),{handleSubmit:fe,setValue:ge}=ve,Se=(0,r.wA)();(0,a.useEffect)((()=>{Se((0,O.VOH)("ORGANIZATION TYPE")),Se((0,O.rHZ)("ORGANIZATION TYPE")),Se((0,O.uiG)()),Se((0,O._G1)())}),[Se]),(0,a.useEffect)((()=>{Q&&(Se((0,O.d8s)(Q)),Se((0,O.h7m)(Q)))}),[Se,Q]);const{masterMakerOrgTypeSecond:{masterObject:Ie}}=(0,m.$)(),{projectsDropdown:{projectsDropdownObject:ye}}=(0,f.Y)();(0,a.useEffect)((()=>{if(Ie){const e=Ie.filter((e=>["COMPANY","CONTRACTOR"].includes(null===e||void 0===e?void 0:e.name)));se(e)}}),[Ie]);const{organizationsDropdown:{organizationDropdownObject:pe},organizationsLocByParent:{organizationObject:{rows:xe}}}=(0,S.G)(),{organizationsAllData:he,organizationsAllDataSecond:je}=(0,S.G)(),be=(null===he||void 0===he||null===(e=he.organizationObject)||void 0===e?void 0:e.rows)||[],Oe=(null===je||void 0===je||null===(t=je.organizationObject)||void 0===t?void 0:t.rows)||[],{organizationStoresDropdown:{organizationStoreDropdownObject:{rows:ze=[]}},organizationStoresAllAccess:{organizationStoreObject:{rows:Ae}}}=(0,g.E)();(0,a.useEffect)((()=>{Y&&W(null===ze||void 0===ze?void 0:ze.filter((e=>(null===e||void 0===e?void 0:e.organizationId)===Y)))}),[Y,ze]);const{transactionMaterialList:ke}=(0,I.t)(),{materials:Le}=(0,a.useMemo)((()=>{var e;return{materials:(null===ke||void 0===ke?void 0:ke.stocksObject)||[],count:(null===ke||void 0===ke||null===(e=ke.stocksObject)||void 0===e?void 0:e.count)||0}}),[ke]);(0,a.useEffect)((()=>{var e;Le&&Le.length>0&&z((e=Le)&&e.map((e=>({id:null===e||void 0===e?void 0:e.id,name:null===e||void 0===e?void 0:e.name,isSerialNumber:null===e||void 0===e?void 0:e.is_serial_number,quantity:" ",tax:e.tax,value:e.value,uomName:e.uom_name,uomId:e.uom_id,rate:parseFloat(e.rate).toFixed(2),code:null===e||void 0===e?void 0:e.code,hsnCode:null===e||void 0===e?void 0:e.hsn_code,uom:e.uom,projectId:T,fromStoreId:D,material_serial_numbers:[]}))))}),[Le,T,D]);const qe=(e,t,o,a,r)=>(0,q.jsx)(i.A,{children:(0,q.jsx)(h.eu,{name:e,label:t,InputLabelProps:{shrink:!0},menus:o,...y&&{disable:!0},..."function"===typeof r&&{onChange:r},...a&&{required:!0}})}),Te=e=>{"projectId"===e?(ge("fromOrganizationTypeId",""),ge("fromOrganizationId",""),ge("fromOraganizationBranchId",""),ge("fromStoreId",""),ge("toOrganizationId",""),ge("toOraganizationBranchId",""),ge("toStoreId",""),ge("remarks","")):"fromOrganizationTypeId"===e?(ge("fromOrganizationId",""),ge("fromOraganizationBranchId",""),ge("fromStoreId",""),ge("toOrganizationId",""),ge("toOraganizationBranchId",""),ge("toStoreId",""),ge("remarks","")):"fromOrganizationId"===e?(ge("fromOraganizationBranchId",""),ge("fromStoreId",""),ge("toOrganizationId",""),ge("toOraganizationBranchId",""),ge("toStoreId",""),ge("remarks","")):"fromOraganizationBranchId"===e?(ge("fromStoreId",""),ge("toOrganizationId",""),ge("toOraganizationBranchId",""),ge("toStoreId",""),ge("remarks","")):"fromStoreId"===e?(ge("toOrganizationId",""),ge("toOraganizationBranchId",""),ge("toStoreId",""),ge("remarks","")):"toOrganizationId"===e?(ge("toOraganizationBranchId",""),ge("toStoreId",""),ge("remarks","")):"toOraganizationBranchId"===e&&(ge("toStoreId",""),ge("remarks",""))},we=()=>{p(!1),$(null),z([]),ie(!1)},Fe=(0,C.A)({dataObject:ke,key:"stocksObject",resetTrigger:null===G});return(0,a.useEffect)((()=>{Array.isArray(Fe)&&0===Fe.length&&(we(),(0,M.A)("There are no available materials for your selected combination",{variant:"error"}))}),[Fe]),(0,q.jsxs)(q.Fragment,{children:[ne&&(0,q.jsx)(N.A,{}),(0,q.jsx)(h.Op,{methods:ve,children:(0,q.jsxs)(b.A,{title:"Consumption Request",children:[(0,q.jsxs)(n.Ay,{container:!0,spacing:4,children:[(0,q.jsx)(n.Ay,{item:!0,md:3,xl:3,children:qe("projectId","Project",ye,!0,(e=>{var t,o;null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value&&(_(null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.value),Te("projectId"))}))}),(0,q.jsx)(n.Ay,{item:!0,md:3,xl:3,children:qe("fromOrganizationTypeId","From Organization Type",de,!0,(e=>{var t;U(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value),Te("fromOrganizationTypeId"),J(null)}))}),(0,q.jsx)(n.Ay,{item:!0,md:3,xl:3,children:qe("fromOrganizationId","From Organization",(0,A.HF)(pe),!0,(e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){var o,a,r,i;J(null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.value),Te("fromOrganizationId");const t=null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.row;Se((0,O.VRs)({params:(null===t||void 0===t||null===(r=t.organization_type)||void 0===r?void 0:r.id)+"/"+(null===t||void 0===t?void 0:t.id)})),Se((0,O.h7m)(null===t||void 0===t||null===(i=t.organization_type)||void 0===i?void 0:i.id))}}))}),(0,q.jsx)(n.Ay,{item:!0,md:3,xl:3,children:qe("fromOraganizationBranchId","From Organization Branch",(0,A.HF)(xe),!1,(e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){var o,a,r;const t=null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.row;J(null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value),Te("fromOraganizationBranchId"),Se((0,O.h7m)(null===t||void 0===t||null===(r=t.organization_type)||void 0===r?void 0:r.id))}}))}),(0,q.jsx)(n.Ay,{item:!0,md:3,xl:3,children:qe("fromStoreId","From Store",Z,!0,(e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){var o,a,r,i;B(null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.value),Te("fromStoreId");const t=((e,t)=>{const o=e&&e.filter((e=>e.id===t));return o&&o.length?o[0]:{}})(Z,e.target.value);ce(null!==t&&void 0!==t&&null!==(a=t.organization)&&void 0!==a&&a.parentId?null===t||void 0===t||null===(r=t.organization)||void 0===r?void 0:r.parentId:null===t||void 0===t||null===(i=t.organization)||void 0===i?void 0:i.id),Se((0,O.W8R)({organizationTypeId:"420e7b13-25fd-4d23-9959-af1c07c7e94b"})),Se((0,O.Vto)("420e7b13-25fd-4d23-9959-af1c07c7e94b"))}}))}),(0,q.jsx)(n.Ay,{item:!0,md:3,xl:3,children:qe("toOrganizationId","To Organization",(0,A.HF)(be),!0,(e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){var o,a,r,i;Te("toOrganizationId");const t=null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.row;Se((0,O.oDq)({organizationTypeId:"420e7b13-25fd-4d23-9959-af1c07c7e94b",parentId:null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value})),Se((0,O.xlY)({organizationType:null===t||void 0===t||null===(r=t.organization_type)||void 0===r?void 0:r.id,organizationId:null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.value}))}}))}),(0,q.jsx)(n.Ay,{item:!0,md:3,xl:3,children:qe("toOraganizationBranchId","To Organization Branch",(0,A.HF)(Oe),!1,(e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){var o,a,r,i;const t=null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.row;Te("toOraganizationBranchId"),Se((0,O.Vto)(null===t||void 0===t||null===(a=t.organization_type)||void 0===a?void 0:a.id)),Se((0,O.xlY)({organizationType:null===t||void 0===t||null===(r=t.organization_type)||void 0===r?void 0:r.id,organizationId:null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.value}))}}))}),(0,q.jsx)(n.Ay,{item:!0,md:3,xl:3,children:qe("toStoreId","To Store",Ae,!0,(e=>{var t;null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value&&Te("toStoreId")}))}),(0,q.jsx)(n.Ay,{item:!0,md:3,xl:3,children:function(e,t,o,a){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return(0,q.jsx)(i.A,{spacing:1,children:(0,q.jsx)(h.o3,{name:e,type:o,label:t,InputLabelProps:{shrink:r},...y&&{disabled:!0},...a&&{required:!0}})})}("remarks","Remarks","text",!1)})]}),(0,q.jsx)(n.Ay,{container:!0,spacing:4,children:(0,q.jsx)(n.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px",mt:2},children:!y&&(0,q.jsx)(l.A,{onClick:fe((e=>{e&&e.projectId&&e.fromStoreId&&($(e),p(!0),ie(!0),Se((0,O.UjX)({project:e.projectId,store:e.fromStoreId})))})),size:"small",variant:"contained",color:"primary",children:"Proceed"})})}),(0,q.jsx)(n.Ay,{container:!0,sx:{mt:3,mb:3},children:(0,q.jsx)(n.Ay,{item:!0,md:12,xl:12,children:(0,q.jsx)(d.A,{})})})]})}),x&&re&&x.length>0&&(0,q.jsx)(w,{formData:G,onMaterailsInput:(e,t,o)=>{((e,t)=>{t&&(x.map((o=>{let a={};if(o.id===e.materialId){a={...o,...e},a.uomId=null===o||void 0===o?void 0:o.uomId,ae((e=>[...e,a.fromStoreLocationId]));const r=R.findIndex((o=>o.id===t&&(null===e||void 0===e?void 0:e.fromStoreLocationId)===(null===o||void 0===o?void 0:o.fromStoreLocationId)));if(r>=0){const e=structuredClone(R);e[r]=a,H(e)}else H(R.concat(a))}})),L(!1))})(e,t);const a={...X};a[o]||(a[o]={}),a[o]=e,K(a)},update:k,selectedItems:X,showData:P,material:x,selectedLocations:oe,setSelectedStoreLocId:te,selectedStoreLocId:ee}),y&&x&&x.length>0&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(F.default,{title:"Consumption-Request",hideHeader:!0,columns:me,hidePagination:!0,data:R,count:R.length,hideViewIcon:!0,hideRestoreIcon:!0,hideHistoryIcon:!0,handleRowUpdate:e=>{L(!0),V({...e})},handleRowDelete:((e,t)=>{if(R){const o=R.findIndex((o=>(null===o||void 0===o?void 0:o.materialId)===t&&(null===o||void 0===o?void 0:o.fromStoreLocationId)===e)),a=R.filter(((e,t)=>t!==o)),r=a.map((e=>e.fromStoreLocationId));H(a),ae(r),delete X[t+e]}}).bind(null,ee)}),(0,q.jsx)(h.Op,{children:(0,q.jsx)(n.Ay,{container:!0,spacing:4,children:(0,q.jsxs)(n.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px",mt:2},children:[(0,q.jsx)(l.A,{onClick:we,size:"small",variant:"outlined",color:"primary",children:"Back"}),(0,q.jsx)(l.A,{size:"small",disabled:k||ne,onClick:async()=>{var e,t,a;le(!0);const r=R.filter((e=>parseFloat(e.quantity)>0)).map((e=>({requestName:"CONSUMPTIONREQUEST",transactionTypeId:"671306a0-48c5-4e0c-a604-d86624f35d6d",requestOrganizationId:ue,requestStoreId:G.fromStoreId,approverStoreId:G.toStoreId,projectId:G.projectId,fromStoreId:G.fromStoreId,toStoreId:G.toStoreId,fromStoreLocationId:e.fromStoreLocationId,materialId:e.materialId,uomId:e.uomId,requestedQuantity:e.quantity,rate:e.rate,value:e.value,tax:e.tax,serialNumbers:JSON.stringify(null===e||void 0===e?void 0:e.material_serial_numbers),remarks:G.remarks})));if(!r.length)return(0,M.A)("Please have at least one material with some quantity",{variant:"error"}),void le(!1);if((0,A.Rh)(r,"fromStoreLocationId"))return void le(!1);const i=await(0,E.default)("/request-create",{method:"POST",body:{payload:r},timeoutOverride:12e4});var n;if(!i.success)return(0,M.A)((null===i||void 0===i||null===(n=i.error)||void 0===n?void 0:n.message)||"Operation failed. Please try again!",{variant:"error"}),void le(!1);const l=null!==(e=null===(t=i.data)||void 0===t?void 0:t.data)&&void 0!==e?e:{},d=l.referenceDocumentNumber||(null===(a=l[0])||void 0===a?void 0:a.referenceDocumentNumber);(0,M.A)(d?`Request created with reference number: ${d}`:"Request created successfully!",{variant:"success",autoHideDuration:1e4}),le(!1),o("/consumption-request-receipt")},variant:"contained",color:"primary",children:"Submit"})]})})})]})]})}},88848:(e,t,o)=>{o.d(t,{$:()=>i});var a=o(9950),r=o(27081);const i=()=>{const[e,t]=(0,a.useState)({masterMakerLovsObject:{},error:"",loading:!0}),[o,i]=(0,a.useState)({masterMakerLovsObject:{},error:"",loading:!0}),[n,l]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[d,s]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[u,c]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[v,m]=(0,a.useState)({currencyObject:[],error:"",loading:!0}),[f,g]=(0,a.useState)({gstStatusObject:[],error:"",loading:!0}),[S,I]=(0,a.useState)({paymentTermObject:[],error:"",loading:!0}),[y,p]=(0,a.useState)({incotermsObject:[],error:"",loading:!0}),[x,h]=(0,a.useState)({titleObject:[],error:"",loading:!0}),[j,b]=(0,a.useState)({masterMakerLovHistoryObject:{},error:"",loading:!0}),O=(0,r.d4)((e=>e.masterMakerLov||{})),z=(0,r.d4)((e=>e.masterMakerLovList||{})),A=(0,r.d4)((e=>e.lovsForMasterName||[])),k=(0,r.d4)((e=>e.lovsForMasterNameSecond||[])),L=(0,r.d4)((e=>e.lovsForMasterNameThird||[])),q=(0,r.d4)((e=>e.currency||[])),T=(0,r.d4)((e=>e.gstStatus||[])),w=(0,r.d4)((e=>e.paymentTerm||[])),F=(0,r.d4)((e=>e.incoterms||[])),M=(0,r.d4)((e=>e.title||[])),N=(0,r.d4)((e=>e.masterMakerLovHistory||{}));return(0,a.useEffect)((()=>{t((e=>({...e,...O})))}),[O]),(0,a.useEffect)((()=>{i((e=>({...e,...z})))}),[z]),(0,a.useEffect)((()=>{l((e=>({...e,...A})))}),[A]),(0,a.useEffect)((()=>{s((e=>({...e,...k})))}),[k]),(0,a.useEffect)((()=>{c((e=>({...e,...L})))}),[L]),(0,a.useEffect)((()=>{m((e=>({...e,...q})))}),[q]),(0,a.useEffect)((()=>{g((e=>({...e,...T})))}),[T]),(0,a.useEffect)((()=>{I((e=>({...e,...w})))}),[w]),(0,a.useEffect)((()=>{p((e=>({...e,...F})))}),[F]),(0,a.useEffect)((()=>{h((e=>({...e,...M})))}),[M]),(0,a.useEffect)((()=>{b((e=>({...e,...N})))}),[N]),{masterMakerLovs:e,masterMakerLovsList:o,masterMakerOrgType:n,masterMakerOrgTypeSecond:d,masterMakerOrgTypeThird:u,masterMakerCurrency:v,masterMakerGstStatus:f,masterMakerIncoterms:y,masterMakerPaymentTerm:S,masterMakerLovHistory:j,masterMakerTitle:x}}}}]);