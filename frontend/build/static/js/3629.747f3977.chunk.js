"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[3629],{67864:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var s=a(96583),r=a(9950),i=a(27081),o=a(28429),l=a(62605),n=a(29024),d=a(52867),c=a(99635),u=a(89649),v=a(14846),g=a(3252),p=a(75682),m=a(83456),S=a(39225),f=a(44414);const h=(0,g.A)((0,r.lazy)((()=>a.e(8820).then(a.bind(a,46439))))),y=[{Header:"Actions",accessor:"actionButtons"},{Header:"Receipt Number",accessor:"referenceDocumentNumber"},{Header:"Project",accessor:"stock_ledgers[0].project.name"},{Header:"Organization",accessor:"stock_ledgers[0].organization.name"},{Header:"Store",accessor:"stock_ledgers[0].organization_store.name"},{Header:"Status",accessor:"status",exportAccessor:"isActive"},{Header:"E-Way Bill Number",accessor:"eWayBillNumber"},{Header:"E-Way Bill Date",accessor:"eWayBillDate"},{Header:"Created Date",accessor:"createdAt"},{Header:"Updated Date",accessor:"updatedAt"},{Header:"Remarks",accessor:"remarks"}],b=()=>{var e,t,a;const g=(0,i.wA)(),{transactionId:b}=(0,o.g)(),[A,P]=(0,r.useState)("closed"),[D,w]=(0,r.useState)(null),[k,x]=(0,r.useState)(!1),[B,N]=(0,r.useState)(null),[j,C]=(0,r.useState)(!1),[W,H]=(0,r.useState)(null),[L,_]=(0,r.useState)(null),{searchString:z,setSearchString:O,accessorsRef:I,setAccessors:R,forceSearch:T,searchStringTrimmed:E}=(0,S.A)(),{paginations:{pageSize:F,pageIndex:M,forceUpdate:Q},setPageIndex:U,refreshPagination:J,setPageSize:K}=(0,u.A)(),{stockLedgerDetailList:Y}=(0,l.t)(),{data:q,count:G}=(0,r.useMemo)((()=>{var e,t;return{data:(0,d.yN)(null===Y||void 0===Y||null===(e=Y.stockLedgerDetailListObject)||void 0===e?void 0:e.rows).map(((e,t)=>{var a,s,r,i,o,l,n,d;return{...e,...!0===(null===e||void 0===e||null===(a=e.stock_ledgers[0])||void 0===a?void 0:a.isCancelled)?{status:"Cancelled"}:!0===(null===e||void 0===e||null===(s=e.stock_ledgers[0])||void 0===s?void 0:s.isProcessed)?{status:"Processed"}:{status:null},serialNumber:(M*F-F+t+1).toString(),actionButtons:(0,f.jsx)(v.w,{editButton:!0,openPreview:()=>ee(t),initiatePrint:()=>se(t),initiateDownload:()=>ae(t),updateReceipt:()=>te(e),viewSerialNumbers:()=>{N(t)},disablePrint:+e.sumOfAmounts>(null===(r=e.stock_ledgers)||void 0===r||null===(i=r[0])||void 0===i||null===(o=i.project)||void 0===o?void 0:o.eWayBillLimit)&&!e.eWayBillDate&&!e.eWayBillNumber,disableDownload:+e.sumOfAmounts>(null===(l=e.stock_ledgers)||void 0===l||null===(n=l[0])||void 0===n||null===(d=n.project)||void 0===d?void 0:d.eWayBillLimit)&&!e.eWayBillDate&&!e.eWayBillNumber,noMargins:!0})}}))||[],count:null===Y||void 0===Y||null===(t=Y.stockLedgerDetailListObject)||void 0===t?void 0:t.count,isLoading:null===Y||void 0===Y?void 0:Y.loading,error:null===Y||void 0===Y?void 0:Y.error}}),[Y,M,F]),V=(null===q||void 0===q||null===(e=q[B])||void 0===e?void 0:e.materialDataNegativeQty)||[],X=null===q||void 0===q||null===(t=q[D])||void 0===t?void 0:t.id,Z=null===q||void 0===q||null===(a=q[D])||void 0===a?void 0:a.referenceDocumentNumber,$="22ce5829-2a1e-407c-88f6-5ebc38455519";(0,r.useEffect)((()=>{$&&g((0,n.rYL)({pageIndex:M,pageSize:F,transactionTypeId:$,...E&&{searchString:E,accessors:JSON.stringify(I.current)},sortBy:(null===L||void 0===L?void 0:L[0])||"createdAt",sortOrder:(null===L||void 0===L?void 0:L[1])||"DESC"}))}),[g,b,M,F,Q,$,E,L,I,T]);const ee=e=>{P("view"),w(e)},te=e=>{H(e),x(!0),C(!0)},ae=e=>{P("download"),w(e)},se=e=>{P("print"),w(e)};return(0,f.jsxs)(f.Fragment,{children:["closed"!==A&&(0,f.jsx)(h,{fetchFromRoute:"/ptp-receipt",apiParams:X,previewAction:A,onClose:()=>{P("hidden"),w(null)},fileNameForDownload:Z}),null!==B&&(0,f.jsx)(m.A,{selectedMaterialList:V,onClose:()=>{N(null)}}),k&&(0,f.jsx)(s.A,{open:j,onClose:()=>C(!1),scroll:"paper",maxWidth:"xs",disableEscapeKeyDown:!0,children:(0,f.jsx)(p.W,{rowData:W,setOpen:C,refreshPagination:J,title:"PTP",editPlaceOfSupply:!0,isPtp:!0})}),(0,f.jsx)(c.default,{title:"PTP Receipt",setPageIndex:U,setPageSize:K,pageIndex:M,pageSize:F,columns:y,data:$?q:[],count:$?G:0,hideAddButton:!0,hideActions:!0,searchConfig:{searchString:z,searchStringTrimmed:E,setSearchString:O,setAccessors:R},sortConfig:{sort:L,setSort:_},exportConfig:{tableName:"ptp_receipt",apiQuery:{transactionTypeId:$}}})]})}}}]);