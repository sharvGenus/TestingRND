"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[8466],{58466:(e,t,l)=>{l.r(t),l.d(t,{default:()=>V});var a=l(9950),o=l(27081),r=l(53065),i=l(57073),n=l(4139),s=l(67535),d=l(36089),u=l(26592),c=l(28429),m=l(62375),v=l(62605),p=l(26473),x=l(60666),b=l(87233),S=l(74745),y=l(9449),h=l(80733),j=l(29024),f=l(3147),I=l(55519),A=l(96951),g=l(14351),N=l(84601),k=l(52867),C=l(44414);const L=e=>{var t,l;let{saveData:r,setDisableAll:i,disableAll:d}=e;const[u,c]=(0,a.useState)(""),[m,v]=(0,a.useState)(""),[L,q]=(0,a.useState)(),[D,w]=(0,a.useState)(),O=(0,y.mN)({resolver:(0,p.t)(x.Ik().shape({projectId:N.A.project,projectSiteStoreId:N.A.projectSiteStore,toCustomerId:N.A.toCustomerId,customerSiteStoreId:N.A.customerSiteStoreId,...!(0,k.g6)(L)&&{eWayBillDate:N.A.requiredWithLabel("E-Way Bill Date")},transporterName:N.A.inventoryNameOptional,contactNumber:N.A.mobileNumberOptional,vehicleNumber:N.A.vehicleNumberOptional})),defaultValues:{},mode:"all"}),{handleSubmit:_,watch:F,setValue:E}=O,z=(0,o.wA)();(0,a.useEffect)((()=>{z((0,j.uiG)())}),[z]);const T="420e7b13-25fd-4d23-9959-af1c07c7e94b",W="e9206924-c5cb-454e-af1e-124d8179299a";(0,a.useEffect)((()=>{T&&z((0,j.qV$)({organizationType:T}))}),[z,T]),(0,a.useEffect)((()=>{W&&(z((0,j.d8s)(W)),z((0,j.QEJ)({organizationType:W})))}),[z,W]);const{projectsDropdown:B}=(0,h.Y)(),{organizationsDropdown:P}=(0,I.G)(),{organizationStores:M,organizationStoresSecond:V}=(0,f.E)(),R=null===B||void 0===B?void 0:B.projectsDropdownObject,H=(null===(t=M.organizationStoreObject)||void 0===t?void 0:t.rows)||[],$=(null===P||void 0===P?void 0:P.organizationDropdownObject)||[],Q=(null===V||void 0===V||null===(l=V.organizationStoreObject)||void 0===l?void 0:l.rows)||[],U=F("eWayBillNumber");(0,a.useEffect)((()=>{q(U)}),[U]);const J=e=>{"projectId"===e&&(E("projectSiteStoreId",null),E("toCustomerId",null),E("customerSiteStoreId",null),E("placeOfSupply",null),E("eWayBillNumber",null),E("eWayBillDate",null),E("transporterName",null),E("contactNumber",null),E("vehicleNumber",null),E("lrNumber",null),E("remarks",null),w([])),"projectSiteStoreId"===e&&(E("toCustomerId",null),E("customerSiteStoreId",null),E("placeOfSupply",null),E("eWayBillNumber",null),E("eWayBillDate",null),E("transporterName",null),E("contactNumber",null),E("vehicleNumber",null),E("lrNumber",null),E("remarks",null),w([])),"toCustomerId"===e&&(E("customerSiteStoreId",null),E("placeOfSupply",null),E("eWayBillNumber",null),E("eWayBillDate",null),E("transporterName",null),E("contactNumber",null),E("vehicleNumber",null),E("lrNumber",null),E("remarks",null)),"customerSiteStoreId"===e&&(E("placeOfSupply",null),E("eWayBillNumber",null),E("eWayBillDate",null),E("transporterName",null),E("contactNumber",null),E("vehicleNumber",null),E("lrNumber",null),E("remarks",null))};return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(g.A,{title:"Material Transfer Company Store To Customer",sx:{mb:2},children:(0,C.jsxs)(A.Op,{methods:O,children:[(0,C.jsxs)(n.Ay,{container:!0,spacing:4,children:[(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.eu,{InputLabelProps:{shrink:!0},name:"projectId",label:"Project",menus:R||[],disable:d,onChange:()=>{J("projectId")},required:!0})}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.eu,{InputLabelProps:{shrink:!0},name:"projectSiteStoreId",label:"Company Store",menus:H||[],onChange:e=>{if(e.target.value){const t=((e,t)=>{const l=e&&e.filter((e=>e.id===t));return l&&l.length?l[0]:{}})(H,e.target.value);v(t);const l=t.city,a=(t.address,t.address),o=t.pincode?t.pincode:t.pinCode;c(`${a}, ${l.name}, ${l.state.name}, ${l.state.country.name}, ${o}`),J("projectSiteStoreId")}},required:!0,disable:d})}),(0,C.jsxs)(n.Ay,{item:!0,md:6,xl:8,children:[(0,C.jsx)(b.A,{children:"Address: "}),(0,C.jsx)(b.A,{mt:2,children:u})]}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.eu,{InputLabelProps:{shrink:!0},name:"toCustomerId",label:"Customer",menus:(0,k.HF)($)||[],onChange:e=>{let t=Q.filter((t=>{var l;return t.organizationId===(null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.value)}));w(t),J("toCustomerId")},required:!0,disable:d})}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.eu,{InputLabelProps:{shrink:!0},name:"customerSiteStoreId",label:"Customer Site Store",menus:D||[],onChange:()=>{J("customerSiteStoreId")},disable:d,required:!0})}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.o3,{InputLabelProps:{shrink:!0},name:"placeOfSupply",label:"Place of Supply",type:"text",disabled:d})}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.o3,{InputLabelProps:{shrink:!0},name:"eWayBillNumber",label:"E-Way Bill Number",type:"text",disabled:d})}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.o3,{InputLabelProps:{shrink:!0},name:"eWayBillDate",label:"E-Way Bill Date",type:"date",disabled:d||(0,k.g6)(L)})}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.o3,{InputLabelProps:{shrink:!0},name:"transporterName",label:"Transporter Name",type:"text",disabled:d})}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.o3,{InputLabelProps:{shrink:!0},name:"contactNumber",label:"Contact Number",type:"text",disabled:d})}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.o3,{InputLabelProps:{shrink:!0},name:"vehicleNumber",label:"Vehicle Number",type:"text",disabled:d})}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.o3,{InputLabelProps:{shrink:!0},name:"lrNumber",label:"LR Number",type:"text",disabled:d})}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.o3,{InputLabelProps:{shrink:!0},name:"remarks",label:"Remarks",type:"text",disabled:d})}),(0,C.jsx)(n.Ay,{container:!0,spacing:4,children:(0,C.jsx)(n.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px"},children:!d&&(0,C.jsx)(s.A,{size:"small",variant:"contained",onClick:_((e=>{e.transactionTypeId="6e7c5278-c63d-4ec1-90a8-110504adfbb0",e.fromStoreDetails=m,r(e),i(!0)})),color:"primary",children:"Next"})})})]}),(0,C.jsx)(n.Ay,{container:!0,sx:{mt:3,mb:3},children:(0,C.jsx)(n.Ay,{item:!0,md:12,xl:12,children:(0,C.jsx)(S.A,{})})})]})})})};var q=l(65669),D=l(14563),w=l(95615),O=l(12952),_=l(94826);const F={cursor:"pointer",fontSize:24},E=e=>{let{materials:t,onMaterailsInput:l,formData:r,view:i,update:d,showData:u,selectedItems:c,hideTaxDetails:m=!1}=e;const[S,h]=(0,a.useState)(!1),[f,I]=(0,a.useState)(null),[L,E]=(0,a.useState)(null),[z,T]=(0,a.useState)(u&&u.rate?null===u||void 0===u?void 0:u.rate:null),[W,B]=(0,a.useState)([]),[P,M]=(0,a.useState)(null),[V,R]=(0,a.useState)(""),[H,$]=(0,a.useState)(""),[Q,U]=(0,a.useState)(null),[J,G]=(0,a.useState)([]),[Y,X]=(0,a.useState)(!1),[Z,K]=(0,a.useState)(!1),[ee,te]=(0,a.useState)(!1),le=(0,o.wA)(),ae="420e7b13-25fd-4d23-9959-af1c07c7e94b";(0,a.useEffect)((()=>{ae&&le((0,j.Ru7)({organizationType:ae}))}),[le,ae]),(0,a.useEffect)((()=>{h(!!i)}),[i,d]);const oe=(0,y.mN)({resolver:(0,p.t)(x.Ik().shape({materialId:N.A.requiredWithLabel("Material"),quantity:Z?N.A.checkForInteger("Quantity",L):N.A.maxQuantity(L,!0),fromStoreLocationId:N.A.fromStoreLocationId})),defaultValues:{},mode:"all"}),{handleSubmit:re,setValue:ie,reset:ne,watch:se}=oe,de=se("uom");(0,a.useEffect)((()=>{var e;(i||d)&&u&&(X(!0),M(u),le((0,j.a2o)({project:null===r||void 0===r?void 0:r.projectId,store:null===r||void 0===r?void 0:r.projectSiteStoreId,storeLocation:null===u||void 0===u?void 0:u.fromStoreLocationId,material:null===u||void 0===u?void 0:u.materialId})),le((0,j.J9T)({project:null===r||void 0===r?void 0:r.projectId,store:null===r||void 0===r?void 0:r.projectSiteStoreId,storeLocation:null===u||void 0===u?void 0:u.fromStoreLocationId,material:null===u||void 0===u?void 0:u.materialId})),e=u,Object.entries(e).forEach((e=>{let[t,l]=e;"actions"!==t&&ie(t,l),"uom"===t&&ie(t,"string"===typeof l?l:l.name)})))}),[i,d,u,ie,r,le]),(0,a.useEffect)((()=>{ie("willReturn",!0)}),[ie]);const{companyStoreLocations:ue}=(0,O.V)(),ce=(0,a.useMemo)((()=>{var e;return(null===ue||void 0===ue||null===(e=ue.companyStoreLocationsObject)||void 0===e?void 0:e.rows)||[]}),[ue]);(0,a.useEffect)((()=>{if(ce){const e=ce.filter((e=>{var t,l;return(null===e||void 0===e||null===(t=e.organization_store)||void 0===t?void 0:t.id)===(null===r||void 0===r||null===(l=r.fromStoreDetails)||void 0===l?void 0:l.id)}));B(e)}}),[ce,r]);const me=(e,t,l,a,o,r)=>(0,C.jsx)(A.eu,{name:e,label:t,onChange:o,InputLabelProps:{shrink:!0},menus:l,...r&&{disable:!0},...a&&{required:!0}}),ve=function(e,t,l,a,o){let r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return(0,C.jsx)(A.o3,{name:e,type:l,label:t,..."function"===typeof o&&{handleChange:o},InputLabelProps:{shrink:i},...(r||S)&&{disabled:!0},...a&&{required:!0}})},[pe,xe]=(0,a.useState)([]),[be,Se]=(0,a.useState)([]),[ye,he]=(0,a.useState)(!1),[je,fe]=(0,a.useState)(!1),Ie=e=>{xe(e)},Ae=()=>{he(!1)},{txnByLocationMaterial:ge,serialNumbers:Ne}=(0,v.t)();let{projectSLData:ke}=(0,a.useMemo)((()=>({projectSLData:(null===ge||void 0===ge?void 0:ge.stocksObject)||[],isLoading:ge.loading||!1})),[ge]);(0,a.useEffect)((()=>{ke&&G(ke)}),[ke]),(0,a.useEffect)((()=>{J&&J.length>0?(ie("qtyStk",J[0].quantity),ie("rate",parseFloat(J[0].rate).toFixed(2)),T(parseFloat(J[0].rate).toFixed(2)),ie("tax",J[0].tax),ie("value",parseFloat(J[0].rate*u.quantity).toFixed(2)),E(J[0].quantity)):(ie("qtyStk","0"),ie("rate","0"),T(0),ie("tax","0"),ie("value","0"),E(0))}),[J,ie,u]),(0,a.useEffect)((()=>{if(J&&J.length>0&&null!==Q){if(te(!1),c&&P&&P.id&&Q&&c[P.id+Q]){let e=c[P.id+Q];ie("qtyStk",J[0].quantity),ie("quantity",e.quantity),xe(e.material_serial_numbers)}else ie("qtyStk",J[0].quantity),ie("quantity",d&&u&&u.quantity?u.quantity:0),xe(d&&u&&u.material_serial_numbers?u.material_serial_numbers:[]);E(J[0].quantity),ie("rate",parseFloat(J[0].rate).toFixed(2)),T(parseFloat(J[0].rate).toFixed(2)),ie("tax",J[0].tax),ie("value",parseFloat(J[0].rate*u.quantity).toFixed(2))}else te(!1),ie("qtyStk",null!==Q?0:null),ie("rate","0"),T(0),ie("tax","0"),ie("value","0"),E(null)}),[J,ie,c,d,P,Q,u]);const{serialNumbersData:Ce}=(0,a.useMemo)((()=>{var e;return{serialNumbersData:(null===Ne||void 0===Ne?void 0:Ne.data)||[],countSN:(null===Ne||void 0===Ne||null===(e=Ne.data)||void 0===e?void 0:e.count)||0}}),[Ne]),Le=["faulty","scrap","missing","consumed","billing","installed","installer","service-center","service center","defective","damage","non-repairable","non repairable"];return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(g.A,{sx:{mb:2,pb:4},children:(0,C.jsxs)(A.Op,{methods:oe,children:[ee&&(0,C.jsx)(_.A,{}),(0,C.jsxs)(n.Ay,{container:!0,spacing:2,sx:{mt:2},children:[(0,C.jsx)(n.Ay,{item:!0,xs:12,sm:4,children:me("materialId","Material",(0,k.Jw)(t),!0,(e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){var l;let t=null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.row;ie("code",null===t||void 0===t?void 0:t.code),ie("uom",null===t||void 0===t?void 0:t.uomName),ie("fromStoreLocationId",null),U(null),ie("quantity",null),E(null),ie("qtyStk",null),M(t)}}),!!d)}),(0,C.jsx)(n.Ay,{item:!0,xs:12,sm:4,children:ve("code","Code","text",!0,void 0,!0)}),(0,C.jsx)(n.Ay,{item:!0,xs:12,sm:4,children:me("fromStoreLocationId","From Store Location",W&&W.filter((e=>Le.every((t=>!e.name.toLowerCase().includes(t))))),!0,(e=>{var t,l,a,o,i;null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value&&(te(!0),xe([]),Se([]),u.material_serial_numbers=[],ie("qtyStk","0"),E("0"),U(null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.value),$(null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.name),le((0,j.a2o)({project:null===r||void 0===r?void 0:r.projectId,store:null===r||void 0===r?void 0:r.projectSiteStoreId,storeLocation:null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.value,material:null===P||void 0===P?void 0:P.id})),le((0,j.J9T)({project:null===r||void 0===r?void 0:r.projectId,store:null===r||void 0===r?void 0:r.projectSiteStoreId,storeLocation:null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.value,material:null===P||void 0===P?void 0:P.id})))}),!1)}),(0,C.jsx)(n.Ay,{item:!0,xs:12,sm:2,children:ve("quantity","Quantity",(0,k.VF)(de)?"text":"number",!0,(e=>{var t,l;(0,k.VF)(de)?K(!1):K(!0),I(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value),ie("value",((null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.value)*z).toFixed(2))}))}),(0,C.jsx)(n.Ay,{item:!0,xs:12,sm:2,children:ve("qtyStk","Qty In Stock","number",!1,void 0,!0)}),(0,C.jsx)(n.Ay,{item:!0,xs:12,sm:2,children:ve("uom","UOM","text",!0,void 0,!0)}),(0,C.jsx)(n.Ay,{item:!0,xs:12,sm:2,style:{display:"none"},children:ve("uomId","UOMId","text",!0)}),(0,C.jsx)(n.Ay,{item:!0,xs:12,sm:2,...m&&{display:"none"},children:ve("rate","Rate","text",!0,(e=>{var t;T(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)}),!0)}),(0,C.jsx)(n.Ay,{item:!0,xs:12,sm:2,...m&&{display:"none"},children:ve("tax","Tax%","text",!0,void 0,!0)}),(0,C.jsx)(n.Ay,{item:!0,xs:12,sm:2,...m&&{display:"none"},children:ve("value","Value","number",!0,void 0,!0)}),(0,C.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,C.jsx)(A.gk,{name:"willReturn",labels:[{value:!0,name:"Yes"},{value:!1,name:"No"}],title:"Will Return",defaultValue:!0,required:!0})}),(0,C.jsxs)(n.Ay,{item:!0,xs:12,sm:2,sx:{textAlign:"center"},children:[((null===P||void 0===P?void 0:P.isSerialNumber)||d&&(null===u||void 0===u?void 0:u.isSerialNumber))&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(b.A,{mb:-1,children:"SerialNumber"})," ",(0,C.jsx)("br",{}),(0,C.jsx)(s.A,{size:"small",onClick:()=>{Se(Ce[null===P||void 0===P?void 0:P.id]),fe(!0)},variant:"contained",color:"primary",children:"View"})]}),V&&""!==V&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("br",{}),(0,C.jsx)(b.A,{color:"error",sx:{fontSize:12,marginTop:2},children:V})]})]}),(0,C.jsx)(n.Ay,{item:!0,xs:12,sm:12,mt:4,textAlign:"right",children:!i&&(0,C.jsx)(s.A,{size:"small",onClick:re((e=>{P&&null!==P&&void 0!==P&&P.isSerialNumber&&0===pe.length?R("Serial Number is required"):P&&null!==P&&void 0!==P&&P.isSerialNumber&&pe.length!==e.quantity?R(`Please select a total of ${e.quantity} serial numbers`):(R(!1),pe&&(e.material_serial_numbers=pe),e.tax=0===e.tax?"0":e.tax,e.fromStoreLocationName=H,l(e,null===P||void 0===P?void 0:P.id,(null===P||void 0===P?void 0:P.id)+Q),xe([]),Se([]),M(null),G([]),ie("qtyStk",null),E(null),X(!1),ne(),ie("willReturn",!0))})),variant:"contained",color:"primary",children:Y?"Update":"Add"})})]}),(0,C.jsx)(q.A,{open:ye,onClose:Ae,"aria-labelledby":"modal-modal-title",children:(0,C.jsx)(D.default,{handleCloseSerial:Ae,closeCss:F,quantity:f,setSerialNumbers:Ie})}),je&&(0,C.jsx)(w.default,{open:je,onClose:()=>{fe(!1)},maxQuantity:f,serialNumberData:be,showCheckboxes:!0,onSave:e=>{Ie(e)},selectedSerials:pe})]})})})};var z=l(99635),T=l(71826),W=l(62054),B=l(52351),P=l(68388);const M=e=>{let{values:t,onEdit:l,onDelete:a,onView:o}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(r.A,{title:"Edit",placement:"bottom",children:(0,C.jsx)(i.A,{color:"secondary",onClick:()=>l(t),children:(0,C.jsx)(d.A,{})})}),(0,C.jsx)(r.A,{title:"Delete",placement:"bottom",children:(0,C.jsx)(i.A,{color:"secondary",onClick:()=>a(t),children:(0,C.jsx)(u.A,{})})}),(null===t||void 0===t?void 0:t.isSerialNumber)&&(0,C.jsx)(r.A,{title:"View Serial Number",placement:"bottom",children:(0,C.jsx)(i.A,{color:"secondary",onClick:()=>o(t),children:(0,C.jsx)(m.A,{})})})]})},V=()=>{const e=(0,c.Zp)(),[t,l]=(0,a.useState)([]),[r,i]=(0,a.useState)({}),[d,u]=(0,a.useState)([]),[m,p]=(0,a.useState)(!1),[x,b]=(0,a.useState)(!1),[S,y]=(0,a.useState)(!1),[h,f]=(0,a.useState)(null),[I,g]=(0,a.useState)(!1),[N,q]=(0,a.useState)(!1),[D,O]=(0,a.useState)({}),[_,F]=(0,a.useState)([]),[V,R]=(0,a.useState)(null),[H,$]=(0,a.useState)(!1),[Q,U]=(0,a.useState)(null),J=(0,o.wA)(),G=(0,a.useMemo)((()=>[{Header:"Actions",accessor:"actions"},{Header:"Name",accessor:"name"},{Header:"Code",accessor:"code"},{Header:"Quantity",accessor:"quantity"},{Header:"UOM",accessor:"uomName"},{Header:"Rate",accessor:"rate"},{Header:"Tax",accessor:"tax"},{Header:"Value",accessor:"value"},{Header:"From Store Location",accessor:"fromStoreLocationName"}]),[]),Y=(0,a.useCallback)((()=>{f(null),q(!1)}),[]),X=(0,a.useCallback)((e=>{p(!1),y(!0),i({...e,StoreLocationId:null===h||void 0===h?void 0:h.contractorStoreLocationId})}),[h]),Z=e=>{U(e),$(!0),null!==e&&void 0!==e&&e.material_serial_numbers||R([])};(0,a.useEffect)((()=>{null!==Q&&void 0!==Q&&Q.material_serial_numbers&&R(null===Q||void 0===Q?void 0:Q.material_serial_numbers)}),[Q]);const{transactionMaterialList:K}=(0,v.t)(),{materials:ee}=(0,a.useMemo)((()=>{var e;return{materials:(null===K||void 0===K?void 0:K.stocksObject)||[],count:(null===K||void 0===K||null===(e=K.stocksObject)||void 0===e?void 0:e.count)||0,loading:null===K||void 0===K?void 0:K.loading}}),[K]);(0,a.useEffect)((()=>{ee&&ee.length>0&&l((e=>{const t=[];return e&&e.map((e=>{t.push({id:null===e||void 0===e?void 0:e.id,name:null===e||void 0===e?void 0:e.name,isSerialNumber:null===e||void 0===e?void 0:e.is_serial_number,tax:e.tax,value:e.value,uomName:e.uom_name,uomId:e.uom_id,rate:parseFloat(e.rate).toFixed(2),code:null===e||void 0===e?void 0:e.code,hsnCode:null===e||void 0===e?void 0:e.hsn_code})})),0===t.length&&(0,W.A)("No Material Available",{variant:"error"}),t})(ee).filter((e=>"84b473e1-62bb-4afe-af56-1691bdffbc55"!==e.id)))}),[ee]);const te=(e,l)=>{l&&(t.map((t=>{let a={};if(t.id===e.materialId){a={...t,...e},a.uomId=null===t||void 0===t?void 0:t.uomId,F((e=>[...e,a.fromStoreLocationId]));const o=d.findIndex((t=>t.id===l&&(null===e||void 0===e?void 0:e.fromStoreLocationId)===(null===t||void 0===t?void 0:t.fromStoreLocationId)));if(o>=0){const e=structuredClone(d);e[o]=a,u(e)}else u(d.concat(a))}})),y(!1))},le=(0,P.A)({dataObject:K,key:"stocksObject",resetTrigger:null===h});return(0,a.useEffect)((()=>{Array.isArray(le)&&0===le.length&&(Y(),(0,W.A)("There are no available materials for your selected combination",{variant:"error"}))}),[Y,le]),(0,C.jsxs)(C.Fragment,{children:[I&&(0,C.jsx)(B.A,{}),(0,C.jsx)(L,{onClick:Y,saveData:e=>{e&&e.projectId&&e.projectSiteStoreId&&(J((0,j.UjX)({project:e.projectId,store:e.projectSiteStoreId})),f(e),b(!0))},disableAll:N,setDisableAll:q}),h&&t&&t.length>0&&(0,C.jsx)(E,{materials:t,onMaterailsInput:(e,t,l)=>{te(e,t);const a=D;a[l]||(a[l]={}),a[l]=e,O(a)},hideTaxDetails:!0,formData:h,view:m,update:S,showData:r,selectedLocations:_,selectedItems:D}),h&&d&&x&&d.length>0&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(z.default,{title:"Material Transfer Company Store To Customer",hideHeader:!0,hidePagination:!0,data:(ae=d,ae&&ae.length>0&&ae.map(((e,t)=>({...e,actions:(0,C.jsx)(M,{values:e,onEdit:X,onDelete:e=>{((e,t)=>{if(d){const l=d.filter(((t,l)=>l!==e));let a=l.map((e=>e.fromStoreLocationId));u(l),F(a),delete D[t.materialId+t.fromStoreLocationId]}})(t,e)},onView:Z})})))),count:d.length,columns:G,hideActions:!0}),H&&Q&&V&&(0,C.jsx)(w.default,{open:H,onClose:()=>{$(!1)},serialNumberData:V})]}),h&&d&&d.length>0&&(0,C.jsx)(A.Op,{children:(0,C.jsx)(n.Ay,{container:!0,spacing:4,children:(0,C.jsxs)(n.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px",mt:2},children:[(0,C.jsx)(s.A,{onClick:Y,size:"small",variant:"outlined",color:"primary",children:"Back"}),(0,C.jsx)(s.A,{disabled:S||I,onClick:async()=>{var t,l,a,o,r,i,n,s,u;g(!0);const{transactionTypeId:c,projectId:m,projectSiteStoreId:v,toCustomerId:p,customerSiteStoreId:x,eWayBillNumber:b,eWayBillDate:S,transporterName:y,contactNumber:j,vehicleNumber:f,lrNumber:I,remarks:A}=h;var N=new Date;const C={transactionTypeId:c,eWayBillNumber:b,eWayBillDate:S,lrNumber:I,transporterName:y,transporterContactNumber:j,vehicleNumber:f,actualReceiptDate:N.toISOString(),remarks:A,fromOrganizationId:null!==h&&void 0!==h&&null!==(t=h.fromStoreDetails)&&void 0!==t&&null!==(l=t.organization)&&void 0!==l&&l.parentId?null===h||void 0===h||null===(a=h.fromStoreDetails)||void 0===a||null===(o=a.organization)||void 0===o?void 0:o.parentId:null===h||void 0===h||null===(r=h.fromStoreDetails)||void 0===r||null===(i=r.organization)||void 0===i?void 0:i.id,fromStoreId:v,...(null===h||void 0===h?void 0:h.placeOfSupply)&&{placeOfSupply:null===h||void 0===h?void 0:h.placeOfSupply},stock_ledgers:null===d||void 0===d?void 0:d.map((e=>{const{id:t,material_serial_numbers:l,fromStoreLocationId:a,quantity:o,rate:r,tax:i,uomId:n,value:s,willReturn:d}=e;return{transactionTypeId:c,organizationId:p,projectId:m,fromStoreLocationId:a,storeId:x,materialId:t,willReturn:d,uomId:n,quantity:o,rate:r,value:s,tax:i,remarks:A,serialNumber:l||[]}}))};if(0===(null===(n=C.stock_ledgers)||void 0===n?void 0:n.length))return(0,W.A)("Please have atleast one material with some quantity",{variant:"error"}),void g(!1);if((0,k.Rh)(null===C||void 0===C?void 0:C.stock_ledgers,"fromStoreLocationId"))return void g(!1);const L=await(0,T.default)("/stc-create",{method:"POST",body:C,timeoutOverride:12e4});var q;if(null===L||void 0===L||!L.success)return(0,W.A)((null===L||void 0===L||null===(q=L.error)||void 0===q?void 0:q.message)||"Something wrong happened!",{variant:"error"}),void g(!1);(0,W.A)(`Transaction created with reference number: ${null===L||void 0===L||null===(s=L.data)||void 0===s||null===(u=s.data)||void 0===u?void 0:u.referenceDocumentNumber}`,{variant:"success",autoHideDuration:1e4}),g(!1),e("/stc-receipt")},size:"small",variant:"contained",color:"primary",children:"Submit"})]})})})]});var ae}},62375:(e,t,l)=>{var a=l(24994);t.A=void 0;var o=a(l(79526)),r=l(44414);t.A=(0,o.default)((0,r.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")}}]);