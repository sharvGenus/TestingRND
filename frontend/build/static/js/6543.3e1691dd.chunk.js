"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[6543],{36543:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var a=r(9950),s=r(96583),o=r(27081),i=r(80733),d=r(66450),l=r(4139),n=r(67535),c=r(60666),u=r(9449),m=r(26473),v=r(71826),p=r(96951),y=r(14351),f=r(84601),b=r(62054),h=r(44414);const g=e=>{const{data:t,view:r,update:s,setRefresh:o,selectedProject:i,selectedMeterType:d,setSelectedProject:g,setSelectedMeterType:j,projectData:A,meterTypeData:S,setSelectedQAMaster:x,qaMastersData:M,observationTypeData:I,observationSeverityData:k,refreshPagination:C}=e,T=(0,u.mN)({resolver:(0,m.t)(c.Ik().shape({projectId:f.A.other,meterTypeId:f.A.other,masterId:f.A.other,majorContributor:f.A.other,code:f.A.other,priority:f.A.priority,defect:f.A.other,observationTypeId:f.A.other,observationSeverityId:f.A.other})),defaultValues:{},mode:"all"}),{handleSubmit:_,setValue:w,clearErrors:q,getValues:P}=T;(0,a.useEffect)((()=>{1===(null===A||void 0===A?void 0:A.length)&&(w("projectId",A[0].id),g(A[0].id))}),[A,g,w]);const L=(0,a.useCallback)((()=>{o();const e=P();T.reset({projectId:e.projectId,meterTypeId:e.meterTypeId,masterId:e.masterId,majorContributor:"",code:"",priority:"",defect:"",observationTypeId:"",observationSeverityId:""})}),[o,T,P]);(0,a.useEffect)((()=>{var e;(r||s)&&(w("projectId",i),w("meterTypeId",d),e=t,Object.entries(e).forEach((e=>{let[t,r]=e;w(t,r)}))),q()}),[t,s,r,w,q,L,i,d]);const O=function(e,t,a,o,i){let d=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return(0,h.jsx)(p.eu,{name:e,label:t,InputLabelProps:{shrink:!0},menus:a,onChange:i,...o&&{required:!0},...r||s?{disable:!["observationTypeId","observationSeverityId"].includes(e)||!s}:{},allowClear:d})},D=function(e,t,a,o){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return(0,h.jsx)(p.o3,{name:e,type:a,label:t,InputLabelProps:{shrink:i},...o&&{required:!0},...r?{disabled:!0}:s?{disabled:!1}:{}})};return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(p.Op,{methods:T,onSubmit:_((async e=>{let r,a={...e.id&&{id:e.id},masterId:e.masterId,majorContributor:e.majorContributor,code:e.code,priority:e.priority,defect:e.defect,observationTypeId:e.observationTypeId,observationSeverityId:e.observationSeverityId};if(r=s?await(0,v.default)("/qa-master-maker-lov-update",{method:"PUT",body:a,params:t.id}):await(0,v.default)("/qa-master-maker-lov-form",{method:"POST",body:a}),r.success){const e=s?"QA Master Maker LOV updated successfully!":"QA Master Maker LOV added successfully!";(0,b.A)(e,{variant:"success",autoHideDuration:1e4}),o(),C(),L()}else{var i,d;(0,b.A)((null===(i=r)||void 0===i||null===(d=i.error)||void 0===d?void 0:d.message)||"Operation failed. Please try again.",{variant:"error"})}})),children:(0,h.jsx)(y.A,{title:(r?"View ":s?"Update ":"Add ")+"QA Master LOV",sx:{mb:2},children:(0,h.jsxs)(l.Ay,{container:!0,spacing:4,children:[(0,h.jsx)(l.Ay,{item:!0,md:3,xl:2,children:O("projectId","Project Name",A,!0,(e=>{var t;g(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)}))}),(0,h.jsx)(l.Ay,{item:!0,md:3,xl:2,children:O("meterTypeId","Meter Type",S,!0,(e=>{var t;j(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)}))}),(0,h.jsx)(l.Ay,{item:!0,md:3,xl:2,children:O("masterId","Master Name",M,!0,(e=>{var t;x(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)}))}),(0,h.jsx)(l.Ay,{item:!0,md:3,xl:2,children:D("majorContributor","Major Contributor","text",!0)}),(0,h.jsx)(l.Ay,{item:!0,md:3,xl:2,children:D("code","Code","text",!0)}),(0,h.jsx)(l.Ay,{item:!0,md:3,xl:2,children:D("priority","Priority","number",!0)}),(0,h.jsx)(l.Ay,{item:!0,md:3,xl:2,children:D("defect","Defect","text",!0)}),(0,h.jsx)(l.Ay,{item:!0,md:3,xl:2,children:O("observationTypeId","Observation Type",I,!0,(()=>{}))}),(0,h.jsx)(l.Ay,{item:!0,md:3,xl:2,children:O("observationSeverityId","Observation Severity",k,!0,(()=>{}))}),(0,h.jsx)(l.Ay,{item:!0,md:12,sx:{display:"flex",justifyContent:"flex-end"},children:r?(0,h.jsx)(n.A,{onClick:L,size:"small",variant:"outlined",color:"primary",children:"Back"}):s?(0,h.jsxs)(l.Ay,{item:!0,sx:{display:"flex",gap:"20px"},children:[(0,h.jsx)(n.A,{size:"small",type:"submit",variant:"contained",color:"primary",children:"Update"}),(0,h.jsx)(n.A,{onClick:L,size:"small",variant:"outlined",color:"primary",children:"Back"})]}):(0,h.jsx)(n.A,{size:"small",type:"submit",variant:"contained",color:"primary",children:"Save"})})]})})})})};var j=r(29024),A=r(99635),S=r(89649),x=r(64499),M=r(39225),I=r(30423),k=r(65920),C=r(52867);const T=()=>{var e;const{paginations:{pageSize:t,pageIndex:r,forceUpdate:l},refreshPagination:n,setPageIndex:c,setPageSize:u}=(0,S.A)(),{searchString:m,setSearchString:p,accessorsRef:y,setAccessors:f,forceSearch:T,searchStringTrimmed:_}=(0,M.A)(),w=(0,o.wA)(),[q,P]=(0,a.useState)(null),[L,O]=(0,a.useState)(null),[D,H]=(0,a.useState)(null),[E,N]=(0,a.useState)(!1),[B,z]=(0,a.useState)(!1),[R,Q]=(0,a.useState)(!1),[U,V]=(0,a.useState)([]),[F,G]=(0,a.useState)([]),[J,K]=(0,a.useState)([]),[W,Y]=(0,a.useState)(null),[Z,$]=(0,a.useState)(null),[X,ee]=(0,a.useState)(null),[te,re]=(0,a.useState)(1),[ae,se]=(0,a.useState)(null),[oe,ie]=(0,a.useState)(!1),[de,le]=(0,a.useState)(!1),[ne,ce]=(0,a.useState)(null);(0,a.useEffect)((()=>{w((0,j.uiG)())}),[w]),(0,a.useEffect)((()=>{null!==W&&void 0!==W&&W.id&&w((0,j.a3B)({pageIndex:r,pageSize:t,listType:te,recordId:null===W||void 0===W?void 0:W.id}))}),[w,r,t,l,te,W]);const{filterObjectForApi:ue}=(0,I.bZ)(),me=(0,k.A)(ue),ve=(0,k.A)(ne);(0,a.useEffect)((()=>{q&&L&&w((0,j.caL)({projectId:q,meterTypeId:L}))}),[q,L,w]);const pe=(0,a.useCallback)((async e=>{const t=await(0,v.default)("/master-maker-lovs-list",{method:"GET",query:{masterId:e,forDropdown:"1"}});var r,a;if(t.success)return null===t||void 0===t||null===(r=t.data)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.rows;const s=t.error&&t.error.message?t.error.message:t.error;s&&(0,b.A)(s)}),[]),ye=(0,a.useCallback)((async()=>{let e=await pe("0eba82dc-29af-4694-b943-af7d86fc686f");V(e);let t=await pe("4a219c23-9458-410f-a56e-85d7eb7dc4fe");G(t);let r=await pe("0d6f899e-443d-46d6-a855-d609da7d2bd8");K(r)}),[pe]);(0,a.useEffect)((()=>{[[me,ue],[ve,ne]].some(C.$H)?n():(ye(),q&&L&&D&&w((0,j.iNL)({pageIndex:r,pageSize:t,listType:te,..._&&{searchString:_,accessors:JSON.stringify(y.current)},sortBy:null===ne||void 0===ne?void 0:ne[0],sortOrder:null===ne||void 0===ne?void 0:ne[1],selectedQAMaster:D,filterObject:ue})))}),[w,r,t,te,D,l,_,ne,y,T,n,me,ue,ve,q,L,ye]);const{projectsDropdown:fe}=(0,i.Y)(),be=null===fe||void 0===fe?void 0:fe.projectsDropdownObject,{masterMakerQAs:he}=(0,d.m)(),ge=(null===he||void 0===he||null===(e=he.qaMasterMakerObject)||void 0===e?void 0:e.rows)||[],{qaMasterMakerLovs:je,qaMasterMakerLovHistory:Ae}=(()=>{const[e,t]=(0,a.useState)({qaMasterMakerLovsObject:{},error:"",loading:!0}),[r,s]=(0,a.useState)({qaMasterMakersListObject:[],error:"",loading:!0}),[i,d]=(0,a.useState)({qaMasterMakerLovHistoryObject:{},error:"",loading:!0}),l=(0,o.d4)((e=>e.qaMasterMakerLov||{})),n=(0,o.d4)((e=>e.masterMakersLovsList||{})),c=(0,o.d4)((e=>e.qaMasterMakerLovHistory||{}));return(0,a.useEffect)((()=>{t((e=>({...e,...l})))}),[l]),(0,a.useEffect)((()=>{s((e=>({...e,...n})))}),[n]),(0,a.useEffect)((()=>{d((e=>({...e,...c})))}),[c]),{qaMasterMakerLovs:e,masterMakersLovsList:r,qaMasterMakerLovHistory:i}})(),{data:Se,count:xe}=(0,a.useMemo)((()=>{var e,t;return{data:(null===(e=je.qaMasterMakerLovsObject)||void 0===e?void 0:e.rows)||[],count:(null===(t=je.qaMasterMakerLovsObject)||void 0===t?void 0:t.count)||0,isLoading:je.loading||!1}}),[je]),{historyData:Me,historyCounts:Ie}=(0,a.useMemo)((()=>{var e,t;return{historyData:(null===(e=Ae.qaMasterMakerLovHistoryObject)||void 0===e?void 0:e.rows)||[],historyCounts:(null===(t=Ae.qaMasterMakerLovHistoryObject)||void 0===t?void 0:t.count)||0,isLoading:Ae.loading||!1}}),[Ae]),ke=(0,a.useMemo)((()=>[{Header:"Master Name",accessor:"qa_master_maker.name"},{Header:"Major Contributor",accessor:"majorContributor",filterProps:{tableName:"qa_master_maker_lovs",getColumn:"major_contributor",customAccessor:"majorContributor",masterId:D}},{Header:"Code",accessor:"code",filterProps:{tableName:"qa_master_maker_lovs",getColumn:"code",customAccessor:"code",masterId:D}},{Header:"Priority",accessor:"priority",filterProps:{tableName:"qa_master_maker_lovs",getColumn:"priority",customAccessor:"priority",masterId:D}},{Header:"Defect",accessor:"defect",filterProps:{tableName:"qa_master_maker_lovs",getColumn:"defect",customAccessor:"defect",masterId:D}},{Header:"Observation Type",accessor:"observation_type.name",filterProps:{tableName:"master_maker_lovs",getColumn:"name",customAccessor:"observationType"}},{Header:"Observation Severity",accessor:"observation_severity.name",filterProps:{tableName:"master_maker_lovs",getColumn:"name",customAccessor:"observationSeverity"}},{Header:"Updated On",accessor:"updatedAt"},{Header:"Updated By",accessor:"updated.name",filterProps:{tableName:"qa_master_maker_lovs",getColumn:"updated_by",customAccessor:"updatedBy",masterId:D}},{Header:"Created On",accessor:"createdAt"},{Header:"Created By",accessor:"created.name",filterProps:{tableName:"qa_master_maker_lovs",getColumn:"created_by",customAccessor:"createdBy",masterId:D}}]),[D]),Ce=()=>{ie(!1),le(!1),se(null)};return(0,a.useEffect)((()=>{H("")}),[q]),(0,a.useEffect)((()=>{H("")}),[L]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(g,{refreshPagination:n,selectedProject:q,setSelectedProject:P,selectedMeterType:L,setSelectedMeterType:O,selectedQAMaster:D,setSelectedQAMaster:H,setRefresh:Ce,projectData:be,meterTypeData:U||[],qaMastersData:ge,observationTypeData:F||[],observationSeverityData:J||[],...ae&&{data:ae},...oe&&{view:oe,update:!1},...de&&{update:de,view:!1}}),q&&L&&D&&(0,h.jsx)(A.default,{hideAddButton:!0,data:Se,columns:ke,count:xe,setPageIndex:c,setPageSize:u,pageIndex:r,pageSize:t,handleRowDelete:e=>{$(e),N(!0)},handleRowRestore:async e=>{ee(e),z(!0)},handleRowUpdate:e=>{le(!0),ie(!1),se(e)},handleRowHistory:e=>{Y(e),Q(!0)},handleRowView:e=>{ie(!0),le(!1),se(e)},hideImportButton:!1,listType:te,setListType:e=>{re(e),Ce()},searchConfig:{searchString:m,searchStringTrimmed:_,setSearchString:p,setAccessors:f},sortConfig:{sort:ne,setSort:ce},importConfig:{apiBody:{tableName:"qa_master_maker_lovs"}},exportConfig:{tableName:"qa_master_maker_lovs",fileName:"qa-master-lov",apiQuery:{listType:te,masterId:D,filterObject:ue}},importQA:!0,importCompeted:n}),(0,h.jsx)(x.A,{open:E,handleClose:()=>N(!1),handleConfirm:async()=>{const e=await(0,v.default)("/delete-qa-master-maker-lov",{method:"DELETE",params:Z});var t;e.success?(n(),N(!1)):(0,b.A)(null===e||void 0===e||null===(t=e.error)||void 0===t?void 0:t.message)},title:"Confirm Delete",message:"Are you sure you want to delete?",confirmBtnTitle:"Delete"}),(0,h.jsx)(x.A,{open:B,handleClose:()=>z(!1),handleConfirm:async()=>{const e={...X,isActive:"1"};(await(0,v.default)("/qa-master-maker-lov-update",{method:"PUT",body:e,params:e.id})).success&&(n(),z(!1))},title:"Confirm Restore",message:"Are you sure you want to restore?",confirmBtnTitle:"Restore"}),(0,h.jsx)(s.A,{open:R,onClose:()=>Q(!1),scroll:"paper",disableEscapeKeyDown:!0,maxWidth:"lg",children:(0,h.jsx)(A.default,{isHistory:!0,title:null===W||void 0===W?void 0:W.name,data:Me,columns:ke,count:Ie,hideActions:!0,hideSearch:!0,hideAddButton:!0,hideExportButton:!0,setPageIndex:c,setPageSize:u,pageIndex:r,pageSize:t})})]})}}}]);