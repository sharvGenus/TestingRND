"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[6900],{96900:(e,t,s)=>{s.r(t),s.d(t,{default:()=>H});var a=s(9950),r=s(27081),o=s(96583),n=s(59729),i=s(88848),d=s(55519),l=s(12257),c=s(4139),u=s(67535),m=s(60666),p=s(9449),g=s(26473),h=s(71826),f=s(96951),x=s(14351),v=s(84601),y=s(62054),A=s(44414);const S=e=>{const{setRefresh:t,data:s,view:r,update:o,refreshPagination:n,customerData:i,setSelectedCustomer:d}=e,S=(0,p.mN)({resolver:(0,g.t)(m.Ik().shape({name:v.A.name,code:v.A.code,customerId:v.A.other})),defaultValues:{},mode:"all"}),{handleSubmit:j,setValue:C,clearErrors:b,getValues:D}=S,w=(0,a.useCallback)((()=>{t();const e=D();S.reset({name:"",code:"",customerId:e.customerId})}),[t,S,D]);(0,a.useEffect)((()=>{var e,t;(s||w(),r||o)&&(C("customerId",null===s||void 0===s||null===(e=s.organization)||void 0===e?void 0:e.id),t=s,Object.entries(t).forEach((e=>{let[t,s]=e;C(t,s)})));b()}),[s,o,r,C,b,w]);const I=function(e,t,s,a){let n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return(0,A.jsx)(l.A,{spacing:1,children:(0,A.jsx)(f.o3,{name:e,type:s,label:t,InputLabelProps:{shrink:n},...a&&{required:!0},...r?{disabled:!0}:o?{disabled:!1}:{}})})};return(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(f.Op,{methods:S,onSubmit:j((async e=>{let t;if(t=o?await(0,h.default)("/customer-department-update",{method:"PUT",body:e,params:s.id}):await(0,h.default)("/customer-department-form",{method:"POST",body:e}),t.success){const e=o?"Department updated successfully!":"Department added successfully!";(0,y.A)(e,{variant:"success",autoHideDuration:1e4}),n(),w()}else{var a,r;(0,y.A)((null===(a=t)||void 0===a||null===(r=a.error)||void 0===r?void 0:r.message)||"Operation failed. Please try again.",{variant:"error"})}})),children:(0,A.jsxs)(x.A,{title:(r?"View ":o?"Update ":"Add ")+"Customer Department",children:[(0,A.jsxs)(c.Ay,{container:!0,spacing:4,children:[(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:(P="customerId",O="Customer Name",z=i,H=!0,k=e=>{var t;d(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)},(0,A.jsx)(l.A,{children:(0,A.jsx)(f.eu,{name:P,label:O,InputLabelProps:{shrink:!0},menus:z,onChange:k,...H&&{required:!0},...r?{disable:!0}:o?{disable:!1}:{}})}))}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:I("name","Department Name","text",!0)}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:I("code","Department Code","text",!0)}),(0,A.jsx)(c.Ay,{item:!0,md:3,xl:2,children:I("integrationId","Integration ID","text")})]}),(0,A.jsx)(c.Ay,{container:!0,spacing:2,alignItems:"end",sx:{mt:2},children:(0,A.jsx)(c.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px"},children:r?(0,A.jsx)(u.A,{onClick:w,size:"small",variant:"outlined",color:"primary",children:"Back"}):o?(0,A.jsxs)(c.Ay,{item:!0,sx:{display:"flex",gap:"20px"},children:[(0,A.jsx)(u.A,{size:"small",type:"submit",variant:"contained",color:"primary",children:"Update"}),(0,A.jsx)(u.A,{onClick:w,size:"small",variant:"outlined",color:"primary",children:"Back"})]}):(0,A.jsx)(c.Ay,{item:!0,sx:{display:"flex",gap:"20px"},children:(0,A.jsx)(u.A,{size:"small",type:"submit",variant:"contained",color:"primary",children:"Save"})})})})]})})});var P,O,z,H,k};var j=s(4992),C=s(99635),b=s(89649),D=s(64499),w=s(29024),I=s(39225),P=s(30423),O=s(65920),z=s(52867);const H=()=>{const{paginations:{pageSize:e,pageIndex:t,forceUpdate:s},refreshPagination:l,setPageIndex:c,setPageSize:u}=(0,b.A)(),{searchString:m,setSearchString:p,accessorsRef:g,setAccessors:f,forceSearch:x,searchStringTrimmed:v}=(0,I.A)(),[H,k]=(0,a.useState)(!1),[T,E]=(0,a.useState)(!1),[B,N]=(0,a.useState)(!1),[R,U]=(0,a.useState)(!1),[_,L]=(0,a.useState)(null),[M,V]=(0,a.useState)(null),[W,F]=(0,a.useState)(null),[q,G]=(0,a.useState)(1),[$,J]=(0,a.useState)(null),[K,Q]=(0,a.useState)(!1),[Z,X]=(0,a.useState)(!1),[Y,ee]=(0,a.useState)(null),te=(0,r.wA)(),{filterObjectForApi:se}=(0,P.bZ)(),ae=(0,O.A)(se),re=(0,O.A)(Y);(0,a.useEffect)((()=>{[[ae,se],[re,Y]].some(z.$H)?l():R&&te((0,n.iB)({pageIndex:t,pageSize:e,listType:q,customerId:R,...v&&{searchString:v,accessors:JSON.stringify(g.current)},sortBy:null===Y||void 0===Y?void 0:Y[0],sortOrder:null===Y||void 0===Y?void 0:Y[1],filterObject:se}))}),[te,t,e,q,R,v,Y,g,x,s,l,ae,se,re]),(0,a.useEffect)((()=>{te((0,w._G1)())}),[te]);const{masterMakerLovs:oe}=(0,i.$)(),ne=((e,t)=>{const s=e&&e.filter((e=>e.name===t));return s&&s.length?s[0].id:null})(oe.masterMakerLovsObject.rows,"CUSTOMER");(0,a.useEffect)((()=>{ne&&te((0,w.d8s)(ne))}),[te,ne]);const{organizationsDropdown:ie}=(0,d.G)(),de=null===ie||void 0===ie?void 0:ie.organizationDropdownObject;(0,a.useEffect)((()=>{null!==_&&void 0!==_&&_.id&&te((0,n._h)({pageIndex:t,pageSize:e,listType:q,recordId:null===_||void 0===_?void 0:_.id}))}),[te,t,e,s,q,_]);const{customerWiseCustomerDepartments:le,customerDepartmentsHistory:ce}=(0,j.H)(),{data:ue,count:me}=(0,a.useMemo)((()=>{var e,t;return{data:(null===(e=le.customerWiseCustomerDepartmentsObject)||void 0===e?void 0:e.rows)||[],count:(null===(t=le.customerWiseCustomerDepartmentsObject)||void 0===t?void 0:t.count)||0,isLoading:le.loading||!1}}),[le]),{historyData:pe,historyCounts:ge}=(0,a.useMemo)((()=>{var e,t;return{historyData:(null===(e=ce.customerDepartmentsHistoryObject)||void 0===e?void 0:e.rows)||[],historyCounts:(null===(t=ce.customerDepartmentsHistoryObject)||void 0===t?void 0:t.count)||0,isLoading:ce.loading||!1}}),[ce]),he=(0,a.useMemo)((()=>[{Header:"Customer Name",accessor:"organization.name"},{Header:"Department Name",accessor:"name",filterProps:{tableName:"customer_departments",getColumn:"name",customAccessor:"name"}},{Header:"Department Code",accessor:"code",filterProps:{tableName:"customer_departments",getColumn:"code",customAccessor:"code"}},{Header:"Integration ID",accessor:"integrationId",filterProps:{tableName:"customer_departments",getColumn:"integration_id",customAccessor:"integrationId"}},{Header:"Updated On",accessor:"updatedAt"},{Header:"Updated By",accessor:"updated.name",filterProps:{tableName:"users",getColumn:"name",customAccessor:"updatedBy"}},{Header:"Created On",accessor:"createdAt"},{Header:"Created By",accessor:"created.name",filterProps:{tableName:"users",getColumn:"name",customAccessor:"createdBy"}}]),[]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(S,{refreshPagination:l,setRefresh:()=>{Q(!1),X(!1),J(null)},customerData:de,setSelectedCustomer:U,...$&&{data:$},...K&&{view:K,update:!1},...Z&&{update:Z,view:!1}}),R&&(0,A.jsx)(C.default,{title:"Customer Department",data:ue,columns:he,count:me,setPageIndex:c,setPageSize:u,pageIndex:t,pageSize:e,handleRowRestore:async e=>{F(e),E(!0)},handleRowDelete:e=>{V(e),k(!0)},handleRowUpdate:e=>{X(!0),Q(!1),J(e)},handleRowHistory:e=>{L(e),N(!0)},handleRowView:e=>{Q(!0),X(!1),J(e)},listType:q,setListType:e=>{G(e)},searchConfig:{searchString:m,searchStringTrimmed:v,setSearchString:p,setAccessors:f},sortConfig:{sort:Y,setSort:ee},exportConfig:{tableName:"customer_departments",apiQuery:{listType:q,customerId:R,filterObject:se}}}),(0,A.jsx)(D.A,{open:H,handleClose:()=>k(!1),handleConfirm:async()=>{const e=await(0,h.default)("/delete-customer-department",{method:"DELETE",params:M});var t;e.success?(l(),k(!1)):(0,y.A)(null===e||void 0===e||null===(t=e.error)||void 0===t?void 0:t.message)},title:"Confirm Delete",message:"Are you sure you want to delete?",confirmBtnTitle:"Delete"}),(0,A.jsx)(D.A,{open:T,handleClose:()=>E(!1),handleConfirm:async()=>{const e={...W,isActive:"1"};(await(0,h.default)("/customer-department-update",{method:"PUT",body:e,params:e.id})).success&&(l(),E(!1))},title:"Confirm Restore",message:"Are you sure you want to restore?",confirmBtnTitle:"Restore"}),(0,A.jsx)(o.A,{open:B,onClose:()=>N(!1),scroll:"paper",disableEscapeKeyDown:!0,maxWidth:"lg",children:(0,A.jsx)(C.default,{isHistory:!0,title:null===_||void 0===_?void 0:_.name,data:pe,columns:he,count:ge,hideActions:!0,hideSearch:!0,hideAddButton:!0,hideExportButton:!0,setPageIndex:c,setPageSize:u,pageIndex:t,pageSize:e})})]})}}}]);