"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[2948],{88848:(e,t,o)=>{o.d(t,{$:()=>r});var a=o(9950),i=o(27081);const r=()=>{const[e,t]=(0,a.useState)({masterMakerLovsObject:{},error:"",loading:!0}),[o,r]=(0,a.useState)({masterMakerLovsObject:{},error:"",loading:!0}),[l,n]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[d,s]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[u,c]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[v,m]=(0,a.useState)({currencyObject:[],error:"",loading:!0}),[S,f]=(0,a.useState)({gstStatusObject:[],error:"",loading:!0}),[x,p]=(0,a.useState)({paymentTermObject:[],error:"",loading:!0}),[y,j]=(0,a.useState)({incotermsObject:[],error:"",loading:!0}),[g,h]=(0,a.useState)({titleObject:[],error:"",loading:!0}),[I,b]=(0,a.useState)({masterMakerLovHistoryObject:{},error:"",loading:!0}),A=(0,i.d4)((e=>e.masterMakerLov||{})),L=(0,i.d4)((e=>e.masterMakerLovList||{})),k=(0,i.d4)((e=>e.lovsForMasterName||[])),z=(0,i.d4)((e=>e.lovsForMasterNameSecond||[])),O=(0,i.d4)((e=>e.lovsForMasterNameThird||[])),M=(0,i.d4)((e=>e.currency||[])),w=(0,i.d4)((e=>e.gstStatus||[])),D=(0,i.d4)((e=>e.paymentTerm||[])),T=(0,i.d4)((e=>e.incoterms||[])),C=(0,i.d4)((e=>e.title||[])),q=(0,i.d4)((e=>e.masterMakerLovHistory||{}));return(0,a.useEffect)((()=>{t((e=>({...e,...A})))}),[A]),(0,a.useEffect)((()=>{r((e=>({...e,...L})))}),[L]),(0,a.useEffect)((()=>{n((e=>({...e,...k})))}),[k]),(0,a.useEffect)((()=>{s((e=>({...e,...z})))}),[z]),(0,a.useEffect)((()=>{c((e=>({...e,...O})))}),[O]),(0,a.useEffect)((()=>{m((e=>({...e,...M})))}),[M]),(0,a.useEffect)((()=>{f((e=>({...e,...w})))}),[w]),(0,a.useEffect)((()=>{p((e=>({...e,...D})))}),[D]),(0,a.useEffect)((()=>{j((e=>({...e,...T})))}),[T]),(0,a.useEffect)((()=>{h((e=>({...e,...C})))}),[C]),(0,a.useEffect)((()=>{b((e=>({...e,...q})))}),[q]),{masterMakerLovs:e,masterMakerLovsList:o,masterMakerOrgType:l,masterMakerOrgTypeSecond:d,masterMakerOrgTypeThird:u,masterMakerCurrency:v,masterMakerGstStatus:S,masterMakerIncoterms:y,masterMakerPaymentTerm:x,masterMakerLovHistory:I,masterMakerTitle:g}}},72948:(e,t,o)=>{o.r(t),o.d(t,{default:()=>$});var a=o(9950),i=o(27081),r=o(53065),l=o(57073),n=o(4139),d=o(67535),s=o(36089),u=o(28429),c=o(1308),v=o(62605),m=o(88848),S=o(26473),f=o(60666),x=o(12257),p=o(87233),y=o(74745),j=o(9449),g=o(80733),h=o(29024),I=o(3147),b=o(12952),A=o(55519),L=o(96951),k=o(14351),z=o(84601),O=o(52867),M=o(44414);const w=e=>{var t,o,r;let{saveData:l,disableAll:s,setDisableAll:u}=e;const[c,v]=(0,a.useState)(""),[w,D]=(0,a.useState)(null),[T,C]=(0,a.useState)([]),[q,E]=(0,a.useState)([]),[N,P]=(0,a.useState)([]),[F,_]=(0,a.useState)(""),[B,H]=(0,a.useState)(),W=(0,j.mN)({resolver:(0,S.t)(f.Ik().shape({projectId:z.A.project,organizationTypeId:z.A.organizationType,organizationId:z.A.organizationId,fromProjectSiteStoreId:z.A.fromStore,toStoreLocationId:z.A.serviceCenter,supplierId:z.A.supplier,...!(0,O.g6)(B)&&{eWayBillDate:z.A.requiredWithLabel("E-Way Bill Date")}})),defaultValues:{},mode:"all"}),{handleSubmit:$,setValue:V,watch:G,clearErrors:R}=W,Q=G("eWayBillNumber"),U=(0,i.wA)();(0,a.useEffect)((()=>{U((0,h.uiG)()),U((0,h._G1)()),U((0,h.VOH)("ORGANIZATION TYPE")),U((0,h.h6R)({transactionTypeId:"b442aa8c-92cb-420f-9e34-04764be59fc5"}))}),[U]);const{projectsDropdown:Y}=(0,g.Y)(),{masterMakerOrgType:J,masterMakerLovs:Z}=(0,m.$)(),X=((e,t)=>{const o=e&&e.filter((e=>e.name===t));return o&&o.length?o[0].id:void 0})(Z.masterMakerLovsObject.rows,"STSRC"),K=(J.masterObject||[]).filter((e=>"420e7b13-25fd-4d23-9959-af1c07c7e94b"===e.id||"decb6c57-6d85-4f83-9cc2-50e0630003df"===e.id));(0,a.useEffect)((()=>{H(Q)}),[Q]),(0,a.useEffect)((()=>{(0,O.g6)(B)&&(R("eWayBillDate"),V("eWayBillDate",""))}),[R,B,V]);const ee=e=>{"projectId"===e?(V("organizationTypeId",null),V("organizationId",null),V("organizationbranchId",null),V("fromProjectSiteStoreId",null),V("toStoreLocationId",null)):"organizationTypeId"===e?(V("organizationId",null),V("organizationbranchId",null),V("fromProjectSiteStoreId",null),V("toStoreLocationId",null)):"organizationId"===e?(V("organizationbranchId",null),V("fromProjectSiteStoreId",null),V("toStoreLocationId",null)):"organizationbranchId"===e?(V("fromProjectSiteStoreId",null),V("toStoreLocationId",null)):"fromProjectSiteStoreId"===e&&V("toStoreLocationId",null)},te=function(e,t,o,a,i){let r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return(0,M.jsx)(x.A,{children:(0,M.jsx)(L.eu,{name:e,label:t,..."function"===typeof i&&{onChange:i},InputLabelProps:{shrink:!0},menus:o,...s&&{disable:!0},...a&&{required:!0},...r&&{allowClear:!0}})})},oe=function(e,t,o,a){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return(0,M.jsx)(x.A,{spacing:1,children:(0,M.jsx)(L.o3,{name:e,type:o,label:t,InputLabelProps:{shrink:i},...s&&{disabled:!0},...a&&{required:!0}})})},ae=null===Y||void 0===Y?void 0:Y.projectsDropdownObject,{organizationStoresDropdown:ie}=(0,I.E)(),re=(null===(t=ie.organizationStoreDropdownObject)||void 0===t?void 0:t.rows)||[],{companyStoreLocations:le,firmStoreLocations:ne}=(0,b.V)(),de=null!==c&&void 0!==c&&c.toLowerCase().includes("company")?null===(o=le.companyStoreLocationsObject)||void 0===o?void 0:o.rows:null!==c&&void 0!==c&&c.toLowerCase().includes("contractor")?null===(r=ne.firmStoreLocationsObject)||void 0===r?void 0:r.rows:[],{organizationsDropdown:se,organizations:ue,organizationsLocByParent:ce}=(0,A.G)(),ve=se.organizationDropdownObject||[],me=ue.organizationObject.rows||[],{orgBranchData:Se}=(0,a.useMemo)((()=>({orgBranchData:ce.organizationObject.rows||[]})),[ce]),[fe,xe]=(0,a.useState)(null),pe=function(e){var t;let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){var a,i;ee(o?"organizationbranchId":"organizationId"),!o&&V("orgnanizationbranchId",null),V("fromProjectSiteStoreId",null),V("fromStoreLocationId",null),V("toStoreLocationId",null),!o&&U((0,h.VRs)({params:w+"/"+(null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value)})),xe(null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.value);let t=re.filter((t=>{var o;return t.organizationId===(null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.value)}));C(t)}};return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(k.A,{title:"STSRC (Store To Service Center)",sx:{mb:2},children:(0,M.jsx)(L.Op,{methods:W,children:(0,M.jsxs)(n.Ay,{container:!0,spacing:4,children:[(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:3,children:te("projectId","Project",ae,!0,(()=>{ee("projectId")}))}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:3,children:te("organizationTypeId","Organization Type",K,!0,(e=>{var t;if(ee("organizationTypeId"),null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){var o,a,i,r,l,n,d,s;V("orgnanizationId",null),V("orgnanizationbranchId",null),V("fromProjectSiteStoreId",null),V("fromStoreLocationId",null),V("toStoreLocationId",null),U((0,h.d8s)(null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.value)),U((0,h.h7m)(null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value));let t=null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.row;v(null===t||void 0===t?void 0:t.name),D(null===e||void 0===e||null===(r=e.target)||void 0===r?void 0:r.value),null!==t&&void 0!==t&&null!==(l=t.name)&&void 0!==l&&l.toLowerCase().includes("contractor")?U((0,h.c1B)(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value)):null!==t&&void 0!==t&&null!==(d=t.name)&&void 0!==d&&d.toLowerCase().includes("company")&&U((0,h.Ru7)(null===e||void 0===e||null===(s=e.target)||void 0===s?void 0:s.value))}}))}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:3,children:te("organizationId","Organization",(0,O.HF)(ve),!0,pe)}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:3,children:te("organizationbranchId","Organization Branch",(0,O.HF)(Se)||[],!1,(e=>{pe(e,!0)}),!0)}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:3,children:te("fromProjectSiteStoreId","From Store",T,!0,(e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){ee("fromProjectSiteStoreId"),V("fromStoreLocationId",null),V("toStoreLocationId",null);let t=de&&de.filter((t=>{var o,a,i;return(null===t||void 0===t?void 0:t.organizationStoreId)===(null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.value)&&(null===t||void 0===t||null===(a=t.organization_store)||void 0===a||null===(i=a.organization)||void 0===i?void 0:i.id)===fe}));E(t);let o=de&&de.filter((t=>{var o,a,i,r,l;return(null===t||void 0===t||null===(o=t.name)||void 0===o||null===(a=o.toLowerCase())||void 0===a?void 0:a.includes("service center"))&&(null===t||void 0===t||null===(i=t.organization_store)||void 0===i||null===(r=i.organization)||void 0===r?void 0:r.id)===fe&&(null===t||void 0===t?void 0:t.organizationStoreId)===(null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.value)}));P(o)}}))}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:3,children:te("supplierId","Supplier",(0,O.HF)(me),!0,(e=>{var t;const o=null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.row,a=o.cities?o.cities:o.city,i=o.registeredOfficeAddress?o.registeredOfficeAddress:o.address,r=o.registeredOfficePincode?o.registeredOfficePincode:o.pinCode;_(`${i}, ${a.name}, ${a.state.name}, ${a.state.country.name}, ${r}`)}))}),(0,M.jsxs)(n.Ay,{item:!0,xs:12,sm:6,children:[(0,M.jsx)(p.A,{children:"Address: "}),(0,M.jsx)(p.A,{mt:2,children:F})]}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:3,children:te("toStoreLocationId","Service Center Location",N,!0,(()=>{ee("toStoreLocationId")}))}),(0,M.jsx)(n.Ay,{item:!0,md:3,xl:3,children:oe("placeOfSupply","Place Of Supply","text",!1)}),(0,M.jsx)(n.Ay,{item:!0,md:3,xl:2,children:oe("vehicleNumber","Vehicle No./LR No.","text",!1)}),(0,M.jsx)(n.Ay,{item:!0,md:3,xl:2,children:oe("eWayBillNumber","E-Way Bill Number","text",!1)}),(0,M.jsx)(n.Ay,{item:!0,md:3,xl:2,children:oe("eWayBillDate","E-Way Bill Date","date",!1,(0,O.g6)(B))}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:3,children:oe("remarks","Remarks","text",!1)}),(0,M.jsx)(n.Ay,{container:!0,spacing:4,children:(0,M.jsx)(n.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px"},mt:2,children:!s&&(0,M.jsx)(d.A,{size:"small",variant:"contained",onClick:$((e=>{var t,o,a,i,r,n;const d=T.filter((t=>t.id===e.fromProjectSiteStoreId));u(!0),e.transactionTypeId=X,e.fromOrganizationId=null!==(t=d[0])&&void 0!==t&&null!==(o=t.organization)&&void 0!==o&&o.parentId?null===(a=d[0])||void 0===a||null===(i=a.organization)||void 0===i?void 0:i.parentId:null===(r=d[0])||void 0===r||null===(n=r.organization)||void 0===n?void 0:n.id,e.storeLocationData=q,l(e)})),color:"primary",children:"Next"})})}),(0,M.jsx)(n.Ay,{container:!0,sx:{mt:3,mb:3},children:(0,M.jsx)(n.Ay,{item:!0,md:12,xl:12,children:(0,M.jsx)(y.A,{})})})]})})})})};var D=o(65669),T=o(14563),C=o(95615),q=o(94826);const E={cursor:"pointer",fontSize:24},N=e=>{let{materials:t,onMaterailsInput:o,formData:r,storeLocationData:l,view:s,update:u,showData:c,selectedItems:m}=e;const[x,y]=(0,a.useState)(!1),[g,I]=(0,a.useState)(null),[b,A]=(0,a.useState)(null),[w,N]=(0,a.useState)(c&&c.rate?null===c||void 0===c?void 0:c.rate:null),[P,F]=(0,a.useState)(null),[_,B]=(0,a.useState)(""),[H,W]=(0,a.useState)(""),[$,V]=(0,a.useState)(null),[G,R]=(0,a.useState)([]),[Q,U]=(0,a.useState)(!1),[Y,J]=(0,a.useState)(!1),[Z,X]=(0,a.useState)(!1),K=(0,i.wA)(),ee="decb6c57-6d85-4f83-9cc2-50e0630003df";(0,a.useEffect)((()=>{ee&&K((0,h.c1B)({organizationType:ee}))}),[K,ee]),(0,a.useEffect)((()=>{y(!!s)}),[s,u]);const te=(0,j.mN)({resolver:(0,S.t)(f.Ik().shape({materialId:z.A.requiredWithLabel("Material"),quantity:Y?z.A.checkForInteger("Quantity",b):z.A.maxQuantity(b,!0),fromStoreLocationId:z.A.fromStoreLocationId})),defaultValues:{},mode:"all"}),{handleSubmit:oe,setValue:ae,reset:ie,watch:re}=te,le=re("uom");(0,a.useEffect)((()=>{var e;(s||u)&&c&&(U(!0),F(c),K((0,h.a2o)({project:null===r||void 0===r?void 0:r.projectId,store:null===r||void 0===r?void 0:r.fromProjectSiteStoreId,storeLocation:null===c||void 0===c?void 0:c.fromStoreLocationId,material:null===c||void 0===c?void 0:c.id})),K((0,h.J9T)({project:null===r||void 0===r?void 0:r.projectId,store:null===r||void 0===r?void 0:r.fromProjectSiteStoreId,storeLocation:null===c||void 0===c?void 0:c.fromStoreLocationId,material:null===c||void 0===c?void 0:c.id})),e=c,Object.entries(e).forEach((e=>{let[t,o]=e;"actions"!==t&&ae(t,o),"uomName"===t&&ae("uom",o),"uomId"===t&&ae("uomId",o),"id"===t&&ae("materialId",o)})))}),[s,u,c,ae,K,r]);const ne=(e,t,o,a,i)=>(0,M.jsx)(L.eu,{name:e,label:t,onChange:i,InputLabelProps:{shrink:!0},menus:o,...x&&{disable:!0},...a&&{required:!0}}),de=function(e,t,o,a,i){let r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return(0,M.jsx)(L.o3,{name:e,type:o,label:t,..."function"===typeof i&&{handleChange:i},InputLabelProps:{shrink:l},...(r||x)&&{disabled:!0},...a&&{required:!0}})},[se,ue]=(0,a.useState)([]),[ce,ve]=(0,a.useState)([]),[me,Se]=(0,a.useState)(!1),[fe,xe]=(0,a.useState)(!1),pe=e=>{ue(e)},ye=()=>{Se(!1)},{txnByLocationMaterial:je,serialNumbers:ge}=(0,v.t)();let{projectSLData:he}=(0,a.useMemo)((()=>({projectSLData:(null===je||void 0===je?void 0:je.stocksObject)||[],isLoading:je.loading||!1})),[je]);(0,a.useEffect)((()=>{he&&R(he)}),[he]),(0,a.useEffect)((()=>{G&&G.length>0?(ae("qtyStk",(0,O.$G)(G[0].quantity)),ae("rate",parseFloat(G[0].rate).toFixed(2)),N(parseFloat(G[0].rate).toFixed(2)),ae("tax",G[0].tax),ae("value",parseFloat(G[0].rate*c.approvedQuantity).toFixed(2)),A((0,O.$G)(G[0].quantity))):(ae("qtyStk","0"),ae("rate","0"),N(0),ae("tax","0"),ae("value","0"),A(0))}),[G,ae,c]);const{serialNumbersData:Ie}=(0,a.useMemo)((()=>{var e;return{serialNumbersData:(null===ge||void 0===ge?void 0:ge.data)||[],countSN:(null===ge||void 0===ge||null===(e=ge.data)||void 0===e?void 0:e.count)||0}}),[ge]);(0,a.useEffect)((()=>{if(G&&G.length>0&&null!==$){if(X(!1),m&&P&&P.id&&$&&m[P.id+$]){let e=m[P.id+$];ae("qtyStk",(0,O.$G)(G[0].quantity)),ae("quantity",e.quantity),ue(e.material_serial_numbers)}else ae("qtyStk",(0,O.$G)(G[0].quantity)),ae("quantity",u&&c&&c.quantity?c.quantity:0),ue(u&&c&&c.material_serial_numbers?c.material_serial_numbers:[]);A((0,O.$G)(G[0].quantity)),ae("rate",parseFloat(G[0].rate).toFixed(2)),N(parseFloat(G[0].rate).toFixed(2)),ae("tax",G[0].tax),ae("value",parseFloat(G[0].rate*c.approvedQuantity).toFixed(2))}else X(!1),ae("qtyStk",null!==$?0:null),ae("rate","0"),N(0),ae("tax","0"),ae("value","0"),A(null)}),[G,ae,m,u,P,$,c]);const be=["missing","consumed","billing","installed","installer","service-center","service center","non-repairable","non repairable"];return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(k.A,{sx:{mb:2,pb:4},children:(0,M.jsxs)(L.Op,{methods:te,children:[Z&&(0,M.jsx)(q.A,{}),(0,M.jsxs)(n.Ay,{container:!0,spacing:2,sx:{mt:2},children:[(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:4,children:ne("materialId","Material",(Ae=t,Ae&&Ae.length>0&&Ae.map((e=>({...e,id:null===e||void 0===e?void 0:e.id,name:(null===e||void 0===e?void 0:e.code)+" - "+(null===e||void 0===e?void 0:e.name),code:null===e||void 0===e?void 0:e.code})))||[]),!0,(e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){var o;let t=null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.row;ae("code",null===t||void 0===t?void 0:t.code),ae("uom",null===t||void 0===t?void 0:t.uom_name),ae("uomId",null===t||void 0===t?void 0:t.uom_id),ae("fromStoreLocationId",null),V(null),ae("quantity",null),A(null),ae("qtyStk",null),F(t)}}))}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:4,children:de("code","Code","text",!0,void 0,!0)}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:4,children:ne("fromStoreLocationId","From Store Location",l&&l.filter((e=>be.every((t=>!e.name.toLowerCase().includes(t))))),!0,(e=>{var t,o,a,i,l;(X(!0),null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value)&&(ae("qtyStk","0"),A("0"),W(null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.name),V(null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value),K((0,h.a2o)({project:null===r||void 0===r?void 0:r.projectId,store:null===r||void 0===r?void 0:r.fromProjectSiteStoreId,storeLocation:null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.value,material:null===P||void 0===P?void 0:P.id})),K((0,h.J9T)({project:null===r||void 0===r?void 0:r.projectId,store:null===r||void 0===r?void 0:r.fromProjectSiteStoreId,storeLocation:null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.value,material:null===P||void 0===P?void 0:P.id})))}))}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:2,children:de("quantity","Quantity",(0,O.VF)(le)?"text":"number",!0,(e=>{var t,o;(0,O.VF)(le)?J(!1):J(!0),I(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value),ae("value",((null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.value)*w).toFixed(2))}))}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:2,children:de("qtyStk","Qty In Stock","number",!1,void 0,!0)}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:2,children:de("uom","UOM","text",!0,void 0,!0)}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:2,style:{display:"none"},children:de("uomId","UOMId","text",!0)}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:2,style:{display:"none"},children:de("rate","Rate","text",!0,(e=>{var t;N(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)}),!0)}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:2,style:{display:"none"},children:de("tax","Tax%","text",!0,void 0,!0)}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:2,style:{display:"none"},children:de("value","Value","number",!0,void 0,!0)}),(0,M.jsxs)(n.Ay,{item:!0,xs:12,sm:2,sx:{textAlign:"center"},children:[((null===P||void 0===P?void 0:P.is_serial_number)||u&&(null===c||void 0===c?void 0:c.is_serial_number))&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(p.A,{mb:-1,children:"SerialNumber"})," ",(0,M.jsx)("br",{})," ",(0,M.jsx)(d.A,{size:"small",onClick:()=>{ve(Ie[(null===P||void 0===P?void 0:P.id)||(null===c||void 0===c?void 0:c.id)]),xe(!0)},variant:"contained",color:"primary",children:"View"})]}),_&&""!==_&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("br",{}),(0,M.jsx)(p.A,{color:"error",sx:{fontSize:12,marginTop:2},children:_})]})]}),(0,M.jsx)(n.Ay,{item:!0,xs:12,sm:2,mt:4,textAlign:"right",children:!s&&(0,M.jsx)(d.A,{size:"small",onClick:oe((e=>{P&&null!==P&&void 0!==P&&P.is_serial_number&&0===se.length?B("Serial Number is required"):P&&null!==P&&void 0!==P&&P.is_serial_number&&se.length!==e.quantity?B(`Please select a total of ${e.quantity} serial numbers.`):(B(!1),se&&(e.material_serial_numbers=se),e.tax=0===e.tax?"0":e.tax,e.fromStoreLocationName=H,o(e,null===P||void 0===P?void 0:P.id,(null===P||void 0===P?void 0:P.id)+$),ue([]),F(null),R([]),ae("qtyStk",null),A(null),U(!1),ie())})),variant:"contained",color:"primary",children:Q?"Update":"Add"})})]}),(0,M.jsx)(D.A,{open:me,onClose:ye,"aria-labelledby":"modal-modal-title",children:(0,M.jsx)(T.default,{handleCloseSerial:ye,closeCss:E,quantity:g,setSerialNumbers:pe})}),fe&&(0,M.jsx)(C.default,{open:fe,onClose:()=>{xe(!1)},maxQuantity:g,serialNumberData:ce,showCheckboxes:!0,onSave:e=>{pe(e)},selectedSerials:se})]})})});var Ae};var P=o(99635),F=o(60845),_=o(71826),B=o(62054),H=o(68388);const W=e=>{let{values:t,onEdit:o,onDelete:a}=e;return(0,M.jsxs)("div",{children:[(0,M.jsx)(r.A,{title:"Edit",placement:"bottom",children:(0,M.jsx)(l.A,{color:"secondary",onClick:()=>o(t),children:(0,M.jsx)(s.A,{})})}),(0,M.jsx)(r.A,{title:"Delete",placement:"bottom",children:(0,M.jsx)(l.A,{color:"secondary",onClick:()=>a(t),children:(0,M.jsx)(c.A,{})})})]})},$=()=>{const e=(0,u.Zp)(),[t,o]=(0,a.useState)([]),[r,l]=(0,a.useState)([]),[s,c]=(0,a.useState)({}),[S,f]=(0,a.useState)(!1),[x,p]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!1),[g,I]=(0,a.useState)(!1),[b,A]=(0,a.useState)(!1),[k,z]=(0,a.useState)(null),[O,D]=(0,a.useState)(!1),[T,C]=(0,a.useState)({}),[q,E]=(0,a.useState)([]),{pathname:$}=(0,u.zy)();(0,a.useEffect)((()=>{l([]),D(!1)}),[$]);const V=(0,i.wA)(),G=(0,a.useMemo)((()=>[{Header:"Actions",accessor:"actions"},{Header:"Name",accessor:"name"},{Header:"Code",accessor:"code"},{Header:"Quantity",accessor:"quantity"},{Header:"UOM",accessor:"uom"},{Header:"From Store Location",accessor:"fromStoreLocationName"}]),[]);(0,a.useEffect)((()=>{V((0,h._G1)())}),[V]);const{masterMakerLovs:R}=(0,m.$)(),Q=((e,t)=>{const o=e&&e.filter((e=>e.name===t));return o&&o.length?o[0].id:void 0})(R.masterMakerLovsObject.rows,"COMPANY");(0,a.useEffect)((()=>{Q&&V((0,F.Ru)({organizationType:Q}))}),[V,Q]);const U=(0,a.useCallback)((()=>{z(null),D(!1),p(!1),j(!1),A(!1)}),[]),Y=e=>{f(!1),I(!0),c(e),A(!0)},{transactionMaterialList:J}=(0,v.t)();(0,a.useEffect)((()=>{null!==J&&void 0!==J&&J.stocksObject&&l(null===J||void 0===J?void 0:J.stocksObject)}),[null===J||void 0===J?void 0:J.stocksObject]);const Z=(e,a,i)=>{((e,a)=>{a&&(r.map((i=>{let r={};if(i.id===e.materialId){r={...i,...e},r.uomId=null===e||void 0===e?void 0:e.uomId,E((e=>[...e,r.fromStoreLocationId]));const l=t.findIndex((t=>t.materialId===a&&(null===e||void 0===e?void 0:e.fromStoreLocationId)===(null===t||void 0===t?void 0:t.fromStoreLocationId)));let n={...r};if(l>=0){const e=[...t];e[l]=n,o(e)}else o(t.concat(n))}})),I(!1))})(e,a);const l=T;l[i]||(l[i]={}),l[i]=e,C(l)},X=(0,H.A)({dataObject:J,key:"stocksObject",resetTrigger:null===k});return(0,a.useEffect)((()=>{Array.isArray(X)&&0===X.length&&(U(),(0,B.A)("There are no available materials for your selected combination",{variant:"error"}))}),[U,X]),(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(w,{onClick:U,saveData:e=>{e&&e.projectId&&e.fromProjectSiteStoreId&&(p(!0),j(!0),V((0,h.UjX)({project:e.projectId,store:e.fromProjectSiteStoreId})),z(e))},disableAll:O,setDisableAll:D}),y&&r&&r.length>0&&(0,M.jsx)(N,{onMaterailsInput:(e,t,o)=>{Z(e,t);const a=T;a[o]||(a[o]={}),a[o]=e,C(a),A(!1)},storeLocationData:null===k||void 0===k?void 0:k.storeLocationData,formData:k,view:S,update:g,showData:s,materials:r,selectedLocations:q,selectedItems:T}),x&&t&&t.length>0&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(P.default,{title:"STSRC",hideHeader:!0,hidePagination:!0,data:(e=>{let a=[];return e&&e.length>0&&e.map(((e,i)=>{a.push({...e,actions:(0,M.jsx)(W,{values:e,onEdit:Y,onDelete:e=>{((e,a)=>{if(t){const i=t.filter(((t,o)=>o!==e));let r=i.map((e=>e.fromStoreLocationId));o(i),E(r),delete T[a.materialId+a.fromStoreLocationId]}})(i,e)}})})})),a})(t),count:t.length,columns:G,hideActions:!0}),(0,M.jsx)(L.Op,{children:(0,M.jsx)(n.Ay,{container:!0,spacing:4,children:(0,M.jsxs)(n.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px",mt:2},children:[(0,M.jsx)(d.A,{onClick:U,size:"small",variant:"outlined",color:"primary",children:"Back"}),(0,M.jsx)(d.A,{disabled:b,onClick:async()=>{var o,a,i;A(!0);const r=(()=>{const{transactionTypeId:e,projectId:o,organizationId:a,fromProjectSiteStoreId:i,toStoreLocationId:r,supplierId:l,placeOfSupply:n,vehicleNumber:d,eWayBillNumber:s,eWayBillDate:u,remarks:c}=k;return{transactionTypeId:e,supplierId:l,placeOfSupply:n,vehicleNumber:d,...s&&""!==s&&{eWayBillNumber:s},...s&&""!==s&&u&&""!==u&&{eWayBillDate:u},remarks:c,stock_ledgers:(null===t||void 0===t?void 0:t.map((t=>{const l=parseFloat(t.quantity)*t.rate;return{transactionTypeId:e,projectId:o,organizationId:a,storeId:i,storeLocationId:r,fromStoreLocationId:null===t||void 0===t?void 0:t.fromStoreLocationId,materialId:t.id,uomId:t.uom_id,quantity:t.quantity,rate:t.rate,value:l,tax:t.tax,remarks:c,serialNumber:t.material_serial_numbers}})))||[]}})(),l=await(0,_.default)("/location-to-other-location",{method:"POST",body:r});var n;if(!l.success)return(0,B.A)((null===l||void 0===l||null===(n=l.error)||void 0===n?void 0:n.message)||"Operation failed. Please try again!",{variant:"error"}),void A(!1);const d=null!==(o=null===(a=l.data)||void 0===a?void 0:a.data)&&void 0!==o?o:{},s=d.referenceDocumentNumber||(null===(i=d[0])||void 0===i?void 0:i.referenceDocumentNumber);(0,B.A)(s?`Transaction created with reference number: ${s}`:"Transaction created successfully!",{variant:"success",autoHideDuration:1e4}),setTimeout((()=>{A(!1)}),100),e("/stsrc-receipt")},size:"small",variant:"contained",color:"primary",children:"Submit"})]})})})]})]})}},1308:(e,t,o)=>{o.d(t,{A:()=>r});var a=o(65471),i=o(44414);const r=(0,a.A)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline")}}]);