"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[2590,2480],{42480:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var a=r(43858),i=r(72179),l=r(12257),o=r(67535),s=r(95537),n=r(14341),d=r(9950),c=r(9449),u=r(62054),v=r(44414);const m=e=>{var t=e[0].name||e[0].fileName;return t=t.length>10?`${t.slice(0,7)}...${t.slice(-9)}`:t,1===e.length?t:`${t} (+${e.length-1} other)`},p={display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #1677FF",color:"#1677FF",borderRadius:5,padding:"5px 10px",width:123,cursor:"pointer"},h={margin:"auto 0 auto 10px",cursor:"pointer",color:"rgb(51, 126, 232)"},g={width:"100%","& .MuiFormHelperText-root":{marginLeft:"1px",marginTop:"7px",marginBottom:"10px"},"& .MuiInputBase-root":{display:"none"}},f=e=>{let{label:t,name:r,accept:f,value:x,setValue:j,multiple:b=!1,required:A=!1,...k}=e;const{control:y}=(0,c.xW)(),[S,w]=(0,d.useState)(null);(0,d.useEffect)((()=>{x&&w(x)}),[x]);const C=()=>{w(null),j(r,"")},N=(e,t)=>{const a=t.target.files;w(a);const i=Object.values(a).map((e=>new Promise(((t,r)=>{const a=new FileReader;a.onloadend=()=>t({action:"create",fileName:e.name,fileData:a.result}),a.onerror=r,a.readAsDataURL(e)}))));return Promise.all(i).then((e=>{j(`${r}-paths`,e)})).catch((e=>{C(),(0,u.A)(e.message||"Something wrong happend while picking the file(s)",{variant:"error"})})),e(t)};return y?(0,v.jsx)(c.xI,{name:r,control:y,render:e=>{let{field:{onChange:o,...d},fieldState:{error:c}}=e;return(0,v.jsx)(l.A,{spacing:1,mt:1,children:(0,v.jsxs)(s.A,{children:[(0,v.jsxs)(s.A,{display:"flex",children:[(0,v.jsx)("label",{htmlFor:`${r}-file`,children:(0,v.jsxs)("div",{style:p,children:[(0,v.jsx)(a.A,{}),"\xa0",t,A&&" *"]})}),S&&S.length>0&&(0,v.jsx)(i.A,{onClick:C,style:h})]}),(0,v.jsx)(n.A,{...d,id:`${r}-file`,name:r,helperText:(null===c||void 0===c?void 0:c.message)||S&&S.length>0&&m(S),error:!!c,sx:g,onChange:N.bind(void 0,o),inputProps:{multiple:b,accept:f},type:"file",...k})]})})}}):(0,v.jsx)(l.A,{spacing:1,children:A?(0,v.jsxs)(o.A,{size:"small",variant:"outlined",htmlFor:"files",color:"primary",required:!0,children:[(0,v.jsx)(a.A,{}),"\xa0",t]}):(0,v.jsx)(o.A,{size:"small",variant:"outlined",htmlFor:"files",color:"primary",children:t})})}},95796:(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var a=r(9950),i=r(67535),l=r(87233),o=r(86898),s=r(43858),n=r(62054),d=r(42480),c=r(53065),u=r(10158),v=r(2871),m=r(37223),p=r(88694),h=r(93951),g=r(44414);const f=e=>{let{onDownload:t,onDelete:r,onUndo:a,flaggedForDeletion:i,update:l}=e;return(0,g.jsx)(o.A,{children:i?(0,g.jsx)(c.A,{title:"Undo Delete",placement:"top",children:(0,g.jsx)(p.A,{onClick:a,children:(0,g.jsx)(h.A,{children:(0,g.jsx)(v.A,{})})})}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.A,{title:"Download",placement:"top",children:(0,g.jsx)(p.A,{onClick:t,children:(0,g.jsx)(h.A,{children:(0,g.jsx)(m.A,{})})})}),l&&(0,g.jsx)(c.A,{title:"Delete",placement:"top",children:(0,g.jsx)(p.A,{onClick:r,children:(0,g.jsx)(h.A,{children:(0,g.jsx)(u.A,{})})})})]})})};var x=r(52867);const j=e=>{const t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)},b=(0,a.lazy)((()=>Promise.all([r.e(3650),r.e(2043),r.e(7477),r.e(9635)]).then(r.bind(r,99635)))),A=(0,a.lazy)((()=>Promise.resolve().then(r.bind(r,22852)))),k=["png","jpeg","jpg","webp","gif","avif","tiff","svg"],y={display:"flex",alignItems:"center",justifyContent:"center",overflow:"scroll"},S={border:"1px solid #1677FF",color:"#1677FF",backgroundColor:"transparent",borderRadius:"5px",padding:"5px 10px",width:125,height:"28px",cursor:"pointer"},w={borderRadius:"10px",width:"85%",height:"80%",backgroundColor:"white",paddingBottom:"3rem",overflow:"scroll"},C={position:"absolute",justifySelf:"end",marginY:"1rem"},N={marginRight:"5px"},L=e=>e.replace("-paths",""),O=[{Header:"Actions",accessor:"actions"},{Header:"File Name",accessor:"fileName"},{Header:"Preview",accessor:"preview"}],D=e=>{let{data:t,tasks:r,setTasks:c,update:u,view:v,setValue:m,fileFields:p}=e;const h=(e=>e?Object.fromEntries(Object.entries(e).filter((e=>{let[t]=e;return t.includes("-paths")}))):{})((0,x.x5)(t,p)),[D,M]=(0,a.useState)(null),F=()=>{if(v)return void M(null);const{multiple:e,required:t}=D,a=((e,t)=>{var r;if(!e)return 0;const a=t.filter((t=>"delete"===t.action&&t.key===(null===e||void 0===e?void 0:e.key))).length,i=t.filter((t=>"create"===t.action&&t.key===(null===e||void 0===e?void 0:e.key))).length;return((null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.length)||0)+i-a})(D,r);var i;!e&&a>1?(0,n.A)(`Multple ${null===D||void 0===D?void 0:D.title.toLowerCase()} not allowed. Delete the existing or current.`,{variant:"error"}):t&&0===a?(0,n.A)(`Must have at least one ${null===D||void 0===D||null===(i=D.title)||void 0===i?void 0:i.toLowerCase()}`,{variant:"error"}):M(null)},H=(0,a.useCallback)((e=>{c((t=>[...t,{key:null===D||void 0===D?void 0:D.key,action:"delete",filePath:e}]))}),[null===D||void 0===D?void 0:D.key,c]),P=(0,a.useCallback)((e=>r.filter((t=>"object"===typeof t&&t.key===(null===D||void 0===D?void 0:D.key)&&t.filePath===e&&"delete"===t.action)).map((e=>e.filePath)).includes(e)),[null===D||void 0===D?void 0:D.key,r]),R=(0,a.useCallback)((e=>{c(r.filter((t=>!(t.filePath==e&&t.key===(null===D||void 0===D?void 0:D.key)&&"delete"===t.action))))}),[null===D||void 0===D?void 0:D.key,c,r]),T=(0,a.useMemo)((()=>{var e;return null===D||void 0===D||null===(e=D.data)||void 0===e?void 0:e.map((e=>{const t=`/api/v1/files/${e}`,r=e.split("/").pop();return{filePath:e,actions:(0,g.jsx)(f,{flaggedForDeletion:P(e),onDownload:()=>(e=>{let{fileUrl:t,fileName:r}=e;fetch(t,{method:"GET",headers:{"Content-Disposition":"attachment"}}).then((e=>e.blob())).then((e=>{const t=window.URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.setAttribute("download",r),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t)})).catch((e=>{(0,n.A)(e.message||"Something wrong happened while downloading the file",{variant:"error"})}))})({fileUrl:t,fileName:r}),onDelete:()=>H(e),onUndo:()=>R(e),update:u}),fileName:r,preview:(a=e.split(".").pop(),k.includes(a.toLowerCase())?(0,g.jsx)("img",{width:"400px",height:"auto",alt:e,src:t}):"N/A")};var a}))}),[P,H,R,null===D||void 0===D?void 0:D.data,u]);return t?(0,g.jsxs)(g.Fragment,{children:[Object.entries(h).map((e=>{let[t,r]=e;return(0,g.jsxs)(i.A,{disableRipple:!0,sx:S,variant:"outlined",onClick:()=>{const[{required:e,multiple:a,accept:i,label:l}]=p.filter((e=>e.name===L(t)));M({key:t,required:e,multiple:a,accept:i,title:l,data:r})},children:[(0,g.jsx)(s.A,{style:N}),j(L(t))]},t)})),(0,g.jsx)(a.Suspense,{fallback:(0,g.jsx)(g.Fragment,{}),children:D&&(0,g.jsx)(A,{open:!0,sx:y,children:(0,g.jsx)(o.A,{style:w,children:(0,g.jsx)(o.A,{marginTop:"5rem",display:"grid",children:(0,g.jsxs)(o.A,{width:"80%",height:"100%",margin:"auto",display:"grid",children:[(0,g.jsx)(l.A,{gutterBottom:!0,variant:"h3",children:D.title}),(0,g.jsx)(a.Suspense,{fallback:(0,g.jsx)(g.Fragment,{}),children:(0,g.jsx)(b,{hideActions:!0,hideHeader:!0,hidePagination:!0,columns:O,data:T||[],count:(null===T||void 0===T?void 0:T.length)||0})}),(0,g.jsxs)(o.A,{position:"relative",display:"grid",children:[u&&(0,g.jsx)(o.A,{marginY:"1rem",justifySelf:"start",children:(0,g.jsx)(d.default,{name:L(D.key),label:"Add More",accept:null===D||void 0===D?void 0:D.accept,multiple:null===D||void 0===D?void 0:D.multiple,value:r.filter((e=>"create"===e.action&&e.key===(null===D||void 0===D?void 0:D.key))),setValue:(e,t)=>{var a=r.filter((e=>!("create"===e.action&&e.key===(null===D||void 0===D?void 0:D.key))));t&&(a=[...a,...t.map((e=>({...e,key:D.key})))]),c(a),m(L(D.key),"")}})}),v?(0,g.jsx)(i.A,{sx:C,type:"button",variant:"outlined",onClick:F,children:"Close"}):(0,g.jsx)(i.A,{sx:C,type:"button",variant:"contained",onClick:F,children:"Submit"})]})]})})})})})]}):(0,g.jsx)(g.Fragment,{})}},88694:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(59254),i=r(67535);const l=(0,a.Ay)(i.A)((e=>{let{margin:t}=e;return{background:"none",border:"none",padding:"3px",margin:t||"-3px",minWidth:"1px","&:hover":{backgroundColor:"#E6F4FF"}}}))},88848:(e,t,r)=>{r.d(t,{$:()=>l});var a=r(9950),i=r(27081);const l=()=>{const[e,t]=(0,a.useState)({masterMakerLovsObject:{},error:"",loading:!0}),[r,l]=(0,a.useState)({masterMakerLovsObject:{},error:"",loading:!0}),[o,s]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[n,d]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[c,u]=(0,a.useState)({masterObject:[],error:"",loading:!0}),[v,m]=(0,a.useState)({currencyObject:[],error:"",loading:!0}),[p,h]=(0,a.useState)({gstStatusObject:[],error:"",loading:!0}),[g,f]=(0,a.useState)({paymentTermObject:[],error:"",loading:!0}),[x,j]=(0,a.useState)({incotermsObject:[],error:"",loading:!0}),[b,A]=(0,a.useState)({titleObject:[],error:"",loading:!0}),[k,y]=(0,a.useState)({masterMakerLovHistoryObject:{},error:"",loading:!0}),S=(0,i.d4)((e=>e.masterMakerLov||{})),w=(0,i.d4)((e=>e.masterMakerLovList||{})),C=(0,i.d4)((e=>e.lovsForMasterName||[])),N=(0,i.d4)((e=>e.lovsForMasterNameSecond||[])),L=(0,i.d4)((e=>e.lovsForMasterNameThird||[])),O=(0,i.d4)((e=>e.currency||[])),D=(0,i.d4)((e=>e.gstStatus||[])),M=(0,i.d4)((e=>e.paymentTerm||[])),F=(0,i.d4)((e=>e.incoterms||[])),H=(0,i.d4)((e=>e.title||[])),P=(0,i.d4)((e=>e.masterMakerLovHistory||{}));return(0,a.useEffect)((()=>{t((e=>({...e,...S})))}),[S]),(0,a.useEffect)((()=>{l((e=>({...e,...w})))}),[w]),(0,a.useEffect)((()=>{s((e=>({...e,...C})))}),[C]),(0,a.useEffect)((()=>{d((e=>({...e,...N})))}),[N]),(0,a.useEffect)((()=>{u((e=>({...e,...L})))}),[L]),(0,a.useEffect)((()=>{m((e=>({...e,...O})))}),[O]),(0,a.useEffect)((()=>{h((e=>({...e,...D})))}),[D]),(0,a.useEffect)((()=>{f((e=>({...e,...M})))}),[M]),(0,a.useEffect)((()=>{j((e=>({...e,...F})))}),[F]),(0,a.useEffect)((()=>{A((e=>({...e,...H})))}),[H]),(0,a.useEffect)((()=>{y((e=>({...e,...P})))}),[P]),{masterMakerLovs:e,masterMakerLovsList:r,masterMakerOrgType:o,masterMakerOrgTypeSecond:n,masterMakerOrgTypeThird:c,masterMakerCurrency:v,masterMakerGstStatus:p,masterMakerIncoterms:x,masterMakerPaymentTerm:g,masterMakerLovHistory:k,masterMakerTitle:b}}},14401:(e,t,r)=>{r.r(t),r.d(t,{default:()=>k});var a=r(96583),i=r(9950),l=r(27081),o=r(88848),s=r(62605),n=r(29024),d=r(52867),c=r(99635),u=r(89649),v=r(14846),m=r(3252),p=r(75682),h=r(95796),g=r(83456),f=r(39225),x=r(44414);const j=(0,m.A)((0,i.lazy)((()=>r.e(6439).then(r.bind(r,46439))))),b=[{Header:"Actions",accessor:"actionButtons"},{Header:"Receipt Number",accessor:"referenceDocumentNumber"},{Header:"Supplier",accessor:"supplierName"},{Header:"Project",accessor:"toProject.name"},{Header:"Invoice Number",accessor:"invoiceNumber"},{Header:"Invoice Date",accessor:"invoiceDate"},{Header:"Receiving Store",accessor:"toStore.name"},{Header:"Status",accessor:"status",exportAccessor:"isActive"},{Header:"PO Number",accessor:"poNumber"},{Header:"PO Date",accessor:"poDate"},{Header:"Transporter Name",accessor:"transporterName"},{Header:"Transporter Contact Number",accessor:"transporterContactNumber"},{Header:"Vehicle Number",accessor:"vehicleNumber"},{Header:"LR Number",accessor:"lrNumber"},{Header:"E-Way Bill Number",accessor:"eWayBillNumber"},{Header:"E-Way Bill Date",accessor:"eWayBillDate"},{Header:"Actual Receipt Date",accessor:"actualReceiptDate"},{Header:"Files",accessor:"files"},{Header:"Created Date",accessor:"createdAt"},{Header:"Updated Date",accessor:"updatedAt"},{Header:"Remarks",accessor:"remarks"}],A=[{name:"attachments",label:"Attachments",accept:"*",required:!1,multiple:!0}],k=()=>{var e,t,r,m,k;const y=(0,l.wA)(),[S,w]=(0,i.useState)("closed"),[C,N]=(0,i.useState)(!1),[L,O]=(0,i.useState)(!1),[D,M]=(0,i.useState)(null),[F,H]=(0,i.useState)(null),[P,R]=(0,i.useState)(null),[T,E]=(0,i.useState)(null),{paginations:{pageSize:z,pageIndex:$,forceUpdate:B},setPageIndex:I,refreshPagination:U,setPageSize:W}=(0,u.A)(),{searchString:q,setSearchString:V,accessorsRef:G,setAccessors:_,forceSearch:Y,searchStringTrimmed:J}=(0,f.A)(),{stockLedgerDetailList:K}=(0,s.t)(),{masterMakerOrgType:Q}=(0,o.$)(),Z=null===Q||void 0===Q?void 0:Q.masterObject,{data:X,count:ee}=(0,i.useMemo)((()=>{var e,t,r;return{data:(null===(e=(0,d.yN)(null===K||void 0===K||null===(t=K.stockLedgerDetailListObject)||void 0===t?void 0:t.rows))||void 0===e?void 0:e.map(((e,t)=>{var r,a,i,l,o;const s=!!(0,d.$S)(e,"requestNumber");return{...e,...!0===(null===e||void 0===e||null===(r=e.stock_ledgers[0])||void 0===r?void 0:r.isCancelled)?{status:"Cancelled"}:!0===(null===e||void 0===e||null===(a=e.stock_ledgers[0])||void 0===a?void 0:a.isProcessed)?{status:"Processed"}:{status:null},isMinBased:s,supplierName:s?"":`${null===e||void 0===e||null===(i=e.toOrganization)||void 0===i?void 0:i.name}-${null===e||void 0===e||null===(l=e.toOrganization)||void 0===l?void 0:l.code}`,serialNumber:($*z-z+t+1).toString(),files:(null===e||void 0===e||null===(o=e.attachments)||void 0===o?void 0:o.length)&&(0,x.jsx)(h.default,{view:!0,fileFields:A,tasks:[],data:{attachments:e.attachments}}),actionButtons:(0,x.jsx)(v.w,{item:e,editButton:!0,openPreview:()=>oe(t),initiatePrint:()=>ne(t),initiateDownload:()=>se(t),updateReceipt:()=>le(e),viewSerialNumbers:()=>{H(t)},noMargins:!0})}})))||[],count:null===K||void 0===K||null===(r=K.stockLedgerDetailListObject)||void 0===r?void 0:r.count,isLoading:null===K||void 0===K?void 0:K.loading,error:null===K||void 0===K?void 0:K.error}}),[$,z,null===K||void 0===K?void 0:K.error,null===K||void 0===K?void 0:K.loading,null===K||void 0===K||null===(e=K.stockLedgerDetailListObject)||void 0===e?void 0:e.count,null===K||void 0===K||null===(t=K.stockLedgerDetailListObject)||void 0===t?void 0:t.rows]),te=(null===X||void 0===X||null===(r=X[F])||void 0===r?void 0:r.materialData)||[],re=null===X||void 0===X||null===(m=X[D])||void 0===m?void 0:m.id,ae=null===X||void 0===X||null===(k=X[D])||void 0===k?void 0:k.referenceDocumentNumber,ie=(0,d.x)(Z,"GRN");(0,i.useEffect)((()=>{y((0,n.VOH)("TRANSACTION TYPE"))}),[y]),(0,i.useEffect)((()=>{ie&&y((0,n.rYL)({pageIndex:$,pageSize:z,transactionTypeId:ie,...J&&{searchString:J,accessors:JSON.stringify(G.current)},sortBy:(null===T||void 0===T?void 0:T[0])||"createdAt",sortOrder:(null===T||void 0===T?void 0:T[1])||"DESC"}))}),[G,y,$,B,z,J,T,ie,Y]);const le=e=>{R(e),N(!0),O(!0)},oe=e=>{M(e),w("view")},se=e=>{M(e),w("download")},ne=e=>{M(e),w("print")};return(0,x.jsxs)(x.Fragment,{children:["closed"!==S&&(0,x.jsx)(j,{fetchFromRoute:"/grn-receipt",apiParams:re,previewAction:S,onClose:()=>{M(null),w("hidden")},fileNameForDownload:ae}),C&&(0,x.jsx)(a.A,{open:L,onClose:()=>O(!1),scroll:"paper",maxWidth:"xs",disableEscapeKeyDown:!0,children:(0,x.jsx)(p.W,{rowData:P,setOpen:O,refreshPagination:U,title:"GRN"})}),null!==F&&(0,x.jsx)(g.A,{selectedMaterialList:te,onClose:()=>{H(null)}}),(0,x.jsx)(c.default,{title:"GRN Receipt",setPageIndex:I,setPageSize:W,pageIndex:$,pageSize:z,columns:b,data:ie?X:[],count:ie?ee:0,hideAddButton:!0,hideActions:!0,searchConfig:{searchString:q,searchStringTrimmed:J,setSearchString:V,setAccessors:_},sortConfig:{sort:T,setSort:E},exportConfig:{tableName:"grn_receipt",apiQuery:{transactionTypeId:ie}}})]})}},43858:(e,t,r)=>{r.d(t,{A:()=>n});var a=r(89379),i=r(9950);const l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z"}}]},name:"paper-clip",theme:"outlined"};var o=r(14840),s=function(e,t){return i.createElement(o.A,(0,a.A)((0,a.A)({},e),{},{ref:t,icon:l}))};const n=i.forwardRef(s)},72179:(e,t,r)=>{var a=r(24994);t.A=void 0;var i=a(r(79526)),l=r(44414);t.A=(0,i.default)((0,l.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"}),"CancelOutlined")},10158:(e,t,r)=>{var a=r(24994);t.A=void 0;var i=a(r(79526)),l=r(44414);t.A=(0,i.default)((0,l.jsx)("path",{d:"M16 9v10H8V9zm-1.5-6h-5l-1 1H5v2h14V4h-3.5zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2z"}),"DeleteOutlined")},2871:(e,t,r)=>{var a=r(24994);t.A=void 0;var i=a(r(79526)),l=r(44414);t.A=(0,i.default)((0,l.jsx)("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8"}),"UndoOutlined")}}]);