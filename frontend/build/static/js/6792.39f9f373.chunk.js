"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[6792],{91052:(e,t,r)=>{r.d(t,{A:()=>m});var a=r(9950),i=r(27081),l=r(59254),n=r(87233),o=r(94908),s=r(29024),d=r(52867),u=r(44414);const c=(0,l.Ay)("div")((()=>({height:"100px",overflowY:"auto",border:"1px solid #d9d9d9",borderRadius:"4px"}))),m=e=>{let{data:t}=e;const r=(0,i.wA)();(0,a.useEffect)((()=>{var e,a,i,l;t&&t.length>0&&(r((0,s.DYA)({transactionTypeId:null===(e=t[0])||void 0===e?void 0:e.transactionTypeId,requestNumber:null===(a=t[0])||void 0===a?void 0:a.referenceDocumentNumber,storeId:(0,d.rd)(t[0])})),r((0,s.DUm)({projectId:null===(i=t[0])||void 0===i?void 0:i.projectId,transactionTypeId:null===(l=t[0])||void 0===l?void 0:l.transactionTypeId,storeId:(0,d.j5)(t[0]),all:!0,sortBy:"rank",sortOrder:"ASC"})))}),[r,t]);const{approvers:{approversObject:{rows:l}},reqApproversList:{approversListObject:{rows:m}}}=(0,o.O)();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(n.A,{sx:{mb:1},children:"Approver remarks"}),(0,u.jsx)(c,{children:l&&l.length>0&&(e=>{if(null===m||void 0===m||!m.length)return[];const t={};m&&m.length>0&&m.map((e=>{t[e.approverId]||(t[e.approverId]={status:e.status,approvedMaterials:e.approvedMaterials,createdAt:(0,d.VU)(e.createdAt,"24hour"),remarks:e.remarks})}));return e&&e.map((e=>{const r={...e};return t[e.id]&&t[e.id].status&&("1"===t[e.id].status||"0"===t[e.id].status)&&(r.aprStatus=t[e.id].status,r.approvedMaterials=t[e.id].approvedMaterials,r.approvedCreationDate=t[e.id].createdAt,r.remarks=t[e.id].remarks),r}))})(l).map((e=>{var t,r;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(n.A,{variant:"h5",sx:{ml:1,mt:1},children:[null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.name,"\xa0\xa0\xa0",null===e||void 0===e?void 0:e.approvedCreationDate]},e),(0,u.jsx)(n.A,{gutterBottom:!0,variant:"body1",sx:{ml:3},children:null===e||void 0===e?void 0:e.remarks},null===e||void 0===e||null===(r=e.user)||void 0===r?void 0:r.name)]})}))})]})}},14563:(e,t,r)=>{r.r(t),r.d(t,{default:()=>A});var a=r(57560),i=r(4139),l=r(87233),n=r(64661),o=r(14341),s=r(67535),d=r(9950),u=r(86898),c=r(9912),m=r(25411),v=r(61977),p=r(87125),x=r(44414);const h=(0,d.memo)((e=>{let{index:t,style:r,data:a}=e;const{segments:i,handleOnChange:l,onPaste:n}=a,s=i[t],[u,c]=(0,d.useState)("");(0,d.useEffect)((()=>{c(s)}),[s]);return(0,x.jsxs)(p.tf,{index:t,style:r,children:[(0,x.jsx)(p.VW,{width:"20%",children:t+1}),(0,x.jsx)(p.VW,{width:"80%",children:(0,x.jsx)(o.A,{type:"text",value:u,onChange:e=>{let{value:r}=e.target;r=r.replace(/[^\w]/gi,"").toUpperCase(),c(r),l(r,t)},onPaste:e=>{e.preventDefault();const r=e.clipboardData.getData("Text");if(r.includes("\n"))n(e,t);else{let a=e.target.value+r;a=a.replace(/[^\w]/gi,"").toUpperCase(),c(a),l(a,t)}}})})]},t)}));var y=r(22759),f=r(14351);const j="ENTER_SERIAL_NUMBERS",g="GENERATE_SERIAL_NUMBERS",A=e=>{let{handleCloseSerial:t,closeCss:r,quantity:A,serialNumbers:b,setSerialNumbers:S,hideAuto:N=!1}=e;const[I,C]=(0,d.useState)(j),[F,_]=(0,d.useState)(""),[w,k]=(0,d.useState)(""),[O,D]=(0,d.useState)(""),[E,M]=(0,d.useState)(!1),[L,R]=(0,d.useState)([]),[T,z]=(0,d.useState)([]),Q=(e,t)=>{const r=L;r[t]=e,R(r)},V=(e,t)=>{const r=e.clipboardData.getData("text/plain"),a=L.slice();for(let l=0,n=r.split("\n");l<A&&l<n.length&&l+t<L.length;l++){var i;let e=null===(i=n[l])||void 0===i?void 0:i.replace(/[^\w]/gi,"").toUpperCase().trim();a[l+t]=e}R(a)},q=(e,t,r)=>{if(r){const a=parseInt(r)+parseInt(A),i=Array(a-r).fill().map(((a,i)=>`${e}${i+parseInt(r)}${t}`));z(i)}};return(0,d.useEffect)((()=>{null!==b&&void 0!==b&&b.length?R(b):R(Array(parseInt(A)).fill(""))}),[A,b]),(0,x.jsxs)(f.A,{sx:{width:520},modal:!0,darkTitle:!0,content:!1,children:[(0,x.jsx)(i.Ay,{container:!0,spacing:2,alignItems:"center",sx:{mt:-1},children:(0,x.jsx)(i.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",marginRight:1},children:(0,x.jsx)(a.A,{onClick:t,style:r})})}),(0,x.jsxs)(i.Ay,{container:!0,spacing:2,alignItems:"center",sx:{mt:0},children:[(0,x.jsxs)(i.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"center",padding:"0px"},children:[(0,x.jsxs)(u.A,{children:[I===j&&(0,x.jsx)(u.A,{position:"absolute",marginLeft:"-61px",children:(0,x.jsx)(v.A,{segments:L,setSegments:R})}),(0,x.jsx)(l.A,{color:I===j?"#FFFFFF":"#111111",onClick:()=>{C(j)},style:{cursor:"pointer",fontWeight:700,padding:10,background:I===j?"#1677FF":"#FFFFFF"},children:"Multiple Serial Number"})]}),!N&&(0,x.jsx)(l.A,{color:I===g?"#FFFFFF":"#111111",onClick:()=>{C(g)},style:{cursor:"pointer",fontWeight:700,padding:10,background:I===g?"#1677FF":"#FFFFFF"},children:"With Serial Number"})]}),I===j&&(0,x.jsx)(i.Ay,{item:!0,xs:12,m:5,mt:1,style:{height:400,display:"flex",flexDirection:"column"},children:(0,x.jsxs)(n.A,{style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,x.jsxs)(u.A,{display:"flex",children:[(0,x.jsx)(p.A3,{width:"20%",children:"S.No."}),(0,x.jsx)(p.A3,{width:"80%",children:"Serial Number"})]}),(0,x.jsx)(u.A,{style:{flex:1,display:"flex"},children:(0,x.jsx)(m.Ay,{children:e=>{let{height:t,width:r}=e;return(0,x.jsx)(c.Y1,{height:t,width:r,itemCount:L.length,itemSize:60,itemData:{segments:L,handleOnChange:Q,onPaste:V},overscanCount:5,children:h})}})})]})}),I===g&&!N&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(i.Ay,{container:!0,xs:12,m:1,ml:6,mr:6,children:[(0,x.jsx)(i.Ay,{item:!0,xs:2,m:1,children:"Prefix"}),(0,x.jsx)(i.Ay,{item:!0,xs:3,mr:3,children:(0,x.jsx)(o.A,{name:"prefix",value:F,onChange:e=>{if(e.target.value){let t=e.target.value;t=t.replace(/[^\w]/gi,"").toUpperCase(),_(t),q(t,w,O)}else _(""),q("",w,O)}})}),(0,x.jsx)(i.Ay,{item:!0,xs:2,m:1,children:"Suffix"}),(0,x.jsx)(i.Ay,{item:!0,xs:3,children:(0,x.jsx)(o.A,{name:"suffix",value:w,onChange:e=>{if(e.target.value){let t=e.target.value;t=t.replace(/[^\w]/gi,"").toUpperCase(),k(t),q(F,t,O)}else k(""),q(F,"",O)}})})]}),(0,x.jsxs)(i.Ay,{container:!0,xs:12,ml:6,mr:7,pr:.5,children:[(0,x.jsx)(i.Ay,{item:!0,xs:3,p:1,children:"Range From"}),(0,x.jsx)(i.Ay,{item:!0,xs:9,mb:1,children:(0,x.jsx)(o.A,{fullWidth:!0,type:"text",name:"rangeFrom",value:O,onChange:e=>{(""===e.target.value||/^[0-9\b]+$/.test(e.target.value))&&(D(e.target.value),q(F,w,e.target.value),""===e.target.value&&z([]))}})}),(0,x.jsx)(i.Ay,{item:!0,xs:3,p:1,children:"Range To"}),(0,x.jsx)(i.Ay,{item:!0,xs:9,children:(0,x.jsx)(o.A,{fullWidth:!0,name:"rangeTo",type:"number",value:parseInt(O)+parseInt(A)-1,disabled:!0})})]}),(0,x.jsx)(i.Ay,{item:!0,xs:12,mx:5,mt:1,mb:2,style:{height:300,display:"flex",flexDirection:"column"},children:(0,x.jsxs)(n.A,{style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,x.jsxs)(u.A,{display:"flex",style:{height:45},children:[(0,x.jsx)(p.A3,{width:"20%",children:"S.No."}),(0,x.jsx)(p.A3,{width:"80%",children:"Serial Number"})]}),(0,x.jsx)(u.A,{style:{flex:1,display:"flex"},children:(0,x.jsx)(m.Ay,{children:e=>{let{height:t,width:r}=e;return(0,x.jsx)(c.Y1,{height:t,width:r,itemCount:T.length,itemSize:45,itemData:{originalData:T},overscanCount:5,children:y.Ay})}})})]})})]})]}),E&&(0,x.jsx)(l.A,{m:5,mt:-4,color:"red",children:"Enter valid serial numbers"}),(0,x.jsx)(i.Ay,{item:!0,xs:12,mb:2,sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,x.jsx)(s.A,{size:"small",onClick:()=>{let e=[];e=I===g?T:L.filter((e=>""!==e));const r=e.length!==parseInt(A);M(r),r||(S(e),t(!0))},variant:"contained",color:"primary",children:"Save"})})]})}},94908:(e,t,r)=>{r.d(t,{O:()=>l});var a=r(9950),i=r(27081);const l=()=>{const[e,t]=(0,a.useState)({approversObject:{},error:"",loading:!0}),[r,l]=(0,a.useState)({approversListObject:[],error:"",loading:!0}),[n,o]=(0,a.useState)({approversListObject:[],error:"",loading:!0}),s=(0,i.d4)((e=>e.approvers||[])),d=(0,i.d4)((e=>e.getAllApproversList||[])),u=(0,i.d4)((e=>e.getAllApproversData||[]));return(0,a.useEffect)((()=>{t((e=>({...e,...s})))}),[s]),(0,a.useEffect)((()=>{l((e=>({...e,...d})))}),[d]),(0,a.useEffect)((()=>{o((e=>({...e,...u})))}),[u]),{approvers:e,approversList:r,reqApproversList:n}}},66792:(e,t,r)=>{r.r(t),r.d(t,{default:()=>q});var a=r(9950),i=r(27081),l=r(36089),n=r(53065),o=r(57073),s=r(12257),d=r(4139),u=r(74745),c=r(67535),m=r(60666),v=r(9449),p=r(26473),x=r(28429),h=r(62375),y=r(29024),f=r(80415),j=r(88848),g=r(62605),A=r(12952),b=r(87233),S=r(65669),N=r(14563),I=r(96951),C=r(84601),F=r(14351),_=r(95615),w=r(52867),k=r(44414);const O={cursor:"pointer",fontSize:24},D=e=>{var t;let{onMaterailsInput:r,view:l,update:n,showData:o,toStoreLocationData:s,maxQuantity:u}=e;const[x,h]=(0,a.useState)(!1),[f,j]=(0,a.useState)(""),[g,A]=(0,a.useState)(o&&o.approvedQuantity?null===o||void 0===o?void 0:o.approvedQuantity:null),[D,E]=(0,a.useState)(o&&o.rate?null===o||void 0===o?void 0:o.rate:null),[M,L]=(0,a.useState)([]),[R,T]=(0,a.useState)([]),[z,Q]=(0,a.useState)(!1),[V,q]=(0,a.useState)(!1),[P,W]=(0,a.useState)(!1),U=(0,i.wA)();(0,a.useEffect)((()=>{U((0,y._G1)())}),[U]),(0,a.useEffect)((()=>{h(!!l)}),[l,n]);const B=(0,v.mN)({resolver:(0,p.t)(m.Ik().shape({approvedQuantity:P?C.A.checkForInteger("Quantity",u):C.A.maxQuantity(u)})),defaultValues:{},mode:"all"}),{handleSubmit:$,setValue:H,reset:Y,watch:G}=B,J=G("uom");(0,a.useEffect)((()=>{var e,t,r,a;(l||n)&&o&&(a=o,Object.entries(a).forEach((e=>{let[t,r]=e;"actions"!==t&&H(t,r),"uom"===t&&H(t,r.name)})),T(o.material_serial_numbers?o.material_serial_numbers:[]),H("fromStoreLocationName",null===o||void 0===o||null===(e=o.from_store_location)||void 0===e?void 0:e.name),H("rate",null===(t=parseFloat(null===o||void 0===o?void 0:o.rate))||void 0===t?void 0:t.toFixed(3)),H("value",null===(r=parseFloat(null===o||void 0===o?void 0:o.value))||void 0===r?void 0:r.toFixed(3)))}),[l,n,o,Y,H,U]);const X=function(e,t,r,a,i){let l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],n=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return(0,k.jsx)(I.o3,{name:e,type:r,label:t,..."function"===typeof i&&{handleChange:i},InputLabelProps:{shrink:n},...(l||x)&&{disabled:!0},...a&&{required:!0}})},Z=e=>{T(e)},K=()=>{Q(!1)};return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(F.A,{sx:{mb:2,pb:4},children:(0,k.jsxs)(I.Op,{methods:B,children:[(0,k.jsxs)(d.Ay,{container:!0,spacing:2,sx:{mt:2},children:[(0,k.jsx)(d.Ay,{item:!0,md:4,children:X("material.code","Code","text",!0,void 0,!0)}),(0,k.jsx)(d.Ay,{item:!0,md:4,children:X("material.name","Materials","text",!0,void 0,!0)}),(0,k.jsx)(d.Ay,{item:!0,md:4,children:X("fromStoreLocationName","From Store Location","text",!0,void 0,!0)}),(0,k.jsx)(d.Ay,{item:!0,md:2,children:X("approvedQuantity","Quantity",(0,w.VF)(J)?"text":"number",!0,(e=>{var t,r;(0,w.VF)(J)?W(!1):W(!0),A(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value),H("value",(null===e||void 0===e||null===(r=e.target)||void 0===r?void 0:r.value)*D)}))}),(0,k.jsx)(d.Ay,{item:!0,md:2,children:X("uom","UOM","text",!0,void 0,!0)}),(0,k.jsx)(d.Ay,{item:!0,md:2,style:{display:"none"},children:X("uomId","UOMId","text",!0)}),(0,k.jsx)(d.Ay,{item:!0,md:2,style:{display:"none"},children:X("rate","Rate","text",!0,(e=>{var t;E(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)}),!0)}),(0,k.jsx)(d.Ay,{item:!0,md:2,style:{display:"none"},children:X("value","Value","text",!0,void 0,!0)}),(0,k.jsxs)(d.Ay,{item:!0,md:1,sx:{textAlign:"center"},children:[(null===o||void 0===o||null===(t=o.material)||void 0===t?void 0:t.isSerialNumber)&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(b.A,{mb:-1,children:"Serial No"})," ",(0,k.jsx)("br",{}),(0,k.jsx)(c.A,{size:"small",onClick:()=>{L(JSON.parse(null===o||void 0===o?void 0:o.serialNumbers)),q(!0)},variant:"contained",color:"primary",children:"View"})]}),f&&""!==f&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("br",{}),(0,k.jsx)(b.A,{color:"error",sx:{fontSize:12,marginTop:2},children:f})]})]}),(0,k.jsx)(d.Ay,{item:!0,xs:12,mt:3.5,sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:!l&&(0,k.jsx)(c.A,{size:"small",onClick:$((e=>{var t,a,i;e&&null!==e&&void 0!==e&&e.material&&null!==e&&void 0!==e&&null!==(t=e.material)&&void 0!==t&&t.isSerialNumber&&0===R.length?j("Serial Number is required"):e&&null!==e&&void 0!==e&&e.material&&null!==e&&void 0!==e&&null!==(a=e.material)&&void 0!==a&&a.isSerialNumber&&R.length!==e.approvedQuantity?j(`Please select a total of ${e.approvedQuantity} serial numbers`):(e.toLocation=(i=e.toStoreLocationId,s.filter((e=>e.id===i))[0]),e.approvedQuantity=e.approvedQuantity>0?e.approvedQuantity:"0",e.material_serial_numbers=R,r(e,o.id),j(""),Y())})),variant:"contained",color:"primary",children:n?"Update":"Add"})})]}),(0,k.jsx)(S.A,{open:z,onClose:K,"aria-labelledby":"modal-modal-title",children:(0,k.jsx)(N.default,{handleCloseSerial:K,closeCss:O,quantity:g,setSerialNumbers:Z})}),V&&(0,k.jsx)(_.default,{open:V,onClose:()=>{q(!1)},maxQuantity:g,serialNumberData:M,showCheckboxes:!0,onSave:e=>{Z(e)},selectedSerials:R})]})})})};var E=r(99635),M=r(62054),L=r(71826),R=r(62472),T=r(52351),z=r(91052);const Q=e=>{var t;let{values:r,onEdit:a,index:i,onView:s}=e;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(n.A,{title:"Edit",placement:"bottom",children:(0,k.jsx)(o.A,{color:"secondary",onClick:()=>a(r,i),children:(0,k.jsx)(l.A,{})})}),(null===r||void 0===r||null===(t=r.material)||void 0===t?void 0:t.isSerialNumber)&&(0,k.jsx)(n.A,{title:"View Serial Number",placement:"bottom",children:(0,k.jsx)(o.A,{color:"secondary",onClick:()=>s(r),children:(0,k.jsx)(h.A,{})})})]})},V=[{Header:"Actions",accessor:"actions"},{Header:"Name",accessor:"material.name"},{Header:"Code",accessor:"material.code"},{Header:"Quantity",accessor:"approvedQuantity"},{Header:"UOM",accessor:"uom.name"},{Header:"From Store Location",accessor:"fromStoreLocationName"}],q=()=>{const[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)([]),[n,o]=(0,a.useState)(null),[h,b]=(0,a.useState)(!1),[S,N]=(0,a.useState)(!1),[O,q]=(0,a.useState)(!1),[P,W]=(0,a.useState)(f.j7.pageIndex),[U,B]=(0,a.useState)(f.j7.pageSize),[$,H]=(0,a.useState)(!1),[Y,G]=(0,a.useState)([]),[J,X]=(0,a.useState)(),[Z,K]=(0,a.useState)(!1),[ee,te]=(0,a.useState)(),[re,ae]=(0,a.useState)(null),[ie,le]=(0,a.useState)(!1),[ne,oe]=(0,a.useState)(null),se=(0,x.Zp)(),de=(0,v.mN)({resolver:(0,p.t)(m.Ik().shape({projectId:C.A.project,vehicleNumber:C.A.vehicleNumberOptional,...!(0,w.g6)(ee)&&{eWayBillDate:C.A.requiredWithLabel("E-Way Bill Date")}})),defaultValues:{},mode:"all"}),{handleSubmit:ue,setValue:ce,watch:me}=de,ve=(0,i.wA)(),{txnByMaterial:pe,serialNumbers:xe}=(0,g.t)(),{serialNumbersData:he}=(0,a.useMemo)((()=>{var e;return{serialNumbersData:(null===xe||void 0===xe?void 0:xe.data)||{},countSN:(null===xe||void 0===xe||null===(e=xe.data)||void 0===e?void 0:e.count)||0}}),[xe]),ye=(0,a.useMemo)((()=>(null===pe||void 0===pe?void 0:pe.stocksObject)||[]),[pe]);(0,a.useEffect)((()=>{var e,r,a,i;if(!J)return;const n=structuredClone(J);n&&n.map((e=>e.value=e.approvedQuantity*e.rate)),n&&n.map((e=>{var t;return e.fromStoreLocationName=null===(t=e.from_store_location)||void 0===t?void 0:t.name})),t(n),l(n),ve((0,y.J9T)({project:null===(e=n[0])||void 0===e?void 0:e.projectId,store:null===(r=n[0])||void 0===r?void 0:r.fromStoreId})),ve((0,y.VzI)({project:null===(a=n[0])||void 0===a?void 0:a.projectId,store:null===(i=n[0])||void 0===i?void 0:i.fromStoreId}))}),[ve,J]);const fe=J&&J[0];(0,a.useEffect)((()=>{var e,t;J&&fe&&(t=fe,Object.entries(t).forEach((e=>{let[t,r]=e;ce(t,"remarks"===t?"":r)})),ce("supervisorName",null===fe||void 0===fe||null===(e=fe.contractor_employee)||void 0===e?void 0:e.name))}),[J,fe,ce]);const{companyStoreLocations:je}=(0,A.V)(),{toStoreLocationData:ge}=(0,a.useMemo)((()=>{var e;return{toStoreLocationData:(null===je||void 0===je||null===(e=je.companyStoreLocationsObject)||void 0===e?void 0:e.rows)||[]||0,isLoading:je.loading||!1}}),[je]);(0,a.useEffect)((()=>{const t=ge&&ge.filter((t=>{var r;return t.organizationStoreId===(null===(r=e[0])||void 0===r?void 0:r.toStoreId)}));var r;G(t),e&&(r=e,Object.entries(r).forEach((e=>{let[t,r]=e;ce(t,r)})))}),[e,ge,ce]);const{masterMakerLovs:Ae}=(0,j.$)(),be=Ae.masterMakerLovsObject.rows,Se=me("eWayBillNumber");(0,a.useEffect)((()=>{te(Se)}),[Se]);const Ne=(e,t)=>{b(!1),N(!0);const a={...e,material_serial_numbers:null===e||void 0===e?void 0:e.material_serial_numbers};H(a),o(r[t].approvedQuantity)},Ie=e=>{oe(e),le(!0),null!==e&&void 0!==e&&e.material_serial_numbers||ae([])};(0,a.useEffect)((()=>{null!==ne&&void 0!==ne&&ne.material_serial_numbers&&ae(null===ne||void 0===ne?void 0:ne.material_serial_numbers)}),[ne]);const Ce=(0,w.x)(be,"MRN"),Fe=e=>{const t=[];return e&&e.length>0&&e.map((e=>t.push(e.id))),t},_e=function(e,t,r,a,i,l){let n=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return(0,k.jsx)(s.A,{spacing:1,children:(0,k.jsx)(I.o3,{name:e,type:r,label:t,InputLabelProps:{shrink:n},disabled:i,..."function"===typeof l&&{handleChange:l},...a&&{required:!0},...h?{disable:!0}:S?{disable:!1}:{}})})},we=(0,w.x)(be,"CONTRACTOR"),ke=(0,w.x)(be,"COMPANY");return(0,a.useEffect)((()=>{we&&ve((0,y.qV$)({organizationType:we}))}),[ve,we]),(0,a.useEffect)((()=>{ke&&ve((0,y.Ru7)({organizationType:ke}))}),[ve,ke]),(0,a.useEffect)((()=>{ve((0,y._G1)()),ve((0,y.uiG)())}),[ve]),(0,k.jsxs)(k.Fragment,{children:[Z&&(0,k.jsx)(T.A,{}),(0,k.jsx)(I.Op,{methods:de,onSubmit:ue((async t=>{var r,a,i,l;K(!0);const n=(t=>{var r,a,i,l,n,o,s,d,u,c,m,v;const p=[];return e.map((e=>({...e}))).map((e=>{if(parseFloat(e.approvedQuantity)>0){var t,r,a,i,l,n,o,s;const d=null===ye||void 0===ye?void 0:ye.find((t=>t.materialId===e.materialId)),u=null===d||void 0===d?void 0:d.rate,c=null===d||void 0===d?void 0:d.tax,m=parseFloat(e.approvedQuantity)*u;p.push({transactionTypeId:Ce,projectId:null===e||void 0===e?void 0:e.projectId,requestNumber:null===e||void 0===e?void 0:e.referenceDocumentNumber,organizationId:null!==e&&void 0!==e&&null!==(t=e.to_store)&&void 0!==t&&null!==(r=t.organization)&&void 0!==r&&r.parentId?null===e||void 0===e||null===(a=e.to_store)||void 0===a||null===(i=a.organization)||void 0===i?void 0:i.parentId:null===e||void 0===e||null===(l=e.to_store)||void 0===l||null===(n=l.organization)||void 0===n?void 0:n.id,storeId:null===e||void 0===e||null===(o=e.to_store)||void 0===o?void 0:o.id,fromStoreLocationId:null===e||void 0===e||null===(s=e.from_store_location)||void 0===s?void 0:s.id,materialId:null===e||void 0===e?void 0:e.materialId,uomId:null===e||void 0===e?void 0:e.uomId,quantity:parseFloat(null===e||void 0===e?void 0:e.approvedQuantity),rate:u,value:m,tax:c,serialNumber:null===e||void 0===e?void 0:e.material_serial_numbers})}})),{transactionTypeId:Ce,requestIds:Fe(e),requestNumber:null===(r=e[0])||void 0===r?void 0:r.referenceDocumentNumber,fromOrganizationId:null!==(a=e[0])&&void 0!==a&&null!==(i=a.from_store)&&void 0!==i&&null!==(l=i.organization)&&void 0!==l&&l.parentId?null===(n=e[0])||void 0===n||null===(o=n.from_store)||void 0===o||null===(s=o.organization)||void 0===s?void 0:s.parentId:null===(d=e[0])||void 0===d||null===(u=d.from_store)||void 0===u||null===(c=u.organization)||void 0===c?void 0:c.id,fromStoreId:null===(m=e[0])||void 0===m||null===(v=m.from_store)||void 0===v?void 0:v.id,vehicleNumber:t.vehicleNumber,eWayBillNumber:t.eWayBillNumber,eWayBillDate:t.eWayBillDate,remarks:t.remarks,...t.placeOfSupply&&{placeOfSupply:t.placeOfSupply},stock_ledgers:p}})(t);if(!n.stock_ledgers||0===n.stock_ledgers.length)return(0,M.A)("Enter atleast 1 material with some quantity!",{variant:"error"}),void K(!1);let o=[],s=!1;if(e&&e.length>0&&e.map((e=>{!e.material.isSerialNumber||e.material_serial_numbers&&e.material_serial_numbers.length===e.approvedQuantity||(o.push(e.material.name+"-"+e.material.code),s=!0)})),o&&o.length>0&&s)return(0,M.A)(`Please add serial numbers for following materials : ${o.toString()}`,{variant:"error"}),void K(!1);const d=await(0,L.default)("/mrn-transaction-create",{method:"POST",body:n,timeoutOverride:12e4});var u;if(!d.success)return(0,M.A)((null===d||void 0===d||null===(u=d.error)||void 0===u?void 0:u.message)||"Operation failed. Please try again!",{variant:"error"}),void K(!1);const c=null!==(r=null===(a=d.data)||void 0===a?void 0:a.data)&&void 0!==r?r:{},m=c.referenceDocumentNumber||(null===(i=c[0])||void 0===i?void 0:i.referenceDocumentNumber),v=null===d||void 0===d||null===(l=d.data)||void 0===l?void 0:l.referenceDocNo;(0,M.A)(m?`Transaction created with reference number: ${m}`:v&&`Transaction created with reference numbers ${v.MRN} and ${v.RETURNMRN}`||"Transaction created successfully!",{variant:"success",autoHideDuration:1e4}),K(!1),se("/mrn-receipt")})),children:(0,k.jsxs)(F.A,{title:"MRN (Material Return Note)",sx:{mb:2},children:[(0,k.jsx)(R.A,{fromStoreLabel:"Contractor Store",type:"request",fromStoreType:"CONTRACTOR",approvedOnly:!0,transactionType:"MRR",disableAll:!(null===J||void 0===J||!J.length),setReqData:X}),e&&e.length>0&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(d.Ay,{container:!0,sx:{mt:3,mb:3},children:(0,k.jsx)(d.Ay,{item:!0,md:12,xl:12,children:(0,k.jsx)(u.A,{})})}),(0,k.jsxs)(d.Ay,{container:!0,spacing:4,alignItems:"center",sx:{mb:2},children:[(0,k.jsx)(d.Ay,{item:!0,md:3,xl:2,children:_e("to_store.name","Company Store","text",!0,!0)}),(0,k.jsx)(d.Ay,{item:!0,md:3,xl:2,children:_e("placeOfSupply","Place Of Supply","text",!1,!1)}),(0,k.jsx)(d.Ay,{item:!0,md:3,xl:2,children:_e("vehicleNumber","Vehicle Number","text",!1)}),(0,k.jsx)(d.Ay,{item:!0,md:3,xl:2,children:_e("supervisorName","Supervisor Name","text",!0,!0)}),(0,k.jsx)(d.Ay,{item:!0,md:3,xl:2,children:_e("remarks","Remarks","text",!1)}),(0,k.jsx)(d.Ay,{item:!0,md:3,xl:4,children:(0,k.jsx)(z.A,{data:e})})]})]}),e&&e.length>0&&(0,k.jsxs)(k.Fragment,{children:[(h||S)&&(0,k.jsx)(D,{toStoreLocationData:Y,onMaterailsInput:r=>{const a=[];e.map((e=>{if(r.id===e.id){let t=e.uom;(e=r).uom=t}a.push(e)})),N(!1),t(a)},maxQuantity:n,view:h,update:S,showData:$}),(0,k.jsx)(E.default,{title:"MRN",hideHeader:!0,hidePagination:!0,data:(Oe=e,Oe.map((e=>{const t=JSON.parse(e.serialNumbers).filter((t=>{var r;return(null===e||void 0===e?void 0:e.materialId)&&he[null===e||void 0===e?void 0:e.materialId]&&(null===(r=he[null===e||void 0===e?void 0:e.materialId])||void 0===r?void 0:r.includes(t))}));return{...e,serialNumbers:JSON.stringify(t)}})).map(((e,t)=>({...e,actions:(0,k.jsx)(Q,{values:e,index:t,onEdit:Ne,onView:Ie})})))),count:e.length,columns:V,hideActions:!0,setPageIndex:W,setPageSize:B,pageIndex:P,pageSize:U}),ie&&ne&&re&&(0,k.jsx)(_.default,{open:ie,onClose:()=>{le(!1)},serialNumberData:re}),(0,k.jsx)(d.Ay,{item:!0,md:12,xl:2,sx:{mt:4},children:(0,k.jsxs)(d.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px"},children:[(0,k.jsx)(c.A,{onClick:()=>{q(!O),b(!1),N(!1),t([]),X(null)},size:"small",variant:"outlined",color:"primary",children:"Back"}),(0,k.jsx)(c.A,{disabled:S||Z,size:"small",type:"submit",variant:"contained",color:"primary",children:"Submit"})]})})]})]})})]});var Oe}},62375:(e,t,r)=>{var a=r(24994);t.A=void 0;var i=a(r(79526)),l=r(44414);t.A=(0,i.default)((0,l.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")},64661:(e,t,r)=>{r.d(t,{A:()=>p});var a=r(58168),i=r(98587),l=r(9950),n=r(72004),o=r(88465),s=r(18463),d=r(59254),u=r(86957),c=r(44414);const m=["className","component"],v=(0,d.Ay)("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,t)=>t.root})({width:"100%",overflowX:"auto"}),p=l.forwardRef((function(e,t){const r=(0,s.b)({props:e,name:"MuiTableContainer"}),{className:l,component:d="div"}=r,p=(0,i.A)(r,m),x=(0,a.A)({},r,{component:d}),h=(e=>{const{classes:t}=e;return(0,o.A)({root:["root"]},u.I,t)})(x);return(0,c.jsx)(v,(0,a.A)({ref:t,as:d,className:(0,n.A)(h.root,l),ownerState:x},p))}))},86957:(e,t,r)=>{r.d(t,{A:()=>n,I:()=>l});var a=r(1763),i=r(423);function l(e){return(0,i.Ay)("MuiTableContainer",e)}const n=(0,a.A)("MuiTableContainer",["root"])}}]);