"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[1737],{64499:(e,l,t)=>{t.d(l,{A:()=>f});var i=t(9950),o=t(65669),n=t(43263),a=t(57191),r=t(95537),d=t(67535),u=t(87233),s=t(44414);f.defaultProps={title:"Confirm Action",message:"Are you sure to perform this action",closeBtnTitle:"Cancel",confirmBtnTitle:"Ok"};const c={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:350,bgcolor:"background.paper",borderRadius:"10px",p:3},p={display:"flex",flexDirection:"row",padding:"15px 0"},v={display:"flex",justifyContent:"flex-end",gap:2},m={marginTop:2,display:"flex",fontSize:"14px"};function f(e){let{open:l,handleClose:t,title:f,message:h,closeBtnTitle:y,confirmBtnTitle:g,handleConfirm:b,confirmColor:x}=e;const[j,A]=(0,i.useState)(null);return(0,i.useEffect)((()=>{A(null)}),[l]),(0,s.jsx)("div",{children:(0,s.jsx)(o.A,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:l,closeAfterTransition:!0,slots:{backdrop:n.A},slotProps:{backdrop:{timeout:500}},children:(0,s.jsx)(a.A,{in:l,children:(0,s.jsxs)(r.A,{sx:c,children:[(0,s.jsx)(u.A,{id:"transition-modal-title",variant:"h4",children:f}),(0,s.jsx)(u.A,{id:"transition-modal-title",variant:"h6",sx:p,children:h}),(0,s.jsxs)(r.A,{sx:v,children:[!!t&&(0,s.jsx)(d.A,{onClick:t,size:"small",variant:"outlined",color:"primary",children:y}),!!b&&(0,s.jsx)(d.A,{onClick:b,size:"small",variant:"contained",color:x||"error",children:g})]}),j&&(0,s.jsx)(u.A,{variant:"p",color:"red",sx:m,children:j})]})})})})}},15999:(e,l,t)=>{t.d(l,{A:()=>g});var i=t(9950),o=t(80678),n=t(41787),a=t(81831),r=t(72145),d=t(12257),u=t(87233),s=t(14341),c=t(94641),p=t(9449),v=t(43974),m=t(30545),f=t(19673),h=t(22580),y=t(44414);const g=e=>{let{name:l,label:t,onChange:g,disabled:b,required:x=!1,...j}=e;const{control:A}=(0,p.xW)(),{errorMessage:_,timeFormat:N,pickerType:w,minDate:C,maxDate:D,setInsideErrors:O}=j,T=e=>(0,v.A)(new Date(e).getTime()-198e5,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),I=(0,i.useCallback)((e=>{let l="";return D&&e>new Date(`${D}T23:59:00Z`)?l=`Maximum date should be ${(0,v.A)(new Date(D),"dd/MM/yyyy")}`:e<new Date(`${C}`)&&(l=`Minimum date should be ${(0,v.A)(new Date(C),"dd/MM/yyyy")}`),l}),[C,D]),S=(0,i.useRef)();return(0,i.useEffect)((()=>{if(S.current)S.current=!1;else{var e,t,i;if(null!==A&&void 0!==A&&null!==(e=A._fields)&&void 0!==e&&null!==(t=e[l])&&void 0!==t&&null!==(i=t._f)&&void 0!==i&&i.value){var o,n,a;let e=I(new Date(null===A||void 0===A||null===(o=A._fields)||void 0===o||null===(n=o[l])||void 0===n||null===(a=n._f)||void 0===a?void 0:a.value));e&&O&&O((t=>({...t,[l]:e})))}S.current=!0}}),[l,A,I,O]),(0,y.jsx)(a.$,{dateAdapter:n.h,children:(0,y.jsx)(p.xI,{name:l,control:A,defaultValue:null,render:e=>{var i;let{field:n,formState:{errors:a}}=e;return(0,y.jsx)(r.A,{fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:a[l]?"#ff4d4f":""}}},children:(0,y.jsxs)(d.A,{spacing:1,children:[(0,y.jsxs)(u.A,{children:[t,x&&!(null!==t&&void 0!==t&&t.includes(" *"))&&" *"]}),"dateTimeBoth"===w?(0,y.jsx)(o.K,{...n,disabled:b,value:n.value?new Date(n.value):null,onChange:e=>{if(e){let t=I(e);O&&O((e=>({...e,[l]:t})))}const t=T(e);g&&"function"===typeof g&&g(t),n.onChange(t)},format:"12hour"===N?"dd/MM/yyyy hh:mm a":"dd/MM/yyyy HH:mm",renderInput:e=>(0,y.jsx)(s.A,{...e}),ampm:"12hour"===N}):"dateOnly"===w?(0,y.jsx)(m.T,{inputFormat:"dd/MM/yyyy",value:n.value?new Date(n.value):null,onChange:e=>{if(e){let t=I(e);O&&O((e=>({...e,[l]:t})))}const t=T(e);g&&"function"===typeof g&&g(t),n.onChange(t)},renderInput:e=>(0,y.jsx)(s.A,{...e})}):"monthYearBoth"===w?(0,y.jsx)(f.l,{inputFormat:"MM-yyyy",views:["month","year"],value:n.value?new Date(n.value):null,onChange:e=>{if(e){let t=I(e);O&&O((e=>({...e,[l]:t})))}const t=T(e);g&&"function"===typeof g&&g(t),n.onChange(t)},renderInput:e=>(0,y.jsx)(s.A,{...e})}):(0,y.jsx)(h.A,{value:n.value?new Date(n.value):null,onChange:e=>{const l=T(e);g&&"function"===typeof g&&g(l),n.onChange(l)},renderInput:e=>(0,y.jsx)(s.A,{...e}),ampm:"12hour"===N}),(0,y.jsx)(c.A,{sx:{position:"absolute",top:60,left:3,color:"#ff4d4f"},children:(null===(i=a[l])||void 0===i?void 0:i.message)||_})]})})}})})}},89649:(e,l,t)=>{t.d(l,{A:()=>n});var i=t(9950),o=t(80415);function n(){const[e,l]=(0,i.useState)({pageIndex:o.j7.pageIndex,pageSize:o.j7.pageSize,forceUpdate:!0}),t=(0,i.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.pageIndex,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.pageSize;l((e=>({pageIndex:t,pageSize:i,forceUpdate:!e.forceUpdate})))}),[e]),n=(0,i.useCallback)((()=>{l((e=>({pageIndex:o.j7.pageIndex,pageSize:o.j7.pageSize,forceUpdate:!e.forceUpdate})))}),[]);return{paginations:e,setPageIndex:e=>l((l=>({...l,pageIndex:e,forceUpdate:!l.forceUpdate}))),setPageSize:e=>l((l=>({pageIndex:o.j7.pageIndex,pageSize:e,forceUpdate:!l.forceUpdate}))),refreshPagination:n,setPaginationsFunctions:t}}},21737:(e,l,t)=>{t.r(l),t.d(l,{default:()=>Z});var i=t(9950),o=t(4139),n=t(57073),a=t(87233),r=t(67535),d=t(2660),u=t(46483),s=t(12257),c=t(96583),p=t(14341),v=t(9449),m=t(28429),f=t(27081),h=t(12563),y=t(62375),g=t(26592),b=t(15999),x=t(50287),j=t(60767),A=t(76300),_=t(71826),N=t(75989),w=t(79843),C=t(40821),D=t(96395),O=t(39854),T=t(14351),I=t(86263),S=t(64499),k=t(44414);const F=e=>{let{imageList:l,blockMode:t=!1,base64Image:n=!1,setValue:r,preview:d,type:u,mode:c,setState:p}=e;const[v,m]=(0,i.useState)();(0,i.useEffect)((()=>{m(0)}),[l]);const[f,h]=(0,i.useState)(!1),[y,b]=(0,i.useState)(null);return(null===l||void 0===l?void 0:l.length)>0?(0,k.jsxs)(o.Ay,{container:!0,children:[(0,k.jsx)(o.Ay,{item:!0,md:12,children:(0,k.jsxs)(T.A,{content:!1,boxShadow:!1,sx:{m:"0 auto",height:"100%",display:"flex",border:"none",alignItems:"center",justifyContent:"center"},children:[(0,k.jsx)(D.GT,{ref:b,children:(0,k.jsx)(D.WZ,{children:(0,k.jsx)(C.A,{component:"img",image:n?"object"===typeof l[v]?URL.createObjectURL(l[v]):l[v]:"object"===typeof l[v]?URL.createObjectURL(l[v]):window.location.origin+l[v],sx:{height:t?"72vh":"90vh",objectFit:"contain"}})})}),(0,k.jsxs)(s.A,{direction:"row",className:"tools",sx:{position:"absolute",bottom:5,zIndex:1,backgroundColor:"white"},children:[l.length>1&&(0,k.jsx)(I.A,{title:"Prev",color:"secondary",disabled:0===v,onClick:()=>{v>0&&(m(v-1),y&&y.resetTransform())},children:(0,k.jsx)(N.A,{})}),l.length>1&&(0,k.jsx)(I.A,{title:"Next",color:"secondary",disabled:v>=(null===l||void 0===l?void 0:l.length)-1,onClick:()=>{v<(null===l||void 0===l?void 0:l.length)-1&&(m(v+1),y&&y.resetTransform())},children:(0,k.jsx)(w.A,{})}),(0,k.jsx)(I.A,{title:"Reset",color:"secondary",onClick:()=>{y&&y.resetTransform()},children:(0,k.jsx)(O.A,{})})]}),t&&"view"!==c&&d.update&&"blob"!==u&&(0,k.jsx)(s.A,{direction:"row",className:"tools",sx:{position:"absolute",top:5,right:5,zIndex:1,backgroundColor:"white"},children:(0,k.jsx)(I.A,{title:"Delete",color:"secondary",onClick:()=>h(!0),children:(0,k.jsx)(g.A,{})})})]})}),(0,k.jsx)(S.A,{open:f,handleClose:()=>h(!1),handleConfirm:()=>{const e="blob"===u?"":null===l||void 0===l?void 0:l.filter(((e,l)=>l!==v));r(d.columnName,e),m(e.length?0:null),h(!1),p((l=>({...l,preview:{...l.preview,inputValue:e}})))},title:"Delete Field",message:"Are you sure you want to delete?",confirmBtnTitle:"Delete"})]}):(0,k.jsx)(a.A,{children:"Image Preview"})};var M=t(56334),E=t(62054);const V=e=>{let{columnName:l,multiple:t,maxCount:o,maxSize:a,isDocument:r,setValue:d,value:u,validationsChecked:s}=e;const c=(0,i.useRef)(null),p=null!==u&&void 0!==u&&u[0]?o-(null===u||void 0===u?void 0:u.length):null!==u&&void 0!==u&&u.length?o-(null===u||void 0===u?void 0:u.length)+1:o;return(0,k.jsxs)(i.Fragment,{children:[(0,k.jsx)("input",{ref:c,type:"file",multiple:t,accept:r?"application/pdf":"image/jpeg, image/jpg, image/png",style:{display:"none"},onChange:e=>{const t=Array.from(e.target.files),i=null===t||void 0===t?void 0:t.filter((e=>r?!["application/pdf"].includes(e.type):!["image/jpeg","image/jpg","image/png"].includes(e.type))),n=1024*(a||0)*1024,c=t.filter((e=>e.size>n));if(a&&(null===c||void 0===c?void 0:c.length)>0)return e.target.value=null,(0,E.A)(`File(s) exceed the maximum size limit of ${a} MB.`,{variant:"warning"});if((null===t||void 0===t?void 0:t.length)>p)return e.target.value=null,(0,E.A)(`Number of images exceeds the limit (up to ${o} allowed).`,{variant:"warning"});if((null===i||void 0===i?void 0:i.length)>0)return e.target.value=null,r?(0,E.A)("Please select only PDF files.",{variant:"warning"}):(0,E.A)("Please select only JPG/JPEG or PNG files.",{variant:"warning"});const v={};u&&null!==u&&void 0!==u&&u[0]||(v[l]=[]),t.forEach((e=>{const t=e.name.replace(/\s+/g,"_"),i=new File([e],t,{type:e.type});v[l].push(i)})),d(l,v[l]),s()}}),(0,k.jsx)(n.A,{onClick:()=>{var e;null===c||void 0===c||null===(e=c.current)||void 0===e||e.click()},color:"primary",children:(0,k.jsx)(M.A,{})})]})};var R=t(99635),z=t(89649),P=t(96951),L=t(29024),B=t(33507),q=t(52867),H=t(52351),$=t(50684);const K={},U=/^l_[a-z]_approver_name$/,W=/^l_[a-z]_approval_date$/,Y={et:(e,l)=>Array.isArray(e)?e.some((e=>e===l)):e===l,net:(e,l)=>Array.isArray(e)?!e.some((e=>e===l)):e!==l,gt:(e,l)=>Array.isArray(e)?e.some((e=>e>l)):e>l,lt:(e,l)=>Array.isArray(e)?e.some((e=>e<l)):e<l,gte:(e,l)=>Array.isArray(e)?e.some((e=>e>=l)):e>=l,lte:(e,l)=>Array.isArray(e)?e.some((e=>e<=l)):e<=l},G={and:Array.prototype.every,or:Array.prototype.some},J=(e,l)=>"number"===l?Number(e):e,Z=()=>{const e=(0,f.wA)(),{user:l}=(0,B.A)(),{formId:t,responseId:p,mode:h}=(0,m.g)(),{formAttributes:y,dropdownLov:g}=(0,A.I)(),N=(0,i.useRef)(!1),[{dropdownLovData:w,searchedDataColumns:C,visibleData:D,searchedData:O,searchValue:I,searchModal:S,hiddenFields:M,preview:V,validate:Z,toBeFetchedDropDowns:Q,fetchDropDown:ee,dataFecthed:le,submitState:te,editable:ie,openDeleteModal:oe,sameDependencies:ne},ae]=(0,i.useState)({searchedData:[],searchModal:"",searchValue:"",hiddenFields:{},validate:!1,toBeFetchedDropDowns:null,fetchDropDown:!1,dataFecthed:!1,submitState:!1,editable:[],deleteFile:"",openDeleteModal:!1,sameDependencies:{},preview:null}),re=(0,v.mN)({mode:"all",defaultValues:{}}),{handleSubmit:de,setValue:ue,getValues:se,reset:ce,formState:{isDirty:pe,errors:ve}}=re,{l_a_approval_status:me,l_b_approval_status:fe}=re.watch(),{paginations:{pageSize:he,pageIndex:ye},setPageIndex:ge,setPageSize:be}=(0,z.A)(),{formFieldsData:xe,isMapping:je}=(0,i.useMemo)((()=>{var e;if(!y||!y.formAttributesObject)return[];const l=y.formAttributesObject.rows||[],t=null===(e=y.formAttributesObject.formsData)||void 0===e?void 0:e.mappingTableId;return{formFieldsData:l.filter((e=>e.view||e.update)),isMapping:t}}),[y]),Ae=(0,i.useCallback)(((e,l)=>{if(w&&e in w){const i=w[e];for(let e=0;e<i.length;e++){var t;if((null===(t=i[e].name)||void 0===t?void 0:t.toLowerCase())===l.toLowerCase())return i[e].id}}return null}),[w]),_e=(0,i.useMemo)((()=>({l_a_approval_status:(null===me||void 0===me?void 0:me[0])||void 0,l_b_approval_status:(null===fe||void 0===fe?void 0:fe[0])||void 0})),[me,fe]),{dynamicKeys:Ne,dependencies:we,requiredFields:Ce,allColumnsWithId:De,allDepenedentColumnsById:Oe,fieldsChildrenAttributes:Te,defaultHidden:Ie,inputTypes:Se,formValidationsForReqruired:ke,isDeleted:Fe,disableOnSearch:Me,editableFields:Ee}=(0,i.useMemo)((()=>{const e={factoryTableAttr:[],dependentDropdownsFields:[],fieldsChildrenAttributes:{},allFieldsIdByColumnName:{},dynamicKeysByName:{},dynamicKeys:{},dependencies:{},requiredFields:{},allColumnsWithId:{},allDepenedentColumnsById:{},inputTypes:{},defaultHidden:[],formValidationsForReqruired:[],isDeleted:[],disableOnSearch:[],editableFields:[],allColumnNameById:{}};if(xe&&xe.length>0){const l=xe.reduce(((e,l)=>{var t,i,o,n,a,r,d,u;(e.dynamicKeys[l.columnName]=(null===(t=l.name)||void 0===t?void 0:t.replace(/\s/g,""))+"Data",e.allColumnsWithId[l.id]=l.columnName,e.allColumnNameById[l.id]=l.name,e.allFieldsIdByColumnName[l.columnName]=l.id,e.allDepenedentColumnsById[l.columnName]=l.properties.dependency,e.inputTypes[l.columnName]=l.default_attribute.inputType,!l.properties.defaultHide||!l.columnName.match(U)&&!l.columnName.match(W)&&l.columnName.startsWith("l_")||["is_resurvey","resurveyor_org_type","resurveyor_org_id","resurvey_by"].includes(l.columnName)||e.defaultHidden.push(l.columnName),l.isRequired&&"1"===l.isActive&&"ref_code"!==(null===(i=l.default_attribute)||void 0===i?void 0:i.inputType)&&e.formValidationsForReqruired.push(l.columnName),"1"!==l.isActive&&e.isDeleted.push(l.columnName),null!==(o=l.properties)&&void 0!==o&&o.dependency)&&(e.dependencies[l.columnName]=null===(d=l.properties)||void 0===d?void 0:d.dependency,e.requiredFields[l.columnName]=l.isRequired||(null===l||void 0===l||null===(u=l.properties)||void 0===u?void 0:u.factoryTable));return"dropdown"===l.default_attribute.inputType&&e.dependentDropdownsFields.push(l),null!==(n=l.properties)&&void 0!==n&&n.disableOnSearch&&e.disableOnSearch.push(l.columnName),null!==(a=l.properties)&&void 0!==a&&a.editable&&e.editableFields.push(l.columnName),null!==(r=l.properties)&&void 0!==r&&r.factoryTable&&e.factoryTableAttr.push(l.columnName),e}),e);return l.fieldsChildrenAttributes={},Object.entries(l.allFieldsIdByColumnName).forEach((e=>{var t;let[i,o]=e;l.fieldsChildrenAttributes[i]=(null===(t=xe.filter((e=>e.properties.dependency===o)))||void 0===t?void 0:t.length)>0?[l.allColumnNameById[o]]:null})),l}return e}),[xe]);(0,i.useEffect)((()=>{ae((e=>({...e,editable:Ee})))}),[Ee]),(0,i.useEffect)((()=>{xe&&xe.length>0&&xe.forEach((e=>{if(["l_a_exception_ctg","l_a_exception_rmk"].includes(e.columnName))if(_e.l_a_approval_status&&_e.l_a_approval_status!==Ae("L1ApprovalStatusData","Approved")&&e.update)ke.includes(e.columnName)||ke.push(e.columnName);else if(ke.includes(e.columnName)){const l=ke.indexOf(e.columnName);ke.splice(l,1)}if(["l_b_exception_ctg","l_b_exception_rmk"].includes(e.columnName))if(_e.l_b_approval_status&&_e.l_b_approval_status!==Ae("L2ApprovalStatusData","Approved")&&e.update)ke.includes(e.columnName)||ke.push(e.columnName);else if(ke.includes(e.columnName)){const l=ke.indexOf(e.columnName);ke.splice(l,1)}}))}),[xe,_e,Ae,ke]);const Ve=(0,i.useMemo)((()=>Object.fromEntries(Object.entries(Oe).map((e=>{let[l,t]=e;return[l,De[t]||null]})))),[Oe,De]),Re=(0,i.useMemo)((()=>{const e={};return Object.entries(Oe).filter((e=>{let[,l]=e;return De[l]})).forEach((l=>{let[t,i]=l;Object.hasOwn(e,De[i])?e[De[i]].push(t):e[De[i]]=[t]})),e}),[Oe,De]);(0,i.useEffect)((()=>{var e;if((null===g||void 0===g||null===(e=g.dropdownLovDataObject)||void 0===e?void 0:e.length)>0){var l;const e={},t=[];null===g||void 0===g||null===(l=g.dropdownLovDataObject)||void 0===l||l.forEach((l=>{var i,o,n,a;const[r]=Object.keys(l),d=!(null===g||void 0===g||null===(i=g.duplicatedValues)||void 0===i||!i[r]),u=d?null===g||void 0===g||null===(o=g.duplicatedValues)||void 0===o?void 0:o[r]:r,s=r.replace(/\s/g,"")+"Data";e[s]=d?null===g||void 0===g||null===(n=g.dropdownLovDataObject)||void 0===n||null===(a=n.find((e=>{var l;return(null===(l=Object.keys(e))||void 0===l?void 0:l[0])===u})))||void 0===a?void 0:a[u]:l[r],d&&(t[s]=u)})),ae((l=>({...l,dropdownLovData:e,dataFecthed:!0,sameDependencies:Object.fromEntries(Object.entries(null===g||void 0===g?void 0:g.duplicatedValues).map((e=>{let[l,t]=e;return[l.replace(/\s/g,"")+"Data",t.replace(/\s/g,"")+"Data"]})))})))}else g.loading||ae((e=>({...e,dataFecthed:!0})))}),[g]);const ze=(0,i.useCallback)(((e,l)=>{if(!l)return null===w||void 0===w?void 0:w[e];const t=De[l],i=se(t);if(void 0===i)return[];const o=Object.hasOwn(ne,e)?"id":"matchingcolumn";var n,a;return"string"===typeof i?null===w||void 0===w||null===(n=w[e])||void 0===n?void 0:n.filter((e=>i===e[o])):null===w||void 0===w||null===(a=w[e])||void 0===a?void 0:a.filter((e=>null===i||void 0===i?void 0:i.includes(null===e||void 0===e?void 0:e[o])))}),[De,se,ne,w]),Pe=(0,i.useCallback)(((e,l)=>{const t=xe.filter((l=>{var t;return(null===l||void 0===l||null===(t=l.default_attribute)||void 0===t?void 0:t.name)===e})),i={};if(t.length>0&&w)return t.forEach((e=>{var t,o;const n=[],a=[],r=Object.entries(null===e||void 0===e?void 0:e.properties).filter((e=>e[0].startsWith("column"))),d=Object.entries(null===e||void 0===e?void 0:e.properties).filter((e=>e[0].startsWith("separator")));r.sort(((e,l)=>{let[t]=e,[i]=l;return t.replace("column","")-i.replace("column","")})),d.sort(((e,l)=>{let[t]=e,[i]=l;return t.replace("separator","")-i.replace("separator","")})),r.forEach((e=>{let[,l]=e;n.push(l)})),d.forEach((e=>{let[,l]=e;a.push(l)}));const u=null===n||void 0===n?void 0:n.map((e=>{var l,t;const i=xe.find((l=>l.id===e)),o=(null===g||void 0===g||null===(l=g.sourceColumnByIdObject)||void 0===l?void 0:l[i.name])||"";return i?{columnName:null===i||void 0===i?void 0:i.columnName,type:null===i||void 0===i||null===(t=i.default_attribute)||void 0===t?void 0:t.inputType,name:i.name,customKeyName:o}:{}})).filter((e=>Object.keys(e).length>0)),s=`${(null===e||void 0===e||null===(t=e.properties)||void 0===t?void 0:t.prefix)||""}${a[0]}${u.map((e=>{let{columnName:t,type:i,name:o,customKeyName:n}=e;if(i&&"dropdown"===i){const e=o.replace(/\s/g,"")+"Data";if(w&&w[e]){const i=w[e].filter((e=>{var i;return null===(i=l[t])||void 0===i?void 0:i.includes(e.id)})).map((e=>n?e[n]:e.name)).join("/");if(i)return i}}return l[t]})).map(((e,l)=>(e||"")+(a[l+1]||""))).join("")}${(null===e||void 0===e||null===(o=e.properties)||void 0===o?void 0:o.suffix)||""}`;s!==l[e.columnName]&&(i[e.columnName]=s)})),i}),[xe,w,null===g||void 0===g?void 0:g.sourceColumnByIdObject]),Le=(0,i.useCallback)(((e,l)=>{const t=xe.find((l=>{var t,i;return(null===l||void 0===l||null===(t=l.default_attribute)||void 0===t?void 0:t.name)===e||(null===l||void 0===l||null===(i=l.properties)||void 0===i?void 0:i.qrType)===e})),i={};if(t){var o,n,a,r;const e=null===t||void 0===t||null===(o=t.properties)||void 0===o?void 0:o.columnList,d=xe.filter((l=>null===e||void 0===e?void 0:e.includes(l.id.toString()))).map((e=>e.columnName)),u=(null===t||void 0===t||null===(n=t.properties)||void 0===n?void 0:n.separator)||"",s=`${(null===t||void 0===t||null===(a=t.properties)||void 0===a?void 0:a.prefix)||""}${u}${d.map((e=>l[e])).filter((e=>e)).join(u)}${u}${(null===t||void 0===t||null===(r=t.properties)||void 0===r?void 0:r.suffix)||""}`;s!==l[t.columnName]&&(i[t.columnName]=s)}return i}),[xe]),Be=(0,i.useCallback)((()=>{K.timer&&clearTimeout(K.timer),K.timer=setTimeout((()=>{const e={},l={};xe&&(null===xe||void 0===xe?void 0:xe.length)>0&&Ie.length>0&&Ie.forEach((e=>{l[e]=!0}));const t=se(),i=e=>{let{type:l,attribute_visibility_conditions:i}=e;return G[l].call(i,(e=>{var l,i,o,n,a,r,d,u,s,c,p;return(null===e||void 0===e?void 0:e.operatorKey)&&(null===e||void 0===e?void 0:e.compareWithValue)&&(null===e||void 0===e||null===(l=e.form_attribute)||void 0===l?void 0:l.columnName)&&(null===e||void 0===e||null===(i=e.form_attribute)||void 0===i||null===(o=i.default_attribute)||void 0===o?void 0:o.inputType)&&(Array.isArray(t[null===(n=e.form_attribute)||void 0===n?void 0:n.columnName]&&t[null===(a=e.form_attribute)||void 0===a?void 0:a.columnName].length>0)||t[null===(r=e.form_attribute)||void 0===r?void 0:r.columnName])&&Y[e.operatorKey]&&Y[e.operatorKey].call&&Y[e.operatorKey].call(null,J(t[null===(d=e.form_attribute)||void 0===d?void 0:d.columnName],null===(u=e.form_attribute)||void 0===u||null===(s=u.default_attribute)||void 0===s?void 0:s.inputType),J(e.compareWithValue,null===(c=e.form_attribute)||void 0===c||null===(p=c.default_attribute)||void 0===p?void 0:p.inputType))}))};xe.forEach((t=>{const{columnName:o,validations:n,hideConditions:a,showConditions:r}=t;if(a&&!Ie.includes(o)&&(l[o]=a.length>0&&G.or.call(a,i)),l[o]&&(null===r||void 0===r?void 0:r.length)>0&&(l[o]=!G.or.call(r,i)),n){const{type:l,message:t}=n;G[l].call(n.attribute_validation_conditions,(e=>{var l,t,i,o,n,a;const r=null===e||void 0===e||null===(l=e.form_attribute)||void 0===l?void 0:l.columnName,d=null===e||void 0===e||null===(t=e.form_attribute)||void 0===t||null===(i=t.default_attribute)||void 0===i?void 0:i.inputType,u=(null===e||void 0===e||null===(o=e.compare_with_column)||void 0===o||null===(n=o.default_attribute)||void 0===n?void 0:n.inputType)||d;let s=(null===e||void 0===e?void 0:e.compareWithValue)||se(null===e||void 0===e||null===(a=e.compare_with_column)||void 0===a?void 0:a.columnName),c=se(r);if("dropdown"===u&&"number"===d){var p,v;const l=Ne[null===e||void 0===e||null===(p=e.compare_with_column)||void 0===p?void 0:p.columnName],t=w[l];s=null===t||void 0===t||null===(v=t[0])||void 0===v?void 0:v.name}const m=[J(c,d),J(s,u)];if((Array.isArray(c)&&c.length>0||c)&&Y[null===e||void 0===e?void 0:e.operatorKey]&&("dropdown"===d&&((e,l,t)=>{if(Array.isArray(e)&&e.length>0&&["et","net"].includes(t))return G["et"===t?"or":"and"].call(e,(e=>"et"===t?e===l:e!==l));return!1})(c,null===e||void 0===e?void 0:e.compareWithValue,null===e||void 0===e?void 0:e.operatorKey)||Y[null===e||void 0===e?void 0:e.operatorKey].call&&Y[null===e||void 0===e?void 0:e.operatorKey].apply(null,m)))return!0}))&&(e[o]=t)}}));const o=Object.fromEntries(Object.entries(l).filter((e=>e[1])));ae((e=>({...e,hiddenFields:o}))),Object.entries(t).forEach((l=>{let[t,i]=l;!ke.includes(t)||Ie[t]||o[t]||Fe.includes(t)||(i||0===i)&&(!Array.isArray(i)||0!==i.length&&i[0])||(e[t]="Required")}));const n={};Object.entries(e).forEach((e=>{let[l,t]=e;if(o[l]||Fe.includes(l)||Ie[l])return!0;t&&(re.setError(l,{type:"validations",message:t}),n[l]=t)})),Object.keys(ve).forEach((e=>{n[e]||re.clearErrors(e)}))}),100)}),[xe,se,re,ve,Ie,Ne,w,ke,Fe]);(0,i.useEffect)((()=>{Be()}),[Z,Be]),(0,i.useEffect)((()=>{t&&(e((0,L.u44)({formId:t,sortBy:"rank",sortOrder:"ASC"})),(async(e,l)=>{let i=await(0,_.default)("/form-response-by-id",{method:"GET",query:{formId:t,responseId:p}});if(i.success&&null!==(e=i.data)&&void 0!==e&&null!==(l=e.data)&&void 0!==l&&l[0])ce(i.data.data[0]),ae((e=>({...e,fetchDropDown:!0})));else{const e=i.error&&i.error.message?i.error.message:i.error;(0,E.A)(e||"Operation failed. Please try again.",{variant:"error"})}})())}),[e,t,p,re,ce]);const qe=(0,i.useRef)({});(0,i.useEffect)((()=>{var l,i;const o=(null===(l=Object.keys(Q||{}))||void 0===l?void 0:l.length)>0;if(ee&&(null===Q||(null===(i=Object.keys(Q))||void 0===i?void 0:i.length)>0)){const l={formId:t,responseId:p,skipOthers:o,selectedHierarchyValue:o?Q:xe.reduce(((e,l)=>(e[l.name]=se(l.columnName),e)),{}),formDropdowns:xe.filter((e=>{var l;return"Dropdown"===(null===e||void 0===e||null===(l=e.default_attribute)||void 0===l?void 0:l.name)})).map((e=>{var l,t,i,o,n,a,r,d,u,s;return{formAttributeId:null===e||void 0===e?void 0:e.id,name:null===e||void 0===e?void 0:e.name,dependency:null===e||void 0===e||null===(l=e.properties)||void 0===l?void 0:l.dependency,sourceTable:null===e||void 0===e||null===(t=e.properties)||void 0===t?void 0:t.sourceTable,sourceColumn:null===e||void 0===e||null===(i=e.properties)||void 0===i?void 0:i.sourceColumn,type:null===e||void 0===e||null===(o=e.properties)||void 0===o?void 0:o.type,conditions:null===e||void 0===e||null===(n=e.properties)||void 0===n?void 0:n.conditions,extraColumn:null===e||void 0===e||null===(a=e.properties)||void 0===a?void 0:a.extraColumn,factoryTable:null===e||void 0===e||null===(r=e.properties)||void 0===r?void 0:r.factoryTable,factoryColumn:null===e||void 0===e||null===(d=e.properties)||void 0===d?void 0:d.factoryColumn,linkColumn:null===e||void 0===e||null===(u=e.properties)||void 0===u?void 0:u.linkColumn,isWebResponse:!(null===e||void 0===e||null===(s=e.properties)||void 0===s||!s.factoryTable)}}))};e((0,L.Xcn)({dropdownPayload:l,refetched:o,apiVersion:"v2"}))}Q&&(qe.current={...Q})}),[xe,t,p,ee,e,re,Q,se]),(0,i.useEffect)((()=>{const e={};Object.entries(Ne).forEach((l=>{var t,i,o;let[n,a]=l;Ce[n]&&(null===(t=ze(a,we[n]))||void 0===t?void 0:t.length)<=1&&(null===(i=ze(a,we[n]).map((e=>e.id)))||void 0===i?void 0:i[0])!==(null===(o=se(n))||void 0===o?void 0:o[0])&&(e[n]=ze(a,we[n]).map((e=>e.id)))}));const l=Pe("Key Generator",{...se(),...e}),t=Le("generator",{...se(),...e}),i=Object.entries({...e,...l,...t});i.length>0&&i.forEach((e=>{let[l,t]=e;ue(l,t)})),ae((e=>({...e,validate:!e.validate})))}),[ze,Ne,we,Ce,ue,se,Pe,Le,re]);const He=function(e,l,t){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("dropdown"===t){const t={[l]:e};xe.map((e=>{var l,t;return null!==e&&void 0!==e&&null!==(l=e.properties)&&void 0!==l&&l.dependency?{child:e.columnName,parent:De[null===e||void 0===e||null===(t=e.properties)||void 0===t?void 0:t.dependency]}:null})).filter((e=>e)).forEach((e=>{let{child:l,parent:i}=e;if(l&&i){var o;const e=Ne[l],n=Object.hasOwn(ne,e)?"id":"matchingcolumn",a=null===(o=w[e])||void 0===o?void 0:o.filter((e=>{var l;return null===(l=t[i]||se(i)||[])||void 0===l?void 0:l.includes(e[n])})).map((e=>e.id)),r=Object.hasOwn(t,l)?t[l]:se(l)||[];t[l]=null===r||void 0===r?void 0:r.filter((e=>null===a||void 0===a?void 0:a.includes(e)))}}));const i=Pe("Key Generator",{...se(),...t}),o=Le("generator",{...se(),...t});Object.entries({...t,...i,...o}).forEach((e=>{let[l,t]=e;ue(l,t)}))}else{const t=Pe("Key Generator",{...se(),[l]:e}),i=Le("generator",{...se(),[l]:e});Object.entries({[l]:e,...t,...i}).forEach((e=>{let[l,t]=e;ue(l,t)}))}i&&ae((e=>({...e,validate:!e.validate}))),!o&&Te[l]&&e.length>0&&"dropdown"===t&&ae((t=>({...t,toBeFetchedDropDowns:{[Te[l]]:e}})))},[$e,Ke]=(0,i.useState)({});return(0,i.useEffect)((()=>{if(w){const e=(null===me||void 0===me?void 0:me[0])===Ae("L1ApprovalStatusData","Approved"),l=(null===me||void 0===me?void 0:me[0])===Ae("L1ApprovalStatusData","Rejected"),t=(null===fe||void 0===fe?void 0:fe[0])===Ae("L2ApprovalStatusData","Approved"),i={l_a_exception_ctg:e,l_a_exception_rmk:e,is_resurvey:!0,resurveyor_org_type:!l,resurveyor_org_id:!l,resurvey_by:!l,l_b_approval_status:!e,l_b_exception_ctg:!e||t,l_b_exception_rmk:!e||t,l_b_remark:!e};Ke(i),Object.entries(i).forEach((e=>{let[t,i]=e;i&&!["resurveyor_org_type","resurveyor_org_id","resurvey_by"].includes(t)&&ue(t,"is_resurvey"===t?l?"YES":"NO":null)}))}}),[me,fe,w]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(P.Op,{methods:re,onSubmit:de((async e=>{var i;const o=structuredClone(e);if(Object.entries(o).forEach((e=>{let[l]=e;M[l]&&!Ie.includes(l)&&(o[l]=null)})),o.updated_at=Date.now()+"","577b8900-b333-42d0-b7fb-347abc3f0b5c"!==(null===l||void 0===l?void 0:l.id)&&"57436bed-c176-4625-96af-aaeec88cdc90"!==(null===l||void 0===l?void 0:l.id)){var n,a,r;null!==xe&&void 0!==xe&&null!==(n=xe.filter((e=>e.columnName.startsWith("l_a")&&e.update)))&&void 0!==n&&n.length&&Object.hasOwnProperty.call(o,"l_a_approval_status")&&Object.hasOwnProperty.call(o,"l_b_approval_status")&&(null===(a=o.l_a_approval_status)||void 0===a?void 0:a[0])===Ae("L1ApprovalStatusData","Approved")&&(null===(r=o.l_b_approval_status)||void 0===r?void 0:r[0])===Ae("L2ApprovalStatusData","Rejected")&&(o.l_b_approval_status=null);(null===xe||void 0===xe?void 0:xe.filter((e=>U.test(e.columnName)&&e.update))).forEach((e=>{o[e.columnName]=[null===l||void 0===l?void 0:l.id]}));(null===xe||void 0===xe?void 0:xe.filter((e=>W.test(e.columnName)&&e.update))).forEach((e=>{o[e.columnName]=(0,q.cD)()}))}o.source="web",o.is_active=1;const d=new FormData;null===(i=Object.entries(o))||void 0===i||i.forEach((e=>{let[l,t]=e;const i=Se[l],o=M[l]&&!Ie.includes(l),n=Fe[l];if(o||n||Array.isArray(t)&&t.length>0&&!t[0])return d.append(l,null);t&&i&&["file","image"].includes(i)?null===t||void 0===t||t.forEach((async(e,t)=>"[object File]"===Object.prototype.toString.call(e)?(e.fileName&&!e.name&&(e.name=e.fileName),d.append(`${l} - ${t}`,e)):(d.append(l,e),d.append(l,e)))):Array.isArray(t)?(d.append(l,t[0]||""),null===t||void 0===t||t.forEach((e=>{d.append(l,e)}))):d.append(l,t)})),ae((e=>({...e,submitState:!0})));let u=await(0,_.default)("/form/update-response",{method:"PUT",body:d,params:t,query:{keepOlderVersion:!0},headers:{"Content-Type":"multipart/form-data"}});var s;u.success?(0,E.A)("Response Updated Successfully",{variant:"success",autoHideDuration:null},(()=>{window.close()})):(ae((e=>({...e,submitState:!1}))),(0,E.A)((null===u||void 0===u||null===(s=u.error)||void 0===s?void 0:s.message)||"Operation failed. Please try again.",{variant:"error"}))})),children:(0,k.jsx)(T.A,{sx:{mb:2},title:(0,k.jsxs)(o.Ay,{container:!0,sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,k.jsxs)(o.Ay,{item:!0,sx:{display:"flex",alignItems:"center"},children:[(0,k.jsx)(n.A,{sx:{position:"absolute",left:10},onClick:()=>window.close(),color:"primary",children:(0,k.jsx)(x.A,{})}),(0,k.jsx)(a.A,{sx:{position:"relative",left:25},variant:"h4",children:"Response"})]}),!g.loading&&0===g.dropdownLovDataObject.length||!g.loading&&g.dropdownLovDataObject.length>0&&le?"edit"===h&&(0,k.jsx)(o.Ay,{item:!0,children:(0,k.jsx)(r.A,{size:"small",type:"submit",variant:"contained",color:"primary",disabled:te||!(pe&&!Object.keys(ve).some((e=>e))),children:"Update"})}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(o.Ay,{item:!0,display:"flex",sx:{minHeight:30,alignItems:"center"},children:(0,k.jsx)($.W,{variant:"h6",sx:{mr:2},children:"Processing form data, Please wait..."})}),!le&&(0,k.jsx)(H.A,{})]})]}),contentSX:{padding:"16px 16px 0px 16px"},children:(0,k.jsxs)(o.Ay,{container:!0,spacing:2,sx:{height:"68vh"},children:[(0,k.jsx)(o.Ay,{item:!0,md:8.4,sx:{height:"100%",overflowY:"auto",marginRight:2,paddingRight:2},children:(0,k.jsxs)(o.Ay,{container:!0,item:!0,rowSpacing:4,columnSpacing:2.5,sx:{padding:1,direction:"ltr",justifyContent:"space-between"},children:[je&&"view"!==h&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(o.Ay,{item:!0,md:6,children:(0,k.jsx)(d.A,{value:I,onChange:e=>ae((l=>({...l,searchValue:e.target.value}))),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),ae((l=>({...l,searchValue:e.target.value}))))},placeholder:"Search...",endAdornment:(0,k.jsx)(u.A,{position:"end",children:(0,k.jsx)(n.A,{edge:"end",onClick:I?async()=>{const e=await(0,_.default)("/form/get-mapped-data",{method:"GET",query:{formId:t,searchBy:I}});if(e.success)if(e.data&&e.data.data&&e.data.data.length>0){let l=Object.keys(e.data.data[0]).map((e=>({Header:e,accessor:e})));ae((t=>({...t,searchModal:!1,setSearchedDataColumns:l,searchedData:e.data.data,visibleData:e.data.visibleData})))}else{var l;(0,E.A)((null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.message)||"No Record Found!",{variant:"warning"})}else(0,E.A)(e.error.message)}:()=>{},style:{cursor:"pointer"},children:(0,k.jsx)(j.A,{})})}),sx:{width:"100%"}})}),(0,k.jsx)(o.Ay,{item:!0,md:6})]}),xe&&xe.filter((e=>!M[e.columnName])).map((e=>{var l,t,i,n,r,d,u,c,p,v,m,f,y,x,j,A,_,N,w,C,D,O,T,I,S,F,M,E,V,R,z,L,B,q;return["text","number","email","phone","location","network","key_generator","qrcode","ocr","optical","plus_code","ref_code"].includes(null===(l=e.default_attribute)||void 0===l?void 0:l.inputType)?(0,k.jsx)(o.Ay,{item:!0,md:6,children:(0,k.jsx)(P.o3,{name:e.columnName,handleBlur:l=>{var t,i;"qrcode"===(null===(t=e.default_attribute)||void 0===t?void 0:t.inputType)&&null!==Re&&void 0!==Re&&null!==(i=Re[null===e||void 0===e?void 0:e.columnName])&&void 0!==i&&i.some((e=>"dropdown"===Se[e]))&&ae((t=>({...t,toBeFetchedDropDowns:{[Te[null===e||void 0===e?void 0:e.columnName]]:l.target.value}})))},type:"number"===(null===(t=e.default_attribute)||void 0===t?void 0:t.inputType)?"number":"text",label:e.name,minLength:null===(i=e.properties)||void 0===i?void 0:i.minLength,maxLength:null===(n=e.properties)||void 0===n?void 0:n.maxLength,decimal:null===(r=e.properties)||void 0===r?void 0:r.decimal,fieldType:null===(d=e.default_attribute)||void 0===d?void 0:d.inputType,decimalPoint:null===(u=e.properties)||void 0===u?void 0:u.decimalPoints,setInsideErrors:l=>re.setError(e.columnName,{type:"validations",message:l({})[e.columnName]}),disabled:W.test(e.columnName)||"view"===h||!e.update||["text","number","email","phone"].includes(null===(c=e.default_attribute)||void 0===c?void 0:c.inputType)&&!ie.includes(null===e||void 0===e?void 0:e.columnName)||!["text","number","email","phone"].includes(null===(p=e.default_attribute)||void 0===p?void 0:p.inputType)&&e.properties&&void 0!==e.properties.editable&&!e.properties.editable||$e[e.columnName],multiline:"number"!==(null===(v=e.default_attribute)||void 0===v?void 0:v.inputType),handleChange:l=>{var t,i;return He(null===(t=l.target)||void 0===t?void 0:t.value,null===e||void 0===e?void 0:e.columnName,null===e||void 0===e||null===(i=e.default_attribute)||void 0===i?void 0:i.inputType)},InputProps:{style:{resize:"vertical",overflowY:"hidden",height:"40px",minHeight:"40px"}},required:ke.includes(e.columnName)})},e.id):"date"===(null===(m=e.default_attribute)||void 0===m?void 0:m.inputType)?(0,k.jsx)(o.Ay,{item:!0,md:6,children:(0,k.jsx)(b.A,{name:e.columnName,label:e.name,pickerType:(null===(f=e.properties)||void 0===f?void 0:f.pickerType)||"",timeFormat:(null===(y=e.properties)||void 0===y?void 0:y.timeFormat)||"",minDate:null===(x=e.properties)||void 0===x?void 0:x.minDate,maxDate:null===(j=e.properties)||void 0===j?void 0:j.maxDate,setInsideErrors:l=>re.setError(e.columnName,{type:"validations",message:l({})[e.columnName]}),onChange:l=>{var t;return He(l,null===e||void 0===e?void 0:e.columnName,null===e||void 0===e||null===(t=e.default_attribute)||void 0===t?void 0:t.inputType)},disabled:W.test(e.columnName)||"view"===h||!e.update||!ie.includes(null===e||void 0===e?void 0:e.columnName)||$e[e.columnName],required:ke.includes(e.columnName)})},e.id):"chip"===(null===(A=e.default_attribute)||void 0===A?void 0:A.inputType)?(0,k.jsx)(o.Ay,{item:!0,md:6,children:(0,k.jsx)(P.Yq,{name:e.columnName,single:!0,disable:"view"===h||!e.update||e.properties&&void 0!==e.properties.editable&&!e.properties.editable||$e[e.columnName],placeholder:"Select Field",label:e.name,onChange:(l,t)=>{var i;return He(l,null===e||void 0===e?void 0:e.columnName,null===e||void 0===e||null===(i=e.default_attribute)||void 0===i?void 0:i.inputType,!0,1===t)},menus:(null===(_=e.properties)||void 0===_||null===(N=_.values)||void 0===N?void 0:N.split(",").map((e=>({id:e,name:e}))))||[],required:ke.includes(e.columnName)})},e.id):"checkbox"===(null===(w=e.default_attribute)||void 0===w?void 0:w.inputType)?(0,k.jsx)(o.Ay,{item:!0,md:6,children:(0,k.jsx)(P.Yq,{name:e.columnName,disable:"view"===h||!e.update||e.properties&&void 0!==e.properties.editable&&!e.properties.editable,single:"single"===(null===(C=e.properties)||void 0===C?void 0:C.selectType),placeholder:"Select Field",label:e.name,onChange:l=>{var t;return He(l,null===e||void 0===e?void 0:e.columnName,null===e||void 0===e||null===(t=e.default_attribute)||void 0===t?void 0:t.inputType,!0)},menus:(null===(D=e.properties)||void 0===D||null===(O=D.values)||void 0===O?void 0:O.split(",").map((e=>({id:e,name:e}))))||[],required:ke.includes(e.columnName)})},e.id):"dropdown"===(null===(T=e.default_attribute)||void 0===T?void 0:T.inputType)?(0,k.jsx)(o.Ay,{item:!0,md:6,children:(0,k.jsx)(P.Yq,{name:e.columnName,disable:U.test(e.columnName)||"view"===h||!e.update||(!(null===e||void 0===e||!e.isRequired)||!(null===e||void 0===e||null===(I=e.properties)||void 0===I||!I.factoryTable))&&1===(null===(S=ze(Ne[e.columnName],null===(F=e.properties)||void 0===F?void 0:F.dependency))||void 0===S?void 0:S.length)||!ie.includes(null===e||void 0===e?void 0:e.columnName)||$e[e.columnName],single:"single"===(null===(M=e.properties)||void 0===M?void 0:M.selectType),placeholder:"Select Field",label:e.name,autoSelect:(!(null===e||void 0===e||!e.isRequired)||!(null===e||void 0===e||null===(E=e.properties)||void 0===E||!E.factoryTable))&&1===(null===(V=ze(Ne[e.columnName],null===(R=e.properties)||void 0===R?void 0:R.dependency))||void 0===V?void 0:V.length),onChange:l=>{var t;return He(l,null===e||void 0===e?void 0:e.columnName,null===e||void 0===e||null===(t=e.default_attribute)||void 0===t?void 0:t.inputType,!0)},menus:ze(Ne[e.columnName],null===(z=e.properties)||void 0===z?void 0:z.dependency)||[],required:ke.includes(e.columnName),customKeyName:g.sourceColumnByIdObject[e.name]})},e.id):"image"===(null===(L=e.default_attribute)||void 0===L?void 0:L.inputType)||"blob"===(null===(B=e.default_attribute)||void 0===B?void 0:B.inputType)?(0,k.jsx)(o.Ay,{item:!0,md:6,children:(0,k.jsxs)(s.A,{spacing:1,children:[(0,k.jsxs)(a.A,{children:[e.name,e.isRequired&&" *"]}),(0,k.jsx)(X,{name:e.columnName,setState:ae,validationsChecked:()=>ae((e=>({...e,validate:!e.validate}))),mode:h,item:e,openDeleteModal:oe,disabled:"view"===h||!e.update,sx:{"& .MuiFormHelperText-root":{position:"absolute",top:37,left:-10},background:"view"!==h&&e.update?"#fff":"#f2f2f2"},required:ke.includes(e.columnName)})]})},e.id):"file"===(null===(q=e.default_attribute)||void 0===q?void 0:q.inputType)?(0,k.jsx)(o.Ay,{item:!0,md:6,children:(0,k.jsxs)(s.A,{spacing:1,children:[(0,k.jsxs)(a.A,{children:[e.name,e.isRequired&&" *"]}),(0,k.jsx)(X,{name:e.columnName,setState:ae,mode:h,item:e,validationsChecked:()=>ae((e=>({...e,validate:!e.validate}))),openDeleteModal:oe,disabled:"view"===h||!e.update,placeholderType:"file",sx:{"& .MuiFormHelperText-root":{position:"absolute",top:37,left:-10},background:"view"!==h&&e.update?"#fff":"#f2f2f2"},required:ke.includes(e.columnName)})]})},e.id):(0,k.jsx)(k.Fragment,{})}))]})}),(0,k.jsx)(o.Ay,{item:!0,md:3.4,sx:{height:"100%",overflowY:"auto",border:"1px dashed grey",display:"flex",alignItems:"center",justifyContent:"center",padding:"0px 8px !important",marginTop:1},children:(()=>{const e=Array.isArray(null===V||void 0===V?void 0:V.inputValue)?null===V||void 0===V?void 0:V.inputValue:[null===V||void 0===V?void 0:V.inputValue];return null!==V&&void 0!==V&&V.inputValue&&e.length>0&&e[0]?(0,k.jsx)(F,{blockMode:!0,mode:h,imageList:e,setState:ae,setValue:(e,l)=>{ue(e,0===(null===l||void 0===l?void 0:l.length)?[""]:l),ae((e=>({...e,validate:!e.validate})))},preview:V,type:Se[null===V||void 0===V?void 0:V.columnName]}):(0,k.jsx)(a.A,{children:"Image Preview"})})()})]})})}),(0,k.jsx)(c.A,{open:S,onClose:()=>ae((e=>({...e,searchModal:!1}))),scroll:"paper",disableEscapeKeyDown:!0,maxWidth:"lg",children:(0,k.jsx)(R.default,{title:"Fetched Records",data:D,columns:C,count:(null===D||void 0===D?void 0:D.length)||0,hideSearch:!0,hideAddButton:!0,hideEditIcon:!0,hideDeleteIcon:!0,hideRestoreIcon:!0,hideHistoryIcon:!0,selectIcon:!0,miniAction:!0,hideColumnsSelect:!0,hideExportButton:!0,handleRowView:(e,l)=>{const t=O[l],i=D[l],o={},n=[];Object.entries(Ve).map((e=>{let[l,t]=e;if(t&&Object.hasOwn(Ve,t)){if(0===n.length)return n.push([t,l]);const e=n.findIndex((e=>e.includes(t)));if(e>-1)return n[e].push(l);n.push([t,l])}})),null===xe||void 0===xe||xe.forEach((e=>{const l=/^\+\d{12}$/;var o;e.default_attribute.inputType&&"phone"===e.default_attribute.inputType&&t[e.columnName]&&"string"===typeof t[e.columnName]?(t[e.columnName]=null!==(o=t[e.columnName])&&void 0!==o&&o.startsWith("+91")?t[e.columnName]:"+91"+t[e.columnName],re.setError(e.columnName,{type:"validations",message:t[e.columnName]&&l.test(t[e.columnName])?"":"Please enter valid phone number."})):"text"===e.default_attribute.inputType&&i[e.columnName]&&(t[e.columnName]=i[e.columnName])}));const a=Object.keys(t);Object.entries(Ne).forEach((e=>{let[l]=e;n.some((e=>e.includes(l)&&e.some((e=>a.includes(e)))))&&(o[l]=[])}));const r=Object.entries(t),d=JSON.parse(JSON.stringify(Ee));r.forEach((e=>{let[l,t]=e;if(Me.includes(l)&&d.includes(l)&&(Array.isArray(t)&&t.length>0||t&&""!==t)){const e=d.indexOf(l);d[e]=null}})),ae((e=>({...e,editable:d}))),Object.entries({...o,...t}).forEach((e=>{let[l,t]=e;ue(l,t)})),N.current=!0,ae((e=>({...e,validate:!e.validate,searchModal:!1})))},setPageIndex:ge,setPageSize:be,pageIndex:ye,pageSize:he})})]})};function X(e){var l,t,i;let{name:o,placeholderType:a="default",setState:r,mode:d,item:u,openDeleteModal:s,validationsChecked:c,...m}=e;const{control:f,watch:b,setValue:x}=(0,v.xW)(),j=b(o),A=()=>{var e,l,t,i;return(0,k.jsx)(V,{maxCount:null===(e=u.properties)||void 0===e?void 0:e.imageCount,maxSize:null===(l=u.properties)||void 0===l?void 0:l.maxSize,multiple:(null===(t=u.properties)||void 0===t?void 0:t.imageCount)&&"1"!==(null===(i=u.properties)||void 0===i?void 0:i.imageCount),columnName:u.columnName,isDocument:"file"===u.default_attribute.inputType,validationsChecked:c,setValue:x,value:j})},_={file:(null===j||void 0===j?void 0:j.length)>0?"Open File":"No File Available"},N={default:{readOnly:!0,style:{resize:"vertical",overflowY:"hidden",height:"40px",minHeight:"40px"},endAdornment:(Array.isArray(j)?!((null===j||void 0===j?void 0:j.length)>0&&j[0]):!j)?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(n.A,{color:"secondary",children:(0,k.jsx)(y.A,{})}),"view"!==d&&u.update&&"image"===(null===(i=u.default_attribute)||void 0===i?void 0:i.inputType)&&A()]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(n.A,{onClick:()=>r((e=>({...e,preview:{inputValue:j,...u}}))),color:"primary",children:(0,k.jsx)(y.A,{})}),"view"!==d&&u.update&&(null===j||void 0===j?void 0:j.length)<(null===(l=u.properties)||void 0===l?void 0:l.imageCount)&&"image"===(null===(t=u.default_attribute)||void 0===t?void 0:t.inputType)&&A()]})},file:{readOnly:!0,style:{resize:"vertical",overflowY:"hidden",height:"40px",minHeight:"40px"},endAdornment:(null===j||void 0===j?void 0:j.length)>0?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(n.A,{onClick:()=>(e=>{const l=document.createElement("a");l.href="object"===typeof e?URL.createObjectURL(e):e,l.target="_blank",l.click()})(null===j||void 0===j?void 0:j[0]),color:"primary",children:(0,k.jsx)(h.A,{})}),"view"!==d&&u.update&&(0,k.jsx)(g.A,{sx:{cursor:"pointer"},title:"Delete",color:"primary",onClick:()=>{r((e=>({...e,deleteFile:u.columnName}))),r((e=>({...e,openDeleteModal:!0})))}}),(0,k.jsx)(S.A,{open:s,handleClose:()=>r((e=>({...e,openDeleteModal:!1}))),handleConfirm:()=>{x(o,null),r((e=>({...e,openDeleteModal:!1}))),c()},title:"Delete File",message:"Are you sure you want to delete?",confirmBtnTitle:"Delete"})]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(n.A,{color:"secondary",children:(0,k.jsx)(h.A,{})}),"view"!==d&&u.update&&A()]})}};return(0,k.jsx)(v.xI,{name:o,control:f,render:e=>{let{fieldState:{error:l}}=e;return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(p.A,{...m,placeholder:_[a]||Array.isArray(j)?(null===j||void 0===j?void 0:j.length)>0?"View Image":"No Image Available":j?"View Image":"No Image Available",error:!!l,helperText:null===l||void 0===l?void 0:l.message,errorMessage:null===l||void 0===l?void 0:l.message,InputProps:N[a||"default"]||{}})})}})}},12563:(e,l,t)=>{var i=t(24994);l.A=void 0;var o=i(t(79526)),n=t(44414);l.A=(0,o.default)((0,n.jsx)("path",{d:"M8 16h8v2H8zm0-4h8v2H8zm6-10H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5z"}),"DescriptionOutlined")},56334:(e,l,t)=>{var i=t(24994);l.A=void 0;var o=i(t(79526)),n=t(44414);l.A=(0,o.default)((0,n.jsx)("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3zM7 9l1.41 1.41L11 7.83V16h2V7.83l2.59 2.58L17 9l-5-5z"}),"FileUploadOutlined")},62375:(e,l,t)=>{var i=t(24994);l.A=void 0;var o=i(t(79526)),n=t(44414);l.A=(0,o.default)((0,n.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")},40821:(e,l,t)=>{t.d(l,{A:()=>h});var i=t(98587),o=t(58168),n=t(9950),a=t(72004),r=t(88465),d=t(18463),u=t(59254),s=t(45453),c=t(44414);const p=["children","className","component","image","src","style"],v=(0,u.Ay)("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(e,l)=>{const{ownerState:t}=e,{isMediaComponent:i,isImageComponent:o}=t;return[l.root,i&&l.media,o&&l.img]}})((e=>{let{ownerState:l}=e;return(0,o.A)({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},l.isMediaComponent&&{width:"100%"},l.isImageComponent&&{objectFit:"cover"})})),m=["video","audio","picture","iframe","img"],f=["picture","img"],h=n.forwardRef((function(e,l){const t=(0,d.b)({props:e,name:"MuiCardMedia"}),{children:n,className:u,component:h="div",image:y,src:g,style:b}=t,x=(0,i.A)(t,p),j=-1!==m.indexOf(h),A=!j&&y?(0,o.A)({backgroundImage:`url("${y}")`},b):b,_=(0,o.A)({},t,{component:h,isMediaComponent:j,isImageComponent:-1!==f.indexOf(h)}),N=(e=>{const{classes:l,isMediaComponent:t,isImageComponent:i}=e,o={root:["root",t&&"media",i&&"img"]};return(0,r.A)(o,s.R,l)})(_);return(0,c.jsx)(v,(0,o.A)({className:(0,a.A)(N.root,u),as:h,role:!j&&y?"img":void 0,ref:l,style:A,ownerState:_,src:j?y||g:void 0},x,{children:n}))}))},45453:(e,l,t)=>{t.d(l,{A:()=>a,R:()=>n});var i=t(1763),o=t(423);function n(e){return(0,o.Ay)("MuiCardMedia",e)}const a=(0,i.A)("MuiCardMedia",["root","media","img"])}}]);