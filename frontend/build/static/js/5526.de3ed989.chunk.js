"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[5526],{45526:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Y});var a=r(80415),i=r(9950),o=r(27081),n=r(9449),s=r(26473),d=r(60666),l=r(53065),c=r(57073),u=r(4139),v=r(67535),p=r(49985),m=r(80733),x=r(397),h=r(22057),j=r(10371),f=r(68605),g=r(87233),A=r(14341),y=r(24965),S=r(2683),D=r(74745),b=r(65669),k=r(62633),I=r(45281),q=r(57560),Q=r(94908),T=r(62605),O=r(14351),N=r(96951),E=r(29024),W=r(52867),C=r(71826),L=r(62054),M=r(33507),z=r(44414);const w=e=>{let{val:t,overAllData:r,saveValue:a,contractorQuantity:o,trxnName:l,projectQuantity:c,approverDetails:u,view:v,reqApproversData:p,showRemarks:m}=e;const[y,S]=(0,i.useState)(t),[D,b]=(0,i.useState)(""),[k,I]=(0,i.useState)(!1),q=(0,n.mN)({resolver:(0,s.t)(d.Ik().shape({})),defaultValues:{},mode:"all"}),{setValue:Q}=q,T=e=>{if("string"===typeof e&&y){let t={...y};t.approvedQuantity=e,S(t),a(t)}};(0,i.useEffect)((()=>{const e=e=>{if("string"===typeof e&&t){let r={...t};r.approvedQuantity=e,S(r),a(r)}};if(p&&p.id){const r=p&&p.approvedMaterials&&p.approvedMaterials.filter((e=>e.id===t.id));var i,o;if(r&&r[0])b((null===(i=r[0])||void 0===i?void 0:i.approvedQuantity)+""),e((null===(o=r[0])||void 0===o?void 0:o.approvedQuantity)+"")}else if(r&&r.length>0){var n,s;const a=r.filter((e=>e.id===t.id));var d,l;if(null!==(n=a[0])&&void 0!==n&&n.approvedQuantity&&"undefined"!==(null===(s=a[0])||void 0===s?void 0:s.approvedQuantity))b((null===(d=a[0])||void 0===d?void 0:d.approvedQuantity)+""),e((null===(l=a[0])||void 0===l?void 0:l.approvedQuantity)+"");else b((null===t||void 0===t?void 0:t.requestedQuantity)+""),e((null===t||void 0===t?void 0:t.requestedQuantity)+"")}else t&&t.requestedQuantity&&(b((null===t||void 0===t?void 0:t.requestedQuantity)+""),e((null===t||void 0===t?void 0:t.requestedQuantity)+""))}),[t,p,a,r]);return(0,z.jsxs)(N.Op,{methods:q,children:[(0,z.jsx)(x.A,{sx:{maxWidth:1400,marginBottom:1},children:(0,z.jsx)(h.A,{children:(0,z.jsxs)(j.A,{children:[(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsx)(g.A,{children:null===y||void 0===y?void 0:y.name})}),(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsxs)(g.A,{children:[" ",null===y||void 0===y?void 0:y.code]})}),(0,z.jsx)(f.A,{sx:{minWidth:100,maxWidth:100},children:(0,z.jsx)(g.A,{children:null===y||void 0===y?void 0:y.uom})}),(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsx)(g.A,{children:o||0})}),(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsx)(g.A,{children:null===y||void 0===y?void 0:y.requestedQuantity})}),v?(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsx)(g.A,{children:(()=>{if(u&&u.approvedMaterials&&u.approvedMaterials.length>0){return u.approvedMaterials.filter((e=>e.id===y.id))[0].approvedQuantity}return 0})()})}):(0,z.jsxs)(f.A,{sx:{minWidth:150,maxWidth:150},children:[(0,z.jsx)(A.A,{type:"text",value:D,onChange:e=>{let{value:t}=(null===e||void 0===e?void 0:e.target)||{};const r=null===y||void 0===y?void 0:y.uom,a=(0,W.VF)(r);let i=function(e){let t="";t=e.endsWith(".")?e.substring(0,e.length-1):e;return t}(t);if(""===t||(a?/^\d+((\.\d{1,3})|\.)?$/:/^[0-9\b]+$/).test(t))if(t){i>{...y}.requestedQuantity?I(!0):I(!1),b(t),T(i)}else b(""),T("")}}),k&&(0,z.jsx)(g.A,{color:"error",sx:{fontSize:10},children:"Approved Quantity should not be greater than Requested Quantity"})]}),(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:"CONSUMPTIONREQUEST"!==l&&(0,z.jsx)(g.A,{children:c||0})}),v&&(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsx)(g.A,{children:(()=>{if(u&&u.approvedMaterials&&u.approvedMaterials.length>0){return u.approvedMaterials.filter((e=>e.id===y.id))[0].remarks}return"N/A"})()})})]})})}),!v&&m&&(0,z.jsx)(N.o3,{sx:{width:300},name:"remarks",handleChange:e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value){var r,i;Q("remarks",null===e||void 0===e||null===(r=e.target)||void 0===r?void 0:r.value);let t=null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.value,o={...y};o.remarks=t,S(o),a(o)}},label:"Remarks",type:"text"})]})},R=e=>{var t,r,a,l,c,p,m,h,A,R,B,_,P,F;let{onBack:Y,approveData:U}=e;const[V,H]=(0,i.useState)(""),[X,J]=(0,i.useState)(""),[$,G]=(0,i.useState)(""),{user:K}=(0,M.A)(),Z=(0,n.mN)({resolver:(0,s.t)(d.Ik().shape()),defaultValues:{},mode:"all"}),ee=(0,o.wA)(),te=(0,i.useRef)(null),[re,ae]=(0,i.useState)(!1),[ie,oe]=(0,i.useState)(null);(0,i.useEffect)((()=>{ee((0,E.DUm)({projectId:null===U||void 0===U?void 0:U.projectId,transactionTypeId:null===U||void 0===U?void 0:U.transactionTypeId,storeId:(0,W.j5)(U),all:!0,sortBy:"rank",sortOrder:"ASC"})),ee((0,E.DYA)({transactionTypeId:U.transactionTypeId,requestNumber:U.referenceDocumentNumber,storeId:(0,W.rd)(U)}))}),[ee,U]);const{approvers:{approversObject:{rows:ne}},reqApproversList:{approversListObject:{rows:se}}}=(0,Q.O)();(0,i.useEffect)((()=>{if(U){const e=(()=>{var e;let t={heading1:void 0,heading2:void 0,req1:void 0,req2:void 0},r=null===U||void 0===U||null===(e=U.transaction_type)||void 0===e?void 0:e.name;return G(r),r&&("MRF"===r?t={heading1:"Contractor Store QTY",heading2:"Company Store QTY",req1:"to",req2:"from",txnName:r}:"MRR"===r?t={heading1:"Contractor Store QTY",heading2:"Company Store QTY",req1:"from",req2:"to",txnName:r}:"STR"===r?t={heading1:"From Store QTY",heading2:"To Store QTY",req1:"from",req2:"to",txnName:r}:"CONSUMPTIONREQUEST"===r?t={heading1:void 0,heading2:"Store QTY",req1:void 0,req2:"from",txnName:r}:"PTPR"===r&&(t={heading1:"From Project Store QTY",heading2:"To Project Store QTY",req1:"from",req2:"to",txnName:r})),t})();if(e){if(e.req1){const t={project:null===U||void 0===U?void 0:U.projectId,store:"from"===e.req1?U.fromStoreId:U.toStoreId,restricted:!1};ee((0,E.W7d)(t)),H(e.heading1)}if(e.req2){const t={project:"PTPR"===e.txnName?null===U||void 0===U?void 0:U.toProjectId:null===U||void 0===U?void 0:U.projectId,store:"to"===e.req2?U.toStoreId:U.fromStoreId,restricted:!1};ee((0,E.OTR)(t)),J(e.heading2)}}}}),[ee,ne,U]);const{transactionQty:de,transactionSecondQty:le}=(0,T.t)();let{projectStoreData:ce}=(0,i.useMemo)((()=>({projectStoreData:(null===de||void 0===de?void 0:de.stocksObject)||[],isLoading:de.loading||!1})),[de]),{contractorStoreData:ue}=(0,i.useMemo)((()=>({contractorStoreData:(null===le||void 0===le?void 0:le.stocksObject)||[],isLoading:le.loading||!1})),[le]);const ve=(e,t,r)=>{if(e&&e.length>0){const a=e.filter((e=>e.materialId===t||e.id===t));return a&&a[0]&&a[0][r]}return""},pe=e=>{const t={};se&&se.length>0&&se.map((e=>{t[e.approverId]||(t[e.approverId]={status:e.status,approvedMaterials:e.approvedMaterials,createdAt:(0,W.Yq)(e.createdAt),remarks:e.remarks})}));const r=[];return e&&e.length>0&&e.map((e=>{const a={...e};t[e.id]&&t[e.id].status&&("1"===t[e.id].status||"0"===t[e.id].status)&&(a.aprStatus=t[e.id].status,a.approvedMaterials=t[e.id].approvedMaterials,a.approvedCreationDate=t[e.id].createdAt,a.remarks=t[e.id].remarks),r.push(a)})),!U||"1"!==U.approvalStatus&&"0"!==U.approvalStatus?r&&r.length>0?r:e:r&&r.length&&r.filter((e=>"1"===e.aprStatus||"0"===e.aprStatus))},me=e=>{if(se&&0===se.length)return e?e[0]:{};if(e&&e.length>0){let a=null,i=-1,o=-1;if(e&&e.length&&e.forEach(((e,t)=>{"0"===e.aprStatus&&(o=t)})),-1===o)if(e&&e.length&&e.forEach(((e,t)=>{"1"===e.aprStatus&&(i=t)})),i>=0&&i<e.length-1){var t;if((null===(t=e[i])||void 0===t?void 0:t.userId)===(null===K||void 0===K?void 0:K.id))return e[i];a=e[i+1]}else i===e.length-1&&(a=e[i]);else if(o>0&&o<e.length){var r;if((null===(r=e[o])||void 0===r?void 0:r.userId)===(null===K||void 0===K?void 0:K.id))return e[o];a=e[o-1]}else 0===o&&(a=e[o]);return a}return{}},xe=me(pe(ne)),he=e=>{var t,r,a,i,o,n;let s=!1;const d=me(pe(ne));return{payload:{requestName:null===U||void 0===U||null===(t=U.transaction_type)||void 0===t?void 0:t.name,transactionTypeId:null===U||void 0===U||null===(r=U.transaction_type)||void 0===r?void 0:r.id,projectId:null===U||void 0===U||null===(a=U.project)||void 0===a?void 0:a.id,storeId:(0,W.rd)(U),approverStoreId:(0,W.j5)(U),requestNumber:null===U||void 0===U?void 0:U.referenceDocumentNumber,referenceDocumentNumber:null===U||void 0===U?void 0:U.referenceDocumentNumber,approverId:null===d||void 0===d?void 0:d.id,rank:null===d||void 0===d?void 0:d.rank,status:e?"1":"0",remarks:null===U||void 0===U?void 0:U.remarks,name:null===d||void 0===d||null===(i=d.user)||void 0===i?void 0:i.name,email:null===d||void 0===d?void 0:d.email,approverStatus:e?"Approved":"Rejected",approvedMaterials:(()=>{let t=[],r=0;return U.materialData.map((a=>{t.push({id:a.id,approvedQuantity:e?a.approvedQuantity:0,value:e?a.value:0}),(!a.approvedQuantity||a.approvedQuantity>a.requestedQuantity)&&(r+=1)})),s=r>0,t})(),employeeEmail:null===U||void 0===U||null===(o=U.contractor_employee)||void 0===o?void 0:o.email,employeeName:null===U||void 0===U||null===(n=U.contractor_employee)||void 0===n?void 0:n.name},error:s}},je=(e,t)=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(g.A,{gutterBottom:!0,component:"div",sx:{mt:"10px"},variant:"h4",children:e}),(0,z.jsxs)("div",{style:{width:"100%",overflowX:"auto"},children:[(0,z.jsx)(x.A,{sx:{maxWidth:1400},children:(0,z.jsx)(y.A,{children:(0,z.jsxs)(j.A,{children:[(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsx)(g.A,{variant:"h5",sx:{fontSize:14},children:"Name"})}),(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsx)(g.A,{variant:"h5",sx:{fontSize:14},children:"Code"})}),(0,z.jsx)(f.A,{sx:{minWidth:100,maxWidth:100},children:(0,z.jsx)(g.A,{variant:"h5",sx:{fontSize:14},children:"UOM"})}),(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsx)(g.A,{variant:"h5",sx:{fontSize:14},children:X})}),(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsx)(g.A,{variant:"h5",sx:{fontSize:14},children:"Requested Qty"})}),(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsx)(g.A,{variant:"h5",sx:{fontSize:14},children:"Approved Qty"})}),(0,z.jsx)(f.A,{sx:{minWidth:150,maxWidth:150},children:(0,z.jsx)(g.A,{variant:"h5",sx:{fontSize:14},children:V})})]})})}),null===U||void 0===U?void 0:U.materialData.map(((e,r)=>{var a,i;return(0,z.jsx)(w,{val:e,trxnName:$,overAllData:null===U||void 0===U?void 0:U.materialData,saveValue:e=>{((e,t)=>{U.remarks=e.remarks,U.materialData[t]=e,U.materialData[t].approvedQuantity&&""!==U.materialData[t].approvedQuantity?U.materialData[t].value=parseFloat(U.materialData[t].approvedQuantity*U.materialData[t].rate).toFixed(3):U.materialData[t].value=parseFloat(U.materialData[t].requestedQuantity*U.materialData[t].rate).toFixed(3)})(e,r)},contractorQuantity:ve(ue,e.id,"quantity"),projectQuantity:ve(ce,e.id,"quantity"),reqApproversData:(i=se,i&&i.length>0?i[i.length-1]:{}),...t&&{approverDetails:ie,view:!0},...r===(null===U||void 0===U||null===(a=U.materialData)||void 0===a?void 0:a.length)-1&&{showRemarks:!0}},e.id)})),(0,z.jsx)("div",{children:"\xa0"})]})]}),fe=()=>{ae(!1)},ge=(e,t)=>{let r="sender"===t?"From":"To";return["671306a0-48c5-4e0c-a604-d86624f35d6d","b938c0b7-8ee0-491e-af4b-ae7f3cbd9821"].includes(e)||(r="sender"===t?"To":"From"),r};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(N.Op,{methods:Z,children:(0,z.jsxs)(O.A,{title:"Approver Dashboard",ref:te,children:[(0,z.jsx)("div",{style:{width:"100%",overflowX:"auto"},children:(0,z.jsx)(u.Ay,{display:"flex",overflowX:"auto",spacing:4,padding:1,children:ne&&ne.length>0&&pe(ne).map(((e,t)=>{var r;return(0,z.jsxs)(i.Fragment,{children:[t>0&&t<ne.length&&(0,z.jsx)(u.Ay,{item:!0,sx:{width:50,padding:1},mt:3,textAlign:"center",children:(0,z.jsx)(I.A,{style:{fontSize:30,color:"#1890ff"}})}),(0,z.jsx)(u.Ay,{item:!0,sx:{minWidth:190,maxWidth:190},md:3,xl:3,children:(0,z.jsx)(S.A,{elevation:3,sx:{cursor:"pointer"},onClick:()=>{"1"!==e.aprStatus&&"0"!==e.aprStatus||(ae(!0),oe(e))},children:(0,z.jsxs)(k.A,{sx:{padding:"17px",textAlign:"center"},children:[(0,z.jsx)(g.A,{variant:"h5",sx:{fontSize:12},component:"div",children:null===e||void 0===e||null===(r=e.user)||void 0===r?void 0:r.name}),"1"===e.aprStatus?(0,z.jsx)(g.A,{sx:{fontSize:12,fontWeight:700,color:"green"},children:"Approved"}):"0"===e.aprStatus?(0,z.jsx)(g.A,{sx:{fontSize:12,fontWeight:700,color:"red"},children:"Reject"}):(0,z.jsx)(g.A,{sx:{fontSize:12,fontWeight:700,color:"orange"},children:"Pending"}),(0,z.jsx)(g.A,{variant:"body",sx:{fontSize:10},component:"div",children:null!==e&&void 0!==e&&e.approvedCreationDate?"Approved Date: "+(null===e||void 0===e?void 0:e.approvedCreationDate):"-"})]})})})]},e.id)}))})}),(0,z.jsx)(u.Ay,{container:!0,sx:{mt:3,mb:3},children:(0,z.jsx)(u.Ay,{item:!0,md:12,xl:12,children:(0,z.jsx)(D.A,{})})}),(0,z.jsxs)(u.Ay,{container:!0,spacing:4,children:[(0,z.jsx)(u.Ay,{item:!0,md:9,xl:10,children:(0,z.jsx)(g.A,{gutterBottom:!0,component:"div",sx:{mt:"10px"},variant:"h4",children:"Transaction Details"})}),(0,z.jsx)(u.Ay,{item:!0,md:3,xl:2,children:(0,z.jsxs)(g.A,{gutterBottom:!0,component:"div",sx:{mt:"14px"},variant:"h5",children:["Document Number: ",U.referenceDocumentNumber]})}),(0,z.jsxs)(u.Ay,{item:!0,md:4,xl:3,children:[(0,z.jsxs)(g.A,{gutterBottom:!0,children:[(0,z.jsx)("strong",{children:"Project:"})," ",U.project.name]}),(0,z.jsxs)(g.A,{gutterBottom:!0,children:[(0,z.jsx)("strong",{children:"Transaction Type:"})," ",U.transaction_type.name]})]}),(0,z.jsxs)(u.Ay,{item:!0,md:4,xl:3,children:[(0,z.jsxs)(g.A,{gutterBottom:!0,children:[(0,z.jsxs)("strong",{children:[ge(null===U||void 0===U?void 0:U.transactionTypeId,"sender")," Organization:"]})," ",null!==(null===U||void 0===U||null===(t=U.from_store)||void 0===t||null===(r=t.organization)||void 0===r?void 0:r.parentId)?null===U||void 0===U||null===(a=U.from_store)||void 0===a||null===(l=a.organization)||void 0===l||null===(c=l.parent)||void 0===c?void 0:c.name:null===U||void 0===U||null===(p=U.from_store)||void 0===p||null===(m=p.organization)||void 0===m?void 0:m.name]}),(0,z.jsxs)(g.A,{gutterBottom:!0,children:[(0,z.jsxs)("strong",{children:[ge(null===U||void 0===U?void 0:U.transactionTypeId,"receiver")," Organization:"]})," ",null!==(null===U||void 0===U||null===(h=U.to_store)||void 0===h||null===(A=h.organization)||void 0===A?void 0:A.parentId)?null===U||void 0===U||null===(R=U.to_store)||void 0===R||null===(B=R.organization)||void 0===B||null===(_=B.parent)||void 0===_?void 0:_.name:null===U||void 0===U||null===(P=U.to_store)||void 0===P||null===(F=P.organization)||void 0===F?void 0:F.name]})]}),(0,z.jsxs)(u.Ay,{item:!0,md:4,xl:3,children:[(0,z.jsxs)(g.A,{gutterBottom:!0,children:[(0,z.jsxs)("strong",{children:[ge(null===U||void 0===U?void 0:U.transactionTypeId,"sender")," Store:"]})," ",U.from_store.name]}),(0,z.jsxs)(g.A,{gutterBottom:!0,children:[(0,z.jsxs)("strong",{children:[ge(null===U||void 0===U?void 0:U.transactionTypeId,"receiver")," Store:"]})," ",U.to_store.name]})]}),(0,z.jsxs)(u.Ay,{item:!0,md:4,xl:3,children:[(0,z.jsxs)(g.A,{gutterBottom:!0,children:[(0,z.jsx)("strong",{children:"Created Date:"})," ",(0,W.Yq)(U.createdAt)]}),(0,z.jsxs)(g.A,{gutterBottom:!0,children:[(0,z.jsx)("strong",{children:"Updated Date:"})," ",(0,W.Yq)(U.updatedAt)]})]})]}),(0,z.jsx)(u.Ay,{container:!0,sx:{mt:3,mb:3},children:(0,z.jsx)(u.Ay,{item:!0,md:12,xl:12,children:(0,z.jsx)(D.A,{})})}),je("Material Details",!1),(0,z.jsxs)(u.Ay,{container:!0,spacing:4,mt:1,children:[(0,z.jsx)(u.Ay,{item:!0,xs:6}),(0,z.jsx)(u.Ay,{item:!0,xs:2}),(0,z.jsxs)(u.Ay,{item:!0,xs:4,mt:4,sx:{display:"flex",justifyContent:"flex-end",gap:"20px",height:65},children:[(0,z.jsx)(v.A,{size:"small",variant:"outlined",onClick:Y,color:"primary",children:"Back"}),(null===xe||void 0===xe?void 0:xe.userId)===(null===K||void 0===K?void 0:K.id)?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(v.A,{disabled:"2"!==U.approvalStatus||"1"!==U.status,size:"small",variant:"contained",onClick:async()=>{const{payload:e,error:t}=he(!0);if(!1===t){const t=await(0,C.default)("/approve-reject-request-create",{method:"POST",body:e});var r;if(null!==t&&void 0!==t&&t.success)(0,L.A)("Approved successfully!",{variant:"success"}),Y();else(0,L.A)((null===t||void 0===t||null===(r=t.error)||void 0===r?void 0:r.message)||"Something wrong happened!",{variant:"error"})}else(0,L.A)("Invalid approval quantity",{variant:"error"})},color:"primary",children:"Approve"}),(0,z.jsx)(v.A,{disabled:"2"!==U.approvalStatus||"1"!==U.status,size:"small",variant:"contained",onClick:async()=>{const{payload:e}=he(!1),t=await(0,C.default)("/approve-reject-request-create",{method:"POST",body:e});var r;null!==t&&void 0!==t&&t.success?((0,L.A)("Rejected Successfully",{variant:"success"}),Y()):(0,L.A)((null===t||void 0===t||null===(r=t.error)||void 0===r?void 0:r.message)||"Something wrong happened!",{variant:"error"})},color:"primary",children:"Reject"})]}):(0,z.jsx)(z.Fragment,{})]})]})]})}),(0,z.jsx)(b.A,{open:re,onClose:fe,"aria-labelledby":"modal-modal-title",children:(0,z.jsxs)(O.A,{sx:{width:"95%"},modal:!0,darkTitle:!0,content:!1,children:[(0,z.jsx)(u.Ay,{container:!0,spacing:2,alignItems:"center",sx:{mt:0},children:(0,z.jsx)(u.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",padding:"20px"},children:(0,z.jsx)(q.A,{onClick:fe,style:{cursor:"pointer",fontSize:20}})})}),(0,z.jsx)(u.Ay,{m:4,mt:-4,children:je("Material Approve/Reject Details",!0)}),(0,z.jsx)(u.Ay,{container:!0,spacing:4,m:0,children:(0,z.jsxs)(u.Ay,{item:!0,md:6,mt:-3,mb:2,children:[(0,z.jsx)(g.A,{variant:"h5",sx:{fontSize:14},children:"Remarks"}),(0,z.jsx)("br",{}),(0,z.jsx)(g.A,{children:null!==ie&&void 0!==ie&&ie.remarks?null===ie||void 0===ie?void 0:ie.remarks:"N/A"})]})})]})})]})};var B=r(84601),_=r(99635),P=r(46091);const F=e=>{let{value:t,onView:r}=e;return(0,z.jsx)("div",{children:(0,z.jsx)(l.A,{title:"View",placement:"bottom",children:(0,z.jsx)(c.A,{color:"secondary",onClick:()=>r(t),children:(0,z.jsx)(p.A,{})})})})},Y=()=>{const e=(0,o.wA)(),[t,r]=(0,i.useState)(a.j7.pageIndex),[l,c]=(0,i.useState)(a.j7.pageSize),[p,x]=(0,i.useState)(null),[h,j]=(0,i.useState)(!1),[f,g]=(0,i.useState)(null),A=(0,n.mN)({resolver:(0,s.t)(d.Ik().shape({projectId:B.A.project})),defaultValues:{},mode:"all"});(0,i.useEffect)((()=>{e((0,E.uiG)())}),[e]);const{projectsDropdown:y}=(0,m.Y)(),S=null===y||void 0===y?void 0:y.projectsDropdownObject,{handleSubmit:D}=A,{transactionRequest:b}=(0,P.b)(),{reqData:k}=(0,i.useMemo)((()=>{var e,t;return{reqData:(null===b||void 0===b||null===(e=b.requestDetails)||void 0===e?void 0:e.rows)||[],reqCount:(null===b||void 0===b||null===(t=b.requestDetails)||void 0===t?void 0:t.count)||0}}),[b]),I=e=>{x(e),j(!0)};return(0,z.jsx)(z.Fragment,{children:h?(0,z.jsx)(R,{approveData:p,onBack:()=>{e((0,E.exE)({projectId:f,status:"1",approvalStatus:"2",excludeCancel:"1",sortBy:"updatedAt",sortOrder:"DESC"})),j(!1)}}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(N.Op,{methods:A,onSubmit:D((t=>{g(t.projectId),e((0,E.exE)({projectId:t.projectId,status:"1",approvalStatus:"2",excludeCancel:"1",sortBy:"updatedAt",sortOrder:"DESC"}))})),children:(0,z.jsxs)(O.A,{title:"Approver Dashboard",children:[(0,z.jsx)(u.Ay,{container:!0,spacing:4,children:(0,z.jsx)(u.Ay,{item:!0,xs:12,sm:3,children:(q="projectId",Q="Project",T=S,C=!0,(0,z.jsx)(N.eu,{name:q,onChange:L,label:Q,InputLabelProps:{shrink:!0},menus:T,...C&&{required:!0}}))})}),(0,z.jsx)(u.Ay,{container:!0,spacing:2,alignItems:"center",sx:{mt:2},children:(0,z.jsx)(u.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px"},children:(0,z.jsx)(v.A,{size:"small",type:"submit",variant:"contained",color:"primary",children:"Proceed"})})})]})}),k&&f&&(0,z.jsx)(_.default,{title:"",hideHeader:!0,data:(e=>{let t=[];return e.map((e=>{t.push({...e,actions:(0,z.jsx)(F,{value:e,onView:I}),approveStatus:"2"===e.approvalStatus?"Pending":"1"===e.approvalStatus?"Approved":"Rejected"})})),t})((e=>{const t=[],r={};return JSON.parse(JSON.stringify(e)).map((e=>{const t={id:e.materialId,name:e.material.name,code:e.material.code,uom:e.uom.name,requestedQuantity:e.requestedQuantity,store:!e.transaction_type||"MRR"!==e.transaction_type.name&&"CONSUMPTIONREQUEST"!==e.transaction_type.name?e.to_store:e.from_store,value:e.value,rate:e.rate,remarks:e.remarks};r[e.referenceDocumentNumber+e.transactionTypeId+(0,W.rd)(e)]&&r[e.referenceDocumentNumber+e.transactionTypeId+(0,W.rd)(e)].materialData?r[e.referenceDocumentNumber+e.transactionTypeId+(0,W.rd)(e)].materialData.push(t):(e.materialData=[],e.materialData=[t],r[e.referenceDocumentNumber+e.transactionTypeId+(0,W.rd)(e)]=e)})),Object.keys(r).forEach((e=>{t.push(r[e])})),t})(k)),count:k.length,columns:[{Header:"Actions",accessor:"actions"},{Header:"Request Number",accessor:"referenceDocumentNumber"},{Header:"Transaction Name",accessor:"transaction_type.name"},{Header:"Approval Status",accessor:"approveStatus"},{Header:"Store",accessor:"materialData[0].store.name"},{Header:"Created On",accessor:"createdAt"},{Header:"Updated On",accessor:"updatedAt"}],hideActions:!0,setPageIndex:r,setPageSize:c,pageIndex:t,pageSize:l})]})});var q,Q,T,C,L}},94908:(e,t,r)=>{r.d(t,{O:()=>o});var a=r(9950),i=r(27081);const o=()=>{const[e,t]=(0,a.useState)({approversObject:{},error:"",loading:!0}),[r,o]=(0,a.useState)({approversListObject:[],error:"",loading:!0}),[n,s]=(0,a.useState)({approversListObject:[],error:"",loading:!0}),d=(0,i.d4)((e=>e.approvers||[])),l=(0,i.d4)((e=>e.getAllApproversList||[])),c=(0,i.d4)((e=>e.getAllApproversData||[]));return(0,a.useEffect)((()=>{t((e=>({...e,...d})))}),[d]),(0,a.useEffect)((()=>{o((e=>({...e,...l})))}),[l]),(0,a.useEffect)((()=>{s((e=>({...e,...c})))}),[c]),{approvers:e,approversList:r,reqApproversList:n}}},62605:(e,t,r)=>{r.d(t,{t:()=>o});var a=r(9950),i=r(27081);const o=()=>{const[e,t]=(0,a.useState)({stocksObject:{},error:"",loading:!0}),[r,o]=(0,a.useState)({transactionObject:{},error:"",loading:!1}),[n,s]=(0,a.useState)({transactionObject:{},error:"",loading:!0}),[d,l]=(0,a.useState)({transactionObject:{},error:"",loading:!0}),[c,u]=(0,a.useState)({transactionObject:{},error:"",loading:!0}),[v,p]=(0,a.useState)({data:{},error:"",loading:!0}),[m,x]=(0,a.useState)({data:{},error:"",loading:!0}),[h,j]=(0,a.useState)({data:{},error:"",loading:!0}),[f,g]=(0,a.useState)({stoDataObject:{},error:"",loading:!0}),[A,y]=(0,a.useState)({refDataObject:{},error:"",loading:!0}),[S,D]=(0,a.useState)({refDataSecondObject:{},error:"",loading:!0}),[b,k]=(0,a.useState)({refDataThirdObject:{},error:"",loading:!0}),[I,q]=(0,a.useState)({stockLedgerDetailListObject:{},error:"",loading:!0}),[Q,T]=(0,a.useState)({storeLocationsTransactionObject:{},error:"",loading:!0}),[O,N]=(0,a.useState)({allStoreLocationsStock:[],error:"",loading:!0}),[E,W]=(0,a.useState)({transactionObject:{},error:"",loading:!1}),[C,L]=(0,a.useState)({transactionObject:{},error:"",loading:!1}),[M,z]=(0,a.useState)({storeLocationsTransactionObject:{},error:"",loading:!0}),[w,R]=(0,a.useState)({storeLocationsTransactionObject:{},error:"",loading:!0}),[B,_]=(0,a.useState)({transactionObject:{},error:"",loading:!1}),P=(0,i.d4)((e=>e.stocks||{})),F=(0,i.d4)((e=>e.transactions||{})),Y=(0,i.d4)((e=>e.transactionsSecond||{})),U=(0,i.d4)((e=>e.transactionsQty||{})),V=(0,i.d4)((e=>e.transactionsSecondQty||{})),H=(0,i.d4)((e=>e.serialNumbers||{})),X=(0,i.d4)((e=>e.serialNumbersSecond||{})),J=(0,i.d4)((e=>e.allSerialNumbers||{})),$=(0,i.d4)((e=>e.stoData||{})),G=(0,i.d4)((e=>e.refData||{})),K=(0,i.d4)((e=>e.refDataSecond||{})),Z=(0,i.d4)((e=>e.refDataThird||{})),ee=(0,i.d4)((e=>e.stockLedgerDetailList||{})),te=(0,i.d4)((e=>e.storeLocationsTransactions||{})),re=(0,i.d4)((e=>e.storeLocationsStock||[])),ae=(0,i.d4)((e=>e.transactionMaterialList||{})),ie=(0,i.d4)((e=>e.txnByMaterial||{})),oe=(0,i.d4)((e=>e.txnByLocationMaterial||{})),ne=(0,i.d4)((e=>e.storeStockReport||{})),se=(0,i.d4)((e=>e.stockLedgerMaterialList||{}));return(0,a.useEffect)((()=>{t((e=>({...e,...P})))}),[P]),(0,a.useEffect)((()=>{o((e=>({...e,...F})))}),[F]),(0,a.useEffect)((()=>{s((e=>({...e,...Y})))}),[Y]),(0,a.useEffect)((()=>{l((e=>({...e,...U})))}),[U]),(0,a.useEffect)((()=>{u((e=>({...e,...V})))}),[V]),(0,a.useEffect)((()=>{p((e=>({...e,...H})))}),[H]),(0,a.useEffect)((()=>{x((e=>({...e,...X})))}),[X]),(0,a.useEffect)((()=>{j((e=>({...e,...J})))}),[J]),(0,a.useEffect)((()=>{g((e=>({...e,...$})))}),[$]),(0,a.useEffect)((()=>{y((e=>({...e,...G})))}),[G]),(0,a.useEffect)((()=>{D((e=>({...e,...K})))}),[K]),(0,a.useEffect)((()=>{k((e=>({...e,...Z})))}),[Z]),(0,a.useEffect)((()=>{q((e=>({...e,...ee})))}),[ee]),(0,a.useEffect)((()=>{T((e=>({...e,...te})))}),[te]),(0,a.useEffect)((()=>{N((e=>({...e,...re})))}),[re]),(0,a.useEffect)((()=>{W((e=>({...e,...ae})))}),[ae]),(0,a.useEffect)((()=>{L((e=>({...e,...ie})))}),[ie]),(0,a.useEffect)((()=>{z((e=>({...e,...oe})))}),[oe]),(0,a.useEffect)((()=>{R((e=>({...e,...ne})))}),[ne]),(0,a.useEffect)((()=>{_((e=>({...e,...se})))}),[se]),{stocks:e,transaction:r,serialNumbers:v,serialNumbersSecond:m,allSerialNumbers:h,stoData:f,refData:A,stockLedgerDetailList:I,storeLocationsTransaction:Q,transactionsSecond:n,refDataSecond:S,refDataThird:b,transactionQty:d,transactionSecondQty:c,storeLocationsStock:O,transactionMaterialList:E,txnByMaterial:C,txnByLocationMaterial:M,storeStockReport:w,stockLedgerMaterialList:B}}},46091:(e,t,r)=>{r.d(t,{b:()=>o});var a=r(9950),i=r(27081);const o=()=>{const[e,t]=(0,a.useState)({requestDetails:{},error:"",loading:!0}),r=(0,i.d4)((e=>e.requestList||{}));return(0,a.useEffect)((()=>{t((e=>({...e,...r})))}),[r]),{transactionRequest:e}}}}]);