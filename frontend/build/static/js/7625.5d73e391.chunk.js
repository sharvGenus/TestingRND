"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[7625],{89649:(e,t,a)=>{a.d(t,{A:()=>n});var o=a(9950),r=a(80415);function n(){const[e,t]=(0,o.useState)({pageIndex:r.j7.pageIndex,pageSize:r.j7.pageSize,forceUpdate:!0}),a=(0,o.useCallback)((function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.pageIndex,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.pageSize;t((e=>({pageIndex:a,pageSize:o,forceUpdate:!e.forceUpdate})))}),[e]),n=(0,o.useCallback)((()=>{t((e=>({pageIndex:r.j7.pageIndex,pageSize:r.j7.pageSize,forceUpdate:!e.forceUpdate})))}),[]);return{paginations:e,setPageIndex:e=>t((t=>({...t,pageIndex:e,forceUpdate:!t.forceUpdate}))),setPageSize:e=>t((t=>({pageIndex:r.j7.pageIndex,pageSize:e,forceUpdate:!t.forceUpdate}))),refreshPagination:n,setPaginationsFunctions:a}}},17625:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var o=a(9950),r=a(95537),n=a(4139),i=a(67535),d=a(9449),s=a(28429),l=a(88848),u=a(96951),c=a(99635),m=a(52867),p=a(89649),v=a(71826),g=a(62054),S=a(52351),x=a(44414);const I=[{Header:"Name",accessor:"material.name"},{Header:"Code",accessor:"material.code"},{Header:"Requested Quantity",accessor:"requestedQuantity"},{Header:"UOM",accessor:"uom.name"}],f=e=>{let{reqData:t,setReqData:a}=e;const[r,f]=(0,o.useState)(!1),{paginations:{pageSize:h,pageIndex:y},setPageIndex:b,setPageSize:j}=(0,p.A)(),q=(0,s.Zp)(),z=(0,d.mN)({defaultValues:{},mode:"all"}),{handleSubmit:A,setValue:T}=z,{masterMakerLovs:C}=(0,l.$)(),P=C.masterMakerLovsObject.rows,k=(0,m.x)(P,"CANCELSTR"),N=(0,m.x)(P,"STR"),R=(0,o.useMemo)((()=>{var e,a;return(null===t||void 0===t||null===(e=t[0])||void 0===e?void 0:e.to_store)&&[null===t||void 0===t||null===(a=t[0])||void 0===a?void 0:a.to_store]||[]}),[t]);(0,o.useEffect)((()=>{null!==R&&void 0!==R&&R.length&&T("toProjectSiteStoreId",null===R||void 0===R?void 0:R[0].id)}),[T,R]);return(0,x.jsxs)(x.Fragment,{children:[r&&(0,x.jsx)(S.A,{}),(0,x.jsxs)(u.Op,{methods:z,onSubmit:A((async()=>{var e,a,o;f(!0);const r=(()=>{const e=[];t.map((t=>{e.push(t.id)}));const a=t.map((t=>{var a,o,r,n,i,d,s,l,u;return{requestIds:e,requestName:"STR",transactionTypeId:k,requestNumber:t.referenceDocumentNumber,requestTransactionTypeId:N,requestOrganizationId:null!==t&&void 0!==t&&null!==(a=t.to_store)&&void 0!==a&&null!==(o=a.organization)&&void 0!==o&&o.parentId?null===t||void 0===t||null===(r=t.to_store)||void 0===r||null===(n=r.organization)||void 0===n?void 0:n.parentId:null===t||void 0===t||null===(i=t.to_store)||void 0===i||null===(d=i.organization)||void 0===d?void 0:d.id,requestStoreId:null===(s=t.to_store)||void 0===s?void 0:s.id,projectId:t.projectId,fromStoreId:null===(l=t.from_store)||void 0===l?void 0:l.id,fromStoreLocationId:t.fromStoreLocationId,toStoreId:null===(u=t.to_store)||void 0===u?void 0:u.id,toStoreLocationId:t.toStoreLocationId,materialId:t.materialId,uomId:t.uomId,requestedQuantity:t.requestedQuantity,approvedQuantity:t.approvedQuantity||0,rate:t.rate||0,value:t.value||0,tax:t.tax||0,serialNumbers:t.serialNumbers,vehicleNumber:t.vehicleNumber,remarks:t.remarks}}));return{payload:(0,m.cF)(a)}})(),n=await(0,v.default)("/cancel-request-create",{method:"POST",body:r});var i;if(!n.success)return(0,g.A)((null===n||void 0===n||null===(i=n.error)||void 0===i?void 0:i.message)||"Operation failed. Please try again!",{variant:"error",timeoutOverride:12e4}),void f(!1);const d=null!==(e=null===(a=n.data)||void 0===a?void 0:a.data)&&void 0!==e?e:{},s=d.referenceDocumentNumber||(null===(o=d[0])||void 0===o?void 0:o.referenceDocumentNumber);(0,g.A)(s?`Request cancelled with reference number: ${s}`:"Request cancelled successfully!",{variant:"success",autoHideDuration:1e4}),f(!1),q("/stock-ledger")})),children:[(0,x.jsx)(n.Ay,{container:!0,spacing:4,alignItems:"center",sx:{mb:2,display:"none"},children:(0,x.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,x.jsx)(u.eu,{name:"toProjectSiteStoreId",label:"To Company Store",menus:R||[],InputLabelProps:{shrink:!0},disable:!0,required:!0})})}),(0,x.jsx)(c.default,{title:"Cancel STR",hideHeader:!0,hidePagination:!0,data:t,count:t.length,columns:I,hideActions:!0,setPageIndex:b,setPageSize:j,pageIndex:y,pageSize:h}),(0,x.jsx)(n.Ay,{item:!0,md:12,xl:2,sx:{mt:4},children:(0,x.jsxs)(n.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px"},children:[(0,x.jsx)(i.A,{onClick:()=>{a([]),q("./")},size:"small",variant:"outlined",color:"primary",children:"Back"}),(0,x.jsx)(i.A,{disabled:r,size:"small",type:"submit",variant:"contained",color:"primary",children:"Reverse"})]})})]})]})};var h=a(14351),y=a(47501);const b=()=>{const[e,t]=(0,o.useState)([]),[a,n]=(0,o.useState)(),[i,d]=(0,o.useState)();return(0,x.jsxs)(h.A,{title:"Cancel STR (Stock Transfer Request)",sx:{mb:2},children:[(0,x.jsx)(y.A,{type:"request",transactionType:"STR",fromStoreType:"COMPANY",toStoreType:"COMPANY",disableAll:!(null===e||void 0===e||!e.length),setReqData:t,setFromStoreId:d,fromStoreLabel:"From Company Store",setFromOrganizationId:n,toStoreLabel:"To Company Store",showToStoreDropdown:!0,getFilteredStore:!0}),e&&e.length>0&&(0,x.jsx)(r.A,{sx:{mt:4},children:(0,x.jsx)(f,{reqData:e,fromOrganizationId:a,fromStoreId:i,setReqData:t})})]})}}}]);