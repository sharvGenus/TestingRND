"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[7700],{7700:(e,t,r)=>{r.r(t),r.d(t,{default:()=>L});var a=r(9950),o=r(96583),n=r(27081),d=r(29024),l=r(80733),s=r(12257),i=r(4139),c=r(67535),u=r(60666),v=r(9449),p=r(26473),m=r(71826),y=r(87991),h=r(96951),f=r(14351),g=r(84601),b=r(62054),j=r(44414);const w=e=>{const t=(0,n.wA)(),{data:r,view:o,update:l,setRefresh:w,selectedParent:x,selectedProject:A,setSelectedProject:I,setSelectedParent:S,setSelectedNetworkId:k,refreshPagination:P,setSelectedParentId:E,projectData:C,user:L}=e,N=(0,v.mN)({resolver:(0,p.t)(u.Ik().shape({name:g.A.other,code:g.A.other,gaaHierarchyId:g.A.other,projectId:g.A.other,approvalStatus:g.A.other})),defaultValues:{},mode:"all"}),H="577b8900-b333-42d0-b7fb-347abc3f0b5c"===(null===L||void 0===L?void 0:L.id)||"57436bed-c176-4625-96af-aaeec88cdc90"===(null===L||void 0===L?void 0:L.id)?[{name:"Approved",id:"Approved"},{name:"Unapproved",id:"Unapproved"}]:[{name:"Unapproved",id:"Unapproved"}],{handleSubmit:D,setValue:O,getValues:B,clearErrors:T}=N,z=(0,a.useCallback)((()=>{w();const e=B();N.reset({name:"",code:"",projectId:e.projectId,gaaHierarchyId:e.gaaHierarchyId,approvalStatus:""})}),[w,N,B]);(0,a.useEffect)((()=>{var e,t;(r||z(),o||l)&&(O("gaaHierarchyId",r.gaaHierarchyId),O("projectId",null===r||void 0===r||null===(e=r.gaa_hierarchy)||void 0===e?void 0:e.projectId),O("approvalStatus",null===r||void 0===r?void 0:r.approvalStatus),t=r,Object.entries(t).forEach((e=>{let[t,r]=e;O(t,r)})));T()}),[r,l,o,O,z,T]),(0,a.useEffect)((()=>{if(A){const e="577b8900-b333-42d0-b7fb-347abc3f0b5c"===(null===L||void 0===L?void 0:L.id)||"57436bed-c176-4625-96af-aaeec88cdc90"===(null===L||void 0===L?void 0:L.id)?"":null===L||void 0===L?void 0:L.id;t((0,d.BsN)({projectId:A,userId:e}))}}),[t,A,null===L||void 0===L?void 0:L.id]);const{networkProjects:U}=(0,y.f)(),{networkData:_}=(0,a.useMemo)((()=>{var e;return{networkData:(null===U||void 0===U||null===(e=U.networkProjectsObject)||void 0===e?void 0:e.rows)||[]}}),[U]),{networkLevelParents:R}=(0,y.f)(),{networkLevelParentsData:M}=(0,a.useMemo)((()=>{var e,t;return{networkLevelParentsData:(null===(e=R.networkLevelParentsObject)||void 0===e||null===(t=e.rows)||void 0===t?void 0:t.map((e=>({id:e.id,name:`${e.name} - ${e.id}`}))))||[],isLoading:R.loading||!1}}),[R]),V=(e,t,r,a,n,d)=>(0,j.jsx)(s.A,{children:(0,j.jsx)(h.eu,{name:e,label:t,onChange:a,InputLabelProps:{shrink:!0},menus:r,...n&&{required:!0},...o||l?{disable:d}:{}})}),F=function(e,t,r,a){let n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return(0,j.jsx)(s.A,{spacing:1,children:(0,j.jsx)(h.o3,{name:e,type:r,label:t,InputLabelProps:{shrink:n},...a&&{required:!0},...o?{disabled:!0}:l?{disabled:!1}:{}})})};return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(h.Op,{methods:N,onSubmit:D((async e=>{if(x){let o;if(o=l?await(0,m.default)("/network-level-entry-update",{method:"PUT",body:e,params:r.id}):await(0,m.default)("/network-level-entry-form",{method:"POST",body:e}),o.success){const e=l?"Level Entry updated successfully!":"Level Entry added successfully!";(0,b.A)(e,{variant:"success",autoHideDuration:1e4}),w(),P()}else{var t,a;(0,b.A)((null===(t=o)||void 0===t||null===(a=t.error)||void 0===a?void 0:a.message)||"Operation failed. Please try again.",{variant:"error"})}}else(0,b.A)("Please use GAA level entry form for mapping column.",{variant:"warning"})})),children:(0,j.jsxs)(f.A,{title:(o?"View ":l?"Update ":"Add ")+"Network Level Entry",sx:{mb:2},children:[(0,j.jsxs)(i.Ay,{container:!0,spacing:4,alignItems:"center",children:[(0,j.jsx)(i.Ay,{item:!0,md:3,xl:2,children:V("projectId","Project Name",C,(e=>{var t;I(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)}),!0,!0)}),(0,j.jsx)(i.Ay,{item:!0,md:3,xl:2,children:V("gaaHierarchyId","Level Name",_,(e=>{var r;k(null===e||void 0===e||null===(r=e.target)||void 0===r?void 0:r.value);const a=_.find((t=>{var r;return t.rank+1==(null===(r=e.target)||void 0===r?void 0:r.rank)}));S(null===a||void 0===a?void 0:a.name),E(null===a||void 0===a?void 0:a.id),t((0,d.kBO)({listType:1,networkId:null===a||void 0===a?void 0:a.id}))}),!0,!0)}),x&&(0,j.jsx)(i.Ay,{item:!0,md:6,xl:4,children:V("parentId",`Select ${x}`,M,!0,!0)}),(0,j.jsx)(i.Ay,{item:!0,md:3,xl:2,children:V("approvalStatus","Select Status",H,(e=>{var t;O("approvalStatus",null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)}),!0,"577b8900-b333-42d0-b7fb-347abc3f0b5c"!==(null===L||void 0===L?void 0:L.id)&&"57436bed-c176-4625-96af-aaeec88cdc90"!==(null===L||void 0===L?void 0:L.id))}),(0,j.jsx)(i.Ay,{item:!0,md:3,xl:2,children:F("name","Entry Name","text",!0,!1)}),(0,j.jsx)(i.Ay,{item:!0,md:3,xl:2,children:F("code","Entry Code","text",!0,!1)})]}),(0,j.jsx)(i.Ay,{container:!0,spacing:2,alignItems:"end",sx:{mt:1},children:(0,j.jsx)(i.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px"},children:o?(0,j.jsx)(c.A,{onClick:z,size:"small",variant:"outlined",color:"primary",children:"Back"}):l?(0,j.jsxs)(i.Ay,{item:!0,sx:{display:"flex",gap:"20px"},children:[(0,j.jsx)(c.A,{size:"small",type:"submit",variant:"contained",color:"primary",children:"Update"}),(0,j.jsx)(c.A,{onClick:z,size:"small",variant:"outlined",color:"primary",children:"Back"})]}):(0,j.jsx)(i.Ay,{item:!0,sx:{display:"flex",gap:"20px"},children:(0,j.jsx)(c.A,{size:"small",type:"submit",variant:"contained",color:"primary",children:"Save"})})})})]})})})};var x=r(99635),A=r(64499),I=r(89649),S=r(39225),k=r(30423),P=r(65920),E=r(52867),C=r(33507);const L=()=>{const{paginations:{pageSize:e,pageIndex:t,forceUpdate:r},refreshPagination:s,setPageIndex:i,setPageSize:c}=(0,I.A)(),u=(0,n.wA)(),[v,p]=(0,a.useState)(""),[h,f]=(0,a.useState)(""),[g,L]=(0,a.useState)(!1),[N,H]=(0,a.useState)(!1),[D,O]=(0,a.useState)(!1),[B,T]=(0,a.useState)(null),[z,U]=(0,a.useState)(null),[_,R]=(0,a.useState)(null),[M,V]=(0,a.useState)(1),[F,$]=(0,a.useState)(null),[q,G]=(0,a.useState)(!1),[Z,J]=(0,a.useState)(!1),[K,Q]=(0,a.useState)(null),[W,Y]=(0,a.useState)(),[X,ee]=(0,a.useState)(null),{user:te}=(0,C.A)(),{searchString:re,forceSearch:ae,accessorsRef:oe,setAccessors:ne,setSearchString:de,searchStringTrimmed:le}=(0,S.A)();(0,a.useEffect)((()=>{u((0,d.uiG)())}),[u]),(0,a.useEffect)((()=>{null!==B&&void 0!==B&&B.id&&u((0,d.PuZ)({pageIndex:t,pageSize:e,listType:M,recordId:null===B||void 0===B?void 0:B.id}))}),[u,t,e,r,M,B]);const{filterObjectForApi:se}=(0,k.bZ)(),ie=(0,P.A)(se),ce=(0,P.A)(K);(0,a.useEffect)((()=>{[[ie,se],[ce,K]].some(E.$H)?s():v&&u((0,d.Bc7)({pageIndex:t,pageSize:e,listType:M,networkId:v,...le&&{searchString:le,accessors:JSON.stringify(oe.current)},sortBy:null===K||void 0===K?void 0:K[0],sortOrder:null===K||void 0===K?void 0:K[1],filterObject:se}))}),[u,t,e,M,v,r,K,le,oe,ae,ie,se,ce,s]);const{projectsDropdown:ue}=(0,l.Y)(),ve=null===ue||void 0===ue?void 0:ue.projectsDropdownObject,{networkLevelProjects:pe,networkLevelEntryHistory:me}=(0,y.f)(),{networkLevelData:ye,networkCount:he}=(0,a.useMemo)((()=>{var e,t;return{networkLevelData:(null===(e=pe.networkLevelProjectsObject)||void 0===e?void 0:e.rows)||[],networkCount:(null===(t=pe.networkLevelProjectsObject)||void 0===t?void 0:t.count)||0,isLoading:pe.loading||!1}}),[pe]),{historyLevelEntryData:fe,historyLevelEntryCounts:ge}=(0,a.useMemo)((()=>{var e,t;return{historyLevelEntryData:(null===(e=me.networkLevelEntryHistoryObject)||void 0===e?void 0:e.rows)||[],historyLevelEntryCounts:(null===(t=me.networkLevelEntryHistoryObject)||void 0===t?void 0:t.count)||0,isLoading:me.loading||!1}}),[me]),be=(0,a.useMemo)((()=>[{Header:"Entry ID",accessor:"id",filterProps:{tableName:"networkEntry",getColumn:"id",customAccessor:"id",projectId:X,levelId:v}},{Header:"Entry Name",accessor:"name",filterProps:{tableName:"networkEntry",getColumn:"name",customAccessor:"name",projectId:X,levelId:v}},{Header:"Entry Code",accessor:"code",filterProps:{tableName:"networkEntry",getColumn:"code",customAccessor:"code",projectId:X,levelId:v}},{Header:"Parent ID",accessor:e=>{var t;return null===(t=e.parent)||void 0===t?void 0:t.id},exportAccessor:"parent.id",filterProps:{tableName:"networkEntry",getColumn:"parent_id",customAccessor:"parentId",projectId:X,levelId:v}},{Header:"Parent Name",accessor:e=>{var t;return null===(t=e.parent)||void 0===t?void 0:t.name},exportAccessor:"parent.name",filterProps:{tableName:"networkEntry",getColumn:"name",customAccessor:"parentName",projectId:X,levelId:h}},{Header:"Status",accessor:"approvalStatus",exportAccessor:"approval_status",filterProps:{tableName:"networkEntry",getColumn:"approval_status",customAccessor:"approvalStatus",projectId:X,levelId:v}},{Header:"Updated On",accessor:"updatedAt"},{Header:"Updated By",accessor:"updated.name",filterProps:{tableName:"networkEntry",getColumn:"updated_by",customAccessor:"updatedBy",projectId:X,levelId:v}},{Header:"Created On",accessor:"createdAt"},{Header:"Created By",accessor:"created.name",filterProps:{tableName:"networkEntry",getColumn:"created_by",customAccessor:"createdBy",projectId:X,levelId:v}}]),[v,X,h]),je=()=>{G(!1),J(!1),$(null)};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(w,{refreshPagination:s,selectedProject:X,setSelectedProject:ee,setSelectedNetworkId:p,selectedParentId:h,selectedNetworkId:v,setRefresh:je,selectedParent:W,setSelectedParent:Y,setSelectedParentId:f,projectData:ve,user:te,...F&&{data:F},...q&&{view:q,update:!1},...Z&&{update:Z,view:!1}}),v&&(0,j.jsx)(x.default,{hideAddButton:!0,hideImportButton:!1,data:ye,columns:be,count:he,setPageIndex:i,setPageSize:c,pageIndex:t,pageSize:e,handleRowRestore:async e=>{R(e),H(!0)},handleRowDelete:async e=>{U(e),L(!0)},handleRowUpdate:e=>{J(!0),G(!1),$(e)},handleRowHistory:e=>{T(e),O(!0)},handleRowView:e=>{G(!0),J(!1),$(e)},listType:M,setListType:e=>{V(e),je()},sortConfig:{sort:K,setSort:Q},searchConfig:{searchString:re,searchStringTrimmed:le,setSearchString:de,setAccessors:ne},importConfig:{apiBody:{projectId:X,levelId:v,parentId:h,tableName:"gaa_level_entries"}},setSelectedParentId:f,exportConfig:{tableName:"network_level_entries",fileName:"network-level-entry",apiQuery:{listType:M,networkId:v,filterObject:se}},disableDeleteIcon:"577b8900-b333-42d0-b7fb-347abc3f0b5c"!==(null===te||void 0===te?void 0:te.id)&&"57436bed-c176-4625-96af-aaeec88cdc90"!==(null===te||void 0===te?void 0:te.id),componentFrom:"network-level-entry"}),(0,j.jsx)(A.A,{open:g,handleClose:()=>L(!1),handleConfirm:async()=>{const e=await(0,m.default)("/delete-network-level-entry",{method:"DELETE",params:z});var t;e.success?(s(),L(!1)):(0,b.A)(null===e||void 0===e||null===(t=e.error)||void 0===t?void 0:t.message)},title:"Confirm Delete",message:"Are you sure you want to delete?",confirmBtnTitle:"Delete"}),(0,j.jsx)(A.A,{open:N,handleClose:()=>H(!1),handleConfirm:async()=>{const e={..._,isActive:"1"};(await(0,m.default)("/network-level-entry-update",{method:"PUT",body:e,params:e.id})).success&&(s(),H(!1))},title:"Confirm Restore",message:"Are you sure you want to restore?",confirmBtnTitle:"Restore"}),(0,j.jsx)(o.A,{open:D,onClose:()=>O(!1),scroll:"paper",disableEscapeKeyDown:!0,maxWidth:"lg",children:(0,j.jsx)(x.default,{isHistory:!0,title:null===B||void 0===B?void 0:B.name,data:fe,columns:be,count:ge,hideActions:!0,hideSearch:!0,hideAddButton:!0,hideExportButton:!0,setPageIndex:i,setPageSize:c,pageIndex:t,pageSize:e})})]})}}}]);