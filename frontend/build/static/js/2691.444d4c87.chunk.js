"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[2691,5406],{64499:(e,t,r)=>{r.d(t,{A:()=>f});var s=r(9950),a=r(65669),i=r(43263),o=r(57191),l=r(95537),n=r(67535),c=r(87233),d=r(44414);f.defaultProps={title:"Confirm Action",message:"Are you sure to perform this action",closeBtnTitle:"Cancel",confirmBtnTitle:"Ok"};const u={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:350,bgcolor:"background.paper",borderRadius:"10px",p:3},m={display:"flex",flexDirection:"row",padding:"15px 0"},p={display:"flex",justifyContent:"flex-end",gap:2},j={marginTop:2,display:"flex",fontSize:"14px"};function f(e){let{open:t,handleClose:r,title:f,message:v,closeBtnTitle:x,confirmBtnTitle:h,handleConfirm:g,confirmColor:b}=e;const[y,A]=(0,s.useState)(null);return(0,s.useEffect)((()=>{A(null)}),[t]),(0,d.jsx)("div",{children:(0,d.jsx)(a.A,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:t,closeAfterTransition:!0,slots:{backdrop:i.A},slotProps:{backdrop:{timeout:500}},children:(0,d.jsx)(o.A,{in:t,children:(0,d.jsxs)(l.A,{sx:u,children:[(0,d.jsx)(c.A,{id:"transition-modal-title",variant:"h4",children:f}),(0,d.jsx)(c.A,{id:"transition-modal-title",variant:"h6",sx:m,children:v}),(0,d.jsxs)(l.A,{sx:p,children:[!!r&&(0,d.jsx)(n.A,{onClick:r,size:"small",variant:"outlined",color:"primary",children:x}),!!g&&(0,d.jsx)(n.A,{onClick:g,size:"small",variant:"contained",color:b||"error",children:h})]}),y&&(0,d.jsx)(c.A,{variant:"p",color:"red",sx:j,children:y})]})})})})}},89649:(e,t,r)=>{r.d(t,{A:()=>i});var s=r(9950),a=r(80415);function i(){const[e,t]=(0,s.useState)({pageIndex:a.j7.pageIndex,pageSize:a.j7.pageSize,forceUpdate:!0}),r=(0,s.useCallback)((function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.pageIndex,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.pageSize;t((e=>({pageIndex:r,pageSize:s,forceUpdate:!e.forceUpdate})))}),[e]),i=(0,s.useCallback)((()=>{t((e=>({pageIndex:a.j7.pageIndex,pageSize:a.j7.pageSize,forceUpdate:!e.forceUpdate})))}),[]);return{paginations:e,setPageIndex:e=>t((t=>({...t,pageIndex:e,forceUpdate:!t.forceUpdate}))),setPageSize:e=>t((t=>({pageIndex:a.j7.pageIndex,pageSize:e,forceUpdate:!t.forceUpdate}))),refreshPagination:i,setPaginationsFunctions:r}}},60209:(e,t,r)=>{r.d(t,{k:()=>i});var s=r(9950),a=r(27081);const i=()=>{const[e,t]=(0,s.useState)({projectMasterMakerLovsObject:{},error:"",loading:!0}),[r,i]=(0,s.useState)({projectMasterMakersListObject:[],error:"",loading:!0}),[o,l]=(0,s.useState)({projectMasterMakerLovHistoryObject:{},error:"",loading:!0}),n=(0,a.d4)((e=>e.projectMasterMakerLov||{})),c=(0,a.d4)((e=>e.masterMakersLovsList||{})),d=(0,a.d4)((e=>e.projectMasterMakerLovHistory||{}));return(0,s.useEffect)((()=>{t((e=>({...e,...n})))}),[n]),(0,s.useEffect)((()=>{i((e=>({...e,...c})))}),[c]),(0,s.useEffect)((()=>{l((e=>({...e,...d})))}),[d]),{projectMasterMakerLovs:e,masterMakersLovsList:r,projectMasterMakerLovHistory:o}}},23882:(e,t,r)=>{r.d(t,{j:()=>i});var s=r(9950),a=r(27081);const i=()=>{const[e,t]=(0,s.useState)({projectMasterMakerObject:{},error:"",loading:!0}),[r,i]=(0,s.useState)({masterMakerProjectsObject:[],error:"",loading:!0}),[o,l]=(0,s.useState)({projectMasterMakerHistoryObject:{},error:"",loading:!0}),n=(0,a.d4)((e=>e.projectMasterMaker||{})),c=(0,a.d4)((e=>e.masterMakerProjects||{})),d=(0,a.d4)((e=>e.projectMasterMakerHistory||{}));return(0,s.useEffect)((()=>{t((e=>({...e,...n})))}),[n]),(0,s.useEffect)((()=>{i((e=>({...e,...c})))}),[c]),(0,s.useEffect)((()=>{l((e=>({...e,...d})))}),[d]),{projectMasterMakers:e,masterMakerProjects:r,projectMasterMakerHistory:o}}},80733:(e,t,r)=>{r.d(t,{Y:()=>i});var s=r(9950),a=r(27081);const i=()=>{const[e,t]=(0,s.useState)({projectsObject:{},error:"",loading:!0}),[r,i]=(0,s.useState)({projectDetailsObject:{},error:"",loading:!0}),[o,l]=(0,s.useState)({projectsDropdownObject:[],error:"",loading:!0}),[n,c]=(0,s.useState)({projectsDropdownObject:[],error:"",loading:!0}),[d,u]=(0,s.useState)({projectsObject:[],error:"",loading:!0}),[m,p]=(0,s.useState)({projectsHistoryObject:{},error:"",loading:!0}),j=(0,a.d4)((e=>e.projects||{})),f=(0,a.d4)((e=>e.projectDetails||{})),v=(0,a.d4)((e=>e.projectsDropdown||[])),x=(0,a.d4)((e=>e.allProjectsDropdown||[])),h=(0,a.d4)((e=>e.projectsForRoleOrUser||[])),g=(0,a.d4)((e=>e.projectsHistory||{}));return(0,s.useEffect)((()=>{t((e=>({...e,...j})))}),[j]),(0,s.useEffect)((()=>{i((e=>({...e,...f})))}),[f]),(0,s.useEffect)((()=>{l((e=>({...e,...v})))}),[v]),(0,s.useEffect)((()=>{c((e=>({...e,...x})))}),[x]),(0,s.useEffect)((()=>{u((e=>({...e,...h})))}),[h]),(0,s.useEffect)((()=>{p((e=>({...e,...g})))}),[g]),{projects:e,projectsDropdown:o,allProjectsDropdown:n,projectsHistory:m,projectsGovernForRoleOrUser:d,projectDetails:r}}},66004:(e,t,r)=>{r.d(t,{k:()=>a});var s=r(27081);const a=()=>({users:(0,s.d4)((e=>e.users)),usersByPermission:(0,s.d4)((e=>e.usersByPermission)),usersWithForms:(0,s.d4)((e=>e.usersWithForms)),usersSecond:(0,s.d4)((e=>e.usersSecond)),usersHistory:(0,s.d4)((e=>e.usersHistory)),supervisorUsers:(0,s.d4)((e=>e.supervisorUsers))})},41137:(e,t,r)=>{r.d(t,{c:()=>i});var s=r(9950),a=r(27081);const i=()=>{const[e,t]=(0,s.useState)({ticketEmailTemplates:{},error:"",loading:!0}),r=(0,a.d4)((e=>e.ticketEmailTemplates||{}));return(0,s.useEffect)((()=>{t((e=>({...e,...r})))}),[r]),{templateList:e}}},59820:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var s=r(9950),a=r(27081),i=r(4139),o=r(67535),l=r(87233),n=r(96583),c=r(95537),d=r(14341),u=r(9449),m=r(41137),p=r(14351),j=r(80733),f=r(96951),v=r(29024),x=r(23882),h=r(60209),g=r(66004),b=r(62054),y=r(71826),A=r(44414);function k(e){let t=e.match(/(\d+)|([a-zA-Z]+)/g);return t=t||[],t}function M(e){const t={w:5,d:4,h:3,m:2,s:1},r=e.trim().split(" ");if(r.length>Object.keys(t).length)return!1;let s=Math.min();for(let a of r){const e=k(a);if(2!==e.length)return!1;if(!t[e[1]])return!1;if(!(s>t[e[1]]))return!1;s=t[e[1]]}return!0}const S=e=>{var t,r;let{edit:k,rowData:S,onBack:w}=e;const I=(0,a.wA)(),[E,C]=(0,s.useState)(1),[T,O]=(0,s.useState)(!1),{projectsDropdown:z}=(0,j.Y)(),L=null===z||void 0===z?void 0:z.projectsDropdownObject,{projectMasterMakers:P}=(0,x.j)(),D=(0,s.useMemo)((()=>{var e;return(null===P||void 0===P||null===(e=P.projectMasterMakerObject)||void 0===e?void 0:e.rows)||[]}),[P]),{projectMasterMakerLovs:H}=(0,h.k)(),U=(0,s.useMemo)((()=>{var e;return(null===H||void 0===H||null===(e=H.projectMasterMakerLovsObject)||void 0===e?void 0:e.rows)||[]}),[H]),{users:B}=(0,g.k)(),$=(null===B||void 0===B||null===(t=B.usersObject)||void 0===t?void 0:t.rows)||[],{templateList:q}=(0,m.c)(),F=(0,s.useMemo)((()=>{var e;return(null===q||void 0===q||null===(e=q.ticketEmailTemplates)||void 0===e?void 0:e.rows)||[]}),[q]),R=(0,u.mN)({defaultValues:{},mode:"all"}),{handleSubmit:V,setValue:Y}=R;(0,s.useEffect)((()=>{I((0,v.wMU)()),I((0,v.TS7)()),I((0,v.uiG)()),I((0,v.Uhy)())}),[I]),(0,s.useEffect)((()=>{if(S){var e;C((null===S||void 0===S||null===(e=S.levels)||void 0===e?void 0:e.length)||0),Y("projectId",S.projectId),Y("emailTemplateId",S.emailTemplateId);const{levels:t}=S;t.forEach(((e,t)=>{Y(`time${t}`,e.time),Y(`to${t}`,e.to),Y(`cc${t}`,e.cc)}))}}),[Y,C,S]);const N=R.watch("projectId");(0,s.useEffect)((()=>{N&&I((0,v.loF)({projectId:N}))}),[I,N]);const W=R.watch("emailTemplateId");(0,s.useEffect)((()=>{if(W){const[e]=F.filter((e=>e.id===W));if(!e)return;const t=D.filter((t=>{var r;return null===e||void 0===e||null===(r=e.issueIds)||void 0===r?void 0:r.includes(t.id)})),r=U.filter((t=>{var r;return null===e||void 0===e||null===(r=e.subIssueIds)||void 0===r?void 0:r.includes(t.id)}));Y("issues",t.map((e=>e.id))),Y("sub-issues",r.map((e=>e.id)))}}),[W,U,D,F,Y]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(f.Op,{methods:R,onSubmit:V((async e=>{const t={};for(let i=0;i<E;i++){const r=e[`time${i}`],s=e[`to${i}`],a=e[`cc${i}`];let o=null;if(r?M(r)?s.length?a.length||(o="CC list cannot be empty"):o="To list cannot be empty":o="Invalid time format":o="Time is required",o)return void(0,b.A)(o+` in Level ${i+1}`,{variant:"error"});t[i]={time:r,to:s,cc:a}}let r={projectId:e.projectId,emailTemplateId:e.emailTemplateId,levels:t};if(S){const s=Object.keys(t).map((e=>{const r=t[e],s=e;return S.levels[s]?{...S.levels[s],to:r.to,cc:r.cc,time:r.time}:{isNew:!0,...r}}));if(s.length<S.levels.length){const e=s.length;[...Array(S.levels.length-s.length)].map(((t,r)=>{s.push({isDeleted:!0,id:S.levels[e+r].id})}))}r={...S,emailTemplateId:e.emailTemplateId,levels:s}}const s=await(0,y.default)(k?"/escalation-matrix-update":"/escalation-matrix-create",{method:k?"PUT":"POST",body:r,params:null===S||void 0===S?void 0:S.id});var a;s.success?((0,b.A)("Successfully created escalation matrix.",{variant:"success",autoHideDuration:1e4}),w(!0)):(0,b.A)((null===s||void 0===s||null===(a=s.error)||void 0===a?void 0:a.message)||"Operation failed. Please try again.",{variant:"error"})})),children:(0,A.jsxs)(p.A,{title:k?"Edit Escalation":S?"View Escalation":"Create Escalation",children:[(0,A.jsxs)(i.Ay,{container:!0,rowSpacing:3,columnSpacing:2,sx:{mb:2},children:[(0,A.jsx)(i.Ay,{item:!0,xs:3,children:(0,A.jsx)(f.eu,{name:"projectId",label:"Project",InputLabelProps:{shrink:!0},menus:L,onChange:()=>{Y("emailTemplateId",""),Y("issues",[]),Y("sub-issues",[])},disable:!!S,allowClear:!0,required:!0})}),(0,A.jsx)(i.Ay,{item:!0,xs:3,children:(0,A.jsx)(f.eu,{name:"emailTemplateId",label:"Email Template",InputLabelProps:{shrink:!0},menus:F.filter((e=>e.projectId===R.watch("projectId"))).map((e=>({id:e.id,name:e.templateName}))),disable:!k&&S,allowClear:!0,required:!0})}),(0,A.jsx)(i.Ay,{item:!0,xs:6,sx:{display:"flex",alignItems:"flex-start",justifyContent:"flex-end"},children:(0,A.jsx)(o.A,{size:"small",variant:"outlined",onClick:()=>{O(!0)},disabled:!R.watch("emailTemplateId"),children:"Email Body"})}),(0,A.jsx)(i.Ay,{item:!0,xs:6,children:(0,A.jsx)(f.Yq,{name:"issues",label:"Issue",disable:!0,menus:D.map((e=>({id:e.id,name:e.name}))),required:!0})}),(0,A.jsx)(i.Ay,{item:!0,xs:6,children:(0,A.jsx)(f.Yq,{name:"sub-issues",label:"Sub-Issue",disable:!0,menus:U.map((e=>({id:e.id,name:e.name}))),required:!0})})]}),(0,A.jsx)(l.A,{color:"error",sx:{mb:2},children:'Note: Time format should be similar to "2w 3d 4h 5m 6s" where "w" is week, "d" is day, "h" is hours, "m" is minutes, and "s" is\n            seconds.'}),[...Array(E).keys()].map((e=>(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(i.Ay,{sx:{mb:1},container:!0,rowSpacing:1,columnSpacing:2,alignItems:"center",children:[(0,A.jsxs)(i.Ay,{item:!0,xs:12,display:"flex",alignItems:"center",gap:"20px",children:[(0,A.jsx)(l.A,{variant:"h4",children:`Level ${e+1}`}),e===E-1&&0!==e&&(k&&S||!k&&!S)&&(0,A.jsx)(o.A,{size:"small",color:"error",onClick:()=>{R.unregister(`time${e}`),R.unregister(`to${e}`),R.unregister(`cc${e}`),C((e=>e-1))},children:"Remove"})]}),(0,A.jsx)(i.Ay,{item:!0,xs:3,children:(0,A.jsx)(f.o3,{name:`time${e}`,disabled:!k&&S,label:"Time"})})]},e),(0,A.jsxs)(i.Ay,{container:!0,sx:{mb:2},rowSpacing:1,columnSpacing:2,alignItems:"center",children:[(0,A.jsx)(i.Ay,{item:!0,xs:6,children:(0,A.jsx)(f.Yq,{disable:!k&&S,name:`to${e}`,label:"To",menus:$,required:!0})}),(0,A.jsx)(i.Ay,{item:!0,xs:6,children:(0,A.jsx)(f.Yq,{disable:!k&&S,name:`cc${e}`,label:"CC",menus:$,required:!0})})]})]}))),(0,A.jsx)(i.Ay,{container:!0,sx:{mt:2},children:(0,A.jsxs)(i.Ay,{item:!0,xs:12,display:"flex",justifyContent:"flex-end",gap:"20px",children:[(0,A.jsx)(o.A,{variant:"outlined",size:"small",color:"primary",onClick:w,children:"Back"}),(k&&S||!k&&!S)&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(o.A,{variant:"outlined",size:"small",color:"primary",onClick:()=>{C((e=>e+1))},children:"Add Level"}),(0,A.jsx)(o.A,{variant:"contained",size:"small",color:"primary",type:"submit",children:"Save"})]})]})})]})}),(0,A.jsx)(n.A,{open:T,onClose:()=>{O(!1)},fullWidth:!0,children:(0,A.jsx)(c.A,{sx:{width:"100%",padding:2},children:(0,A.jsx)(d.A,{multiline:!0,fullWidth:!0,value:(null===(r=F.filter((e=>e.id===R.watch("emailTemplateId")))[0])||void 0===r?void 0:r.body)||""})})})]})};var w=r(99635),I=r(64499),E=r(89649);const C=[{Header:"Project",accessor:"project.name"},{Header:"Email Template",accessor:"ticket_email_template.templateName"}],T=()=>{var e,t;const{paginations:{pageSize:r,pageIndex:i},setPageIndex:o,setPageSize:l}=(0,E.A)(),n=(0,a.wA)(),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(),[p,j]=(0,s.useState)(!1),[f,x]=(0,s.useState)(!1),h=(0,s.useRef)(),{escalationMatrix:g}=(()=>{const[e,t]=(0,s.useState)({escalationMatrixObject:void 0,error:"",loading:!0}),r=(0,a.d4)((e=>e.escalationMatrix));return(0,s.useEffect)((()=>{t((e=>({...e,...r})))}),[r]),{escalationMatrix:e}})(),k=(null===g||void 0===g||null===(e=g.escalationMatrixObject)||void 0===e?void 0:e.rows)||[],M=(null===g||void 0===g||null===(t=g.escalationMatrixObject)||void 0===t?void 0:t.count)||0,T=(0,s.useCallback)((()=>{n((0,v.BB9)({pageIndex:i,pageSize:r}))}),[n,i,r]);return(0,s.useEffect)((()=>{T()}),[T]),(0,A.jsxs)(A.Fragment,{children:[c?(0,A.jsx)(S,{rowData:u,edit:p,onBack:e=>{d(!1),j(!1),m(),e&&T()}}):(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(w.default,{title:"Configured Escalation List",setPageIndex:o,setPageSize:l,pageIndex:i,pageSize:r,data:k,columns:C,count:M,hideHistoryIcon:!0,hideExportButton:!0,onClick:()=>{d(!0)},handleRowDelete:e=>{h.current=e,x(!0)},handleRowUpdate:e=>{j(!0),m(e),d(!0)},handleRowView:e=>{m(e),d(!0)}})}),f&&(0,A.jsx)(I.A,{open:f,handleClose:()=>x(!1),handleConfirm:async()=>{const e=await(0,y.default)("/delete-escalation-matrix",{method:"DELETE",params:h.current});var t;e.success?(x(!1),T(),(0,b.A)("Successfully deleted selected escalation matrix",{variant:"success",autoHideDuration:1e4})):(0,b.A)((null===e||void 0===e||null===(t=e.error)||void 0===t?void 0:t.message)||"Operation failed. Please try again.",{variant:"error"})},title:"Confirm Delete",message:"Are you sure you want to delete?",confirmBtnTitle:"Delete"})]})}},13239:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(89379),a=r(9950);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"};var o=r(14840),l=function(e,t){return a.createElement(o.A,(0,s.A)((0,s.A)({},e),{},{ref:t,icon:i}))};const n=a.forwardRef(l)},26592:(e,t,r)=>{var s=r(24994);t.A=void 0;var a=s(r(79526)),i=r(44414);t.A=(0,a.default)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline")},36089:(e,t,r)=>{var s=r(24994);t.A=void 0;var a=s(r(79526)),i=r(44414);t.A=(0,a.default)((0,i.jsx)("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92zM17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29m-3.6 3.19L3 17.25V21h3.75L17.81 9.94z"}),"EditOutlined")}}]);