"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[975],{15999:(e,a,r)=>{r.d(a,{A:()=>g});var s=r(9950),t=r(80678),n=r(41787),o=r(81831),l=r(72145),i=r(12257),d=r(87233),u=r(14341),c=r(94641),p=r(9449),m=r(43974),v=r(30545),I=r(19673),f=r(22580),y=r(44414);const g=e=>{let{name:a,label:r,onChange:g,disabled:h,required:x=!1,...j}=e;const{control:S}=(0,p.xW)(),{errorMessage:_,timeFormat:b,pickerType:A,minDate:M,maxDate:w,setInsideErrors:D}=j,C=e=>(0,m.A)(new Date(e).getTime()-198e5,"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"),H=(0,s.useCallback)((e=>{let a="";return w&&e>new Date(`${w}T23:59:00Z`)?a=`Maximum date should be ${(0,m.A)(new Date(w),"dd/MM/yyyy")}`:e<new Date(`${M}`)&&(a=`Minimum date should be ${(0,m.A)(new Date(M),"dd/MM/yyyy")}`),a}),[M,w]),T=(0,s.useRef)();return(0,s.useEffect)((()=>{if(T.current)T.current=!1;else{var e,r,s;if(null!==S&&void 0!==S&&null!==(e=S._fields)&&void 0!==e&&null!==(r=e[a])&&void 0!==r&&null!==(s=r._f)&&void 0!==s&&s.value){var t,n,o;let e=H(new Date(null===S||void 0===S||null===(t=S._fields)||void 0===t||null===(n=t[a])||void 0===n||null===(o=n._f)||void 0===o?void 0:o.value));e&&D&&D((r=>({...r,[a]:e})))}T.current=!0}}),[a,S,H,D]),(0,y.jsx)(o.$,{dateAdapter:n.h,children:(0,y.jsx)(p.xI,{name:a,control:S,defaultValue:null,render:e=>{var s;let{field:n,formState:{errors:o}}=e;return(0,y.jsx)(l.A,{fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:o[a]?"#ff4d4f":""}}},children:(0,y.jsxs)(i.A,{spacing:1,children:[(0,y.jsxs)(d.A,{children:[r,x&&!(null!==r&&void 0!==r&&r.includes(" *"))&&" *"]}),"dateTimeBoth"===A?(0,y.jsx)(t.K,{...n,disabled:h,value:n.value?new Date(n.value):null,onChange:e=>{if(e){let r=H(e);D&&D((e=>({...e,[a]:r})))}const r=C(e);g&&"function"===typeof g&&g(r),n.onChange(r)},format:"12hour"===b?"dd/MM/yyyy hh:mm a":"dd/MM/yyyy HH:mm",renderInput:e=>(0,y.jsx)(u.A,{...e}),ampm:"12hour"===b}):"dateOnly"===A?(0,y.jsx)(v.T,{inputFormat:"dd/MM/yyyy",value:n.value?new Date(n.value):null,onChange:e=>{if(e){let r=H(e);D&&D((e=>({...e,[a]:r})))}const r=C(e);g&&"function"===typeof g&&g(r),n.onChange(r)},renderInput:e=>(0,y.jsx)(u.A,{...e})}):"monthYearBoth"===A?(0,y.jsx)(I.l,{inputFormat:"MM-yyyy",views:["month","year"],value:n.value?new Date(n.value):null,onChange:e=>{if(e){let r=H(e);D&&D((e=>({...e,[a]:r})))}const r=C(e);g&&"function"===typeof g&&g(r),n.onChange(r)},renderInput:e=>(0,y.jsx)(u.A,{...e})}):(0,y.jsx)(f.A,{value:n.value?new Date(n.value):null,onChange:e=>{const a=C(e);g&&"function"===typeof g&&g(a),n.onChange(a)},renderInput:e=>(0,y.jsx)(u.A,{...e}),ampm:"12hour"===b}),(0,y.jsx)(c.A,{sx:{position:"absolute",top:60,left:3,color:"#ff4d4f"},children:(null===(s=o[a])||void 0===s?void 0:s.message)||_})]})})}})})}},89649:(e,a,r)=>{r.d(a,{A:()=>n});var s=r(9950),t=r(80415);function n(){const[e,a]=(0,s.useState)({pageIndex:t.j7.pageIndex,pageSize:t.j7.pageSize,forceUpdate:!0}),r=(0,s.useCallback)((function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.pageIndex,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.pageSize;a((e=>({pageIndex:r,pageSize:s,forceUpdate:!e.forceUpdate})))}),[e]),n=(0,s.useCallback)((()=>{a((e=>({pageIndex:t.j7.pageIndex,pageSize:t.j7.pageSize,forceUpdate:!e.forceUpdate})))}),[]);return{paginations:e,setPageIndex:e=>a((a=>({...a,pageIndex:e,forceUpdate:!a.forceUpdate}))),setPageSize:e=>a((a=>({pageIndex:t.j7.pageIndex,pageSize:e,forceUpdate:!a.forceUpdate}))),refreshPagination:n,setPaginationsFunctions:r}}},66004:(e,a,r)=>{r.d(a,{k:()=>t});var s=r(27081);const t=()=>({users:(0,s.d4)((e=>e.users)),usersByPermission:(0,s.d4)((e=>e.usersByPermission)),usersWithForms:(0,s.d4)((e=>e.usersWithForms)),usersSecond:(0,s.d4)((e=>e.usersSecond)),usersHistory:(0,s.d4)((e=>e.usersHistory)),supervisorUsers:(0,s.d4)((e=>e.supervisorUsers))})},975:(e,a,r)=>{r.r(a),r.d(a,{default:()=>M});var s=r(9449),t=r(4139),n=r(67535),o=r(15999),l=r(60666),i=r(26473),d=r(27081),u=r(9950),c=r(28429),p=r(40761),m=r(96951),v=r(14351),I=r(84601),f=r(29024),y=r(80733),g=r(66004),h=r(71826),x=r(62054),j=r(99635),S=r(89649),_=r(44414);const b=[{Header:"Customer",accessor:"Organizations - Customer__name"},{Header:"Project",accessor:"Projects__name"},{Header:"Material Type",accessor:"Master Maker Lovs - Material Type__name"},{Header:"Supervisor Name",accessor:"Users - Supervisor__name"},{Header:"Supervisor Code",accessor:"Users - Supervisor__code"},{Header:"Installer Name",accessor:"Users - Installer__name"},{Header:"Installer Code",accessor:"Users - Installer__code"},{Header:"Item Serial No.",accessor:"Material Serial Numbers__serial_number"},{Header:"Item Issued Date",accessor:"created_at"},{Header:"Item Status",accessor:"Item Status"},{Header:"Item Installed Date",accessor:"Item Installed Date"}],A=[{Header:"Customer",accessor:"Organizations - Customer__name"},{Header:"Project",accessor:"Projects__name"},{Header:"Material Type",accessor:"Master Maker Lovs - Material Type__name"},{Header:"Installer Name",accessor:"Users - Installer__name"},{Header:"Installer Code",accessor:"Users - Installer__code"},{Header:"Item Serial No.",accessor:"Material Serial Numbers__serial_number"},{Header:"Item Issued Date",accessor:"created_at"},{Header:"Transaction Number",accessor:"reference_document_number"},{Header:"Item Status",accessor:"Item Status"},{Header:"Item Installed Date",accessor:"Item Installed Date"}],M=e=>{let{type:a}=e;const r=(0,d.wA)(),{paginations:{pageSize:M,pageIndex:w},setPageIndex:D,setPageSize:C}=(0,S.A)(),[H,T]=(0,u.useState)(),[k,P]=(0,u.useState)(!1),[U,z]=(0,u.useState)([]),[N,E]=(0,u.useState)(0),[F,O]=(0,u.useState)(!1),{projectsDropdown:q}=(0,y.Y)(),B=(0,u.useMemo)((()=>(null===q||void 0===q?void 0:q.projectsDropdownObject)||[]),[q]),{materialTypeForReport:L}=(0,p.r)(),W=(0,u.useMemo)((()=>(null===L||void 0===L?void 0:L.materialTypeArr)||[]),[L]),{supervisorUsers:Y}=(0,g.k)(),$=(0,u.useMemo)((()=>{var e;return(null===Y||void 0===Y||null===(e=Y.supervisorUsersObject)||void 0===e?void 0:e.rows)||[]}),[Y]),V=(0,s.mN)({resolver:(0,i.t)(l.Ik().shape({projectId:I.A.projectArr})),defaultValues:{},mode:"all"}),{handleSubmit:G}=V;(0,u.useEffect)((()=>{r((0,f.uiG)()),r((0,f.MZV)())}),[r]);const R=(0,u.useCallback)((async e=>{const a=await(0,h.default)("/installer-list/stock-ledger",{method:"GET",query:{projectId:e}});var r;a.success?z((null===a||void 0===a||null===(r=a.data)||void 0===r?void 0:r.data)||[]):(0,x.A)(a.message||"Something went wrong",{variant:"error"})}),[]),Z=V.watch("projectId");(0,u.useEffect)((()=>{null!==Z&&void 0!==Z&&Z.length&&("supervisor"===a?r((0,f.hCS)({projectId:Z})):"installer"===a&&R(Z))}),[r,R,Z,a]);const K=V.watch(["projectId","supervisorId","installerId","materialTypeId","fromDate","toDate"]),[Q,J,X,ee,ae,re]=K,se=(0,u.useCallback)((async()=>{if(0===(null===Q||void 0===Q?void 0:Q.length))return;P(!0);const e=await(0,h.default)("/supervisor-wise-material-report",{method:"GET",query:{projectId:Q,supervisorId:J,installerId:X,materialTypeId:ee,fromDate:ae,toDate:re,type:a,pageIndex:w,pageSize:M}});var r,s,t,n,o;(P(!1),e.success)?(T(null===e||void 0===e||null===(r=e.data)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.rows),E(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.count),O(!0)):(0,x.A)((null===e||void 0===e||null===(o=e.error)||void 0===o?void 0:o.message)||"Something went wrong",{variant:"error"})}),[Q,J,X,ee,ae,re,w,M,a]);(0,u.useEffect)((()=>{V.formState.isSubmitted&&se()}),[se,V.formState.isSubmitted]);const te=(0,c.zy)();return(0,u.useEffect)((()=>{O(!1),V.reset()}),[te.pathname,V]),(0,u.useEffect)((()=>{0===(null===Q||void 0===Q?void 0:Q.length)&&(O(!1),V.reset())}),[V,null===Q||void 0===Q?void 0:Q.length]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(m.Op,{methods:V,onSubmit:G((()=>{se()})),children:(0,_.jsx)(v.A,{title:("supervisor"===a?"Supervisor":"Installer")+" Wise Material Status Report",sx:{mb:2},children:(0,_.jsxs)(t.Ay,{container:!0,spacing:4,children:[(0,_.jsx)(t.Ay,{item:!0,md:6,children:(0,_.jsx)(m.Yq,{name:"projectId",label:"Project",InputLabelProps:{shrink:!0},menus:B,required:!0,onChange:()=>{V.setValue("supervisorId",[])}})}),(0,_.jsx)(t.Ay,{item:!0,md:6,children:(0,_.jsx)(m.Yq,{name:"supervisor"===a?"supervisorId":"installerId",label:("supervisor"===a?"Supervisor":"Installer")+" Name",InputLabelProps:{shrink:!0},menus:"supervisor"===a?$:U})}),(0,_.jsx)(t.Ay,{item:!0,md:6,children:(0,_.jsx)(m.Yq,{name:"materialTypeId",label:"Material Type",InputLabelProps:{shrink:!0},menus:W})}),(0,_.jsx)(t.Ay,{item:!0,md:3,children:(0,_.jsx)(o.A,{pickerType:"dateOnly",name:"fromDate",label:"Issued Date From"})}),(0,_.jsx)(t.Ay,{item:!0,md:3,children:(0,_.jsx)(o.A,{pickerType:"dateOnly",name:"toDate",label:"Issued Date To"})}),(0,_.jsx)(t.Ay,{item:!0,xs:12,textAlign:"right",children:(0,_.jsx)(n.A,{size:"small",variant:"contained",type:"submit",children:"Proceed"})})]})})}),F&&(0,_.jsx)(j.default,{loadingCondition:k,hideActions:!0,hideAddButton:!0,data:H||[],count:N||0,columns:"supervisor"===a?b:A,pageIndex:w,pageSize:M,setPageIndex:D,setPageSize:C,exportConfig:{tableName:"supervisor"===a?"supervisor-wise-material-status-report":"installer-wise-material-status-report",apiQuery:{projectId:Q,..."supervisor"===a?{supervisorId:J}:{installerId:X},materialTypeId:ee,fromDate:ae,toDate:re,type:a}}})]})}}}]);