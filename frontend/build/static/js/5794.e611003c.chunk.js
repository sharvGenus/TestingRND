"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[5794],{25794:(e,t,r)=>{r.r(t),r.d(t,{default:()=>j});var a=r(9950),o=r(27081),s=r(95537),n=r(4139),d=r(67535),i=r(60666),l=r(9449),u=r(26473),c=r(28429),m=r(29024),p=r(80415),v=r(88848),S=r(96951),h=r(14351),f=r(99635),I=r(52867),x=r(71826),y=r(62054),b=r(47501),R=r(52351),g=r(44414);const j=()=>{const[e,t]=(0,a.useState)([]),[r,j]=(0,a.useState)(!1),[A,q]=(0,a.useState)(p.j7.pageIndex),[C,N]=(0,a.useState)(p.j7.pageSize),[k,w]=(0,a.useState)(""),[M,T]=(0,a.useState)(null),[O,L]=(0,a.useState)(null),[z,D]=(0,a.useState)(!1),H=(0,c.Zp)(),P=(0,l.mN)({resolver:(0,u.t)(i.Ik().shape()),defaultValues:{},mode:"all"}),Q=(0,o.wA)();(0,a.useEffect)((()=>{Q((0,m._G1)())}),[Q]);const{masterMakerLovs:F}=(0,v.$)(),E=(e,t)=>{const r=e&&e.filter((e=>e.name===t));return r&&r.length?r[0].id:null},_=F.masterMakerLovsObject.rows,$=E(_,"CANCELMRR"),B=E(_,"MRR"),{handleSubmit:G}=P,J=(0,a.useMemo)((()=>[{Header:"Name",accessor:"material.name"},{Header:"Code",accessor:"material.code"},{Header:"Requested Quantity",accessor:"requestedQuantity"},{Header:"UOM",accessor:"uom.name"}]),[]);return(0,a.useEffect)((()=>{var e,r;O&&(t(O),Q((0,m.J9T)({project:null===(e=O[0])||void 0===e?void 0:e.projectId,store:null===(r=O[0])||void 0===r?void 0:r.fromStoreId})))}),[Q,O]),(0,g.jsxs)(g.Fragment,{children:[z&&(0,g.jsx)(R.A,{}),(0,g.jsx)(S.Op,{methods:P,onSubmit:G((async()=>{var t,r,a;D(!0);const o=(()=>{const t=[],r=[];return e.map((e=>{r.push(e.id)})),e.map((e=>{t.push({requestIds:r,requestName:"MRR",transactionTypeId:$,requestTransactionTypeId:B,requestOrganizationId:k,requestStoreId:e.fromStoreId,requestNumber:e.referenceDocumentNumber,projectId:e.projectId,fromStoreId:e.fromStoreId,fromStoreLocationId:e.fromStoreLocationId,toStoreId:M,toStoreLocationId:e.toStoreLocationId,materialId:e.materialId,uomId:e.uomId,requestedQuantity:e.requestedQuantity,approvedQuantity:e.approvedQuantity||0,rate:e.rate||0,value:e.value||0,tax:e.tax||0,serialNumbers:e.serialNumbers,vehicleNumber:e.vehicleNumber,remarks:e.remarks})})),{payload:(0,I.cF)(t)}})(),s=await(0,x.default)("/cancel-request-create",{method:"POST",body:o,timeoutOverride:12e4});var n;if(!s.success)return(0,y.A)((null===s||void 0===s||null===(n=s.error)||void 0===n?void 0:n.message)||"Operation failed. Please try again!",{variant:"error"}),void D(!1);const d=null!==(t=null===(r=s.data)||void 0===r?void 0:r.data)&&void 0!==t?t:{},i=d.referenceDocumentNumber||(null===(a=d[0])||void 0===a?void 0:a.referenceDocumentNumber);(0,y.A)(i?`Request cancelled with reference number: ${i}`:"Request cancelled successfully!",{variant:"success",autoHideDuration:1e4}),D(!1),H("/stock-ledger")})),children:(0,g.jsxs)(h.A,{title:"Cancel MRR (Material Return Request)",sx:{mb:2},children:[(0,g.jsx)(b.A,{type:"request",transactionType:"MRR",disableAll:!(null===O||void 0===O||!O.length),setReqData:L,showToStoreDropdown:!0,showFromStoreAddress:!0,showToStoreAddress:!0,fromStoreType:"CONTRACTOR",toStoreType:"COMPANY",setFromStoreId:T,fromStoreLabel:"Contractor Store",toStoreLabel:"Company Store",setFromOrganizationId:w}),(null===O||void 0===O?void 0:O.length)&&(0,g.jsxs)(s.A,{sx:{mt:4},children:[(0,g.jsx)(f.default,{title:"Cancel MRR",hideHeader:!0,hidePagination:!0,data:e,count:e.length,columns:J,hideActions:!0,setPageIndex:q,setPageSize:N,pageIndex:A,pageSize:C}),(0,g.jsx)(n.Ay,{item:!0,md:12,xl:2,sx:{mt:4},children:(0,g.jsxs)(n.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px"},children:[(0,g.jsx)(d.A,{onClick:()=>{j(!r),t([]),L(void 0),H("/cancel-mrr")},size:"small",variant:"outlined",color:"primary",children:"Back"}),(0,g.jsx)(d.A,{disabled:z,size:"small",type:"submit",variant:"contained",color:"primary",children:"Reverse"})]})})]})]})})]})}}}]);