"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[8393],{3147:(e,t,o)=>{o.d(t,{E:()=>n});var r=o(9950),a=o(27081);const n=()=>{const[e,t]=(0,r.useState)({organizationStoreObject:{},error:"",loading:!0}),[o,n]=(0,r.useState)({organizationStoreObject:{},error:"",loading:!0}),[s,i]=(0,r.useState)({organizationStoreObject:[],error:"",loading:!0}),[l,d]=(0,r.useState)({organizationStoreDropdownObject:{},error:"",loading:!0}),[c,u]=(0,r.useState)({organizationStoreDropdownSecondObject:{},error:"",loading:!0}),[p,g]=(0,r.useState)({orgStoreDropDownObject:{},error:"",loading:!0}),[m,S]=(0,r.useState)({orgViewStoreDropDownObject:{},error:"",loading:!0}),[y,f]=(0,r.useState)({organizationStoresHistoryObject:{},error:"",loading:!0}),x=(0,a.d4)((e=>e.organizationStores||{})),j=(0,a.d4)((e=>e.organizationStoresAllAccess||{})),D=(0,a.d4)((e=>e.organizationStoresSecond||[])),v=(0,a.d4)((e=>e.organizationStoreDropdown||[])),b=(0,a.d4)((e=>e.organizationStoreDropdownSecond||[])),h=(0,a.d4)((e=>e.orgStoreDropDown||[])),z=(0,a.d4)((e=>e.orgViewStoreDropDown||[])),w=(0,a.d4)((e=>e.organizationStoresHistory||[]));return(0,r.useEffect)((()=>{t((e=>({...e,...x})))}),[x]),(0,r.useEffect)((()=>{n((e=>({...e,...j})))}),[j]),(0,r.useEffect)((()=>{i((e=>({...e,...D})))}),[D]),(0,r.useEffect)((()=>{d((e=>({...e,...v})))}),[v]),(0,r.useEffect)((()=>{u((e=>({...e,...b})))}),[b]),(0,r.useEffect)((()=>{g((e=>({...e,...h})))}),[h]),(0,r.useEffect)((()=>{S((e=>({...e,...z})))}),[z]),(0,r.useEffect)((()=>{f((e=>({...e,...w})))}),[w]),{organizationStores:e,organizationStoresSecond:s,organizationStoresDropdown:l,orgStoreDropDown:p,orgViewStoreDropDown:m,organizationStoresHistory:y,organizationStoresAllAccess:o,organizationStoresDropdownSecond:c}}},38393:(e,t,o)=>{o.r(t),o.d(t,{default:()=>b});var r=o(9950),a=o(27081),n=o(4139),s=o(67535),i=o(60666),l=o(9449),d=o(26473),c=o(8008),u=o(96951),p=o(14351),g=o(84601),m=o(29024),S=o(52867),y=o(89649),f=o(99635),x=o(88848),j=o(80733),D=o(3147),v=o(44414);const b=()=>{var e,t;const{paginations:{pageSize:o,pageIndex:b},setPageIndex:h,setPageSize:z}=(0,y.A)(),[w,A]=(0,r.useState)(""),[O,I]=(0,r.useState)(0),[k,P]=(0,r.useState)([]),[T,E]=(0,r.useState)(0),[N,C]=(0,r.useState)(!1),M=(0,a.wA)(),H=(0,l.mN)({resolver:(0,d.t)(i.Ik().shape({projectId:g.A.project,storeId:g.A.store,fromDate:g.A.fromDate,toDate:g.A.toDate,trxnType:g.A.transaction})),defaultValues:{},mode:"all"}),{handleSubmit:R}=H,{projectsDropdown:V}=(0,j.Y)(),{masterMakerLovs:_}=(0,x.$)(),{organizationStores:q}=(0,D.E)(),L=null===V||void 0===V?void 0:V.projectsDropdownObject,B=null===(e=_.masterMakerLovsObject)||void 0===e?void 0:e.rows,W=null===q||void 0===q||null===(t=q.organizationStoreObject)||void 0===t?void 0:t.rows,{deliveryReports:Q}=(0,c.r)(),{data:Y,count:$}=(0,r.useMemo)((()=>{var e,t;return{data:(null===(e=Q.deliveryReportsObject)||void 0===e?void 0:e.rows)||[],count:(null===(t=Q.deliveryReportsObject)||void 0===t?void 0:t.count)||0,isLoading:Q.loading||!1}}),[Q]);(0,r.useEffect)((()=>{if(Y){const e=Y.map((e=>{let t=0;return null===e||void 0===e||e.stock_ledgers.map((e=>t+=e.quantity<0?-e.quantity:e.quantity)),t}));I(...e);const t=Y.map((e=>{let t=0;return null===e||void 0===e||e.stock_ledgers.map((e=>t+=e.value)),t}));E(...t),P(structuredClone(Y))}}),[Y]),k.map((e=>{e.eWayBillQty=O,e.totalChallanValue=T}));const F=(0,r.useMemo)((()=>[{Header:"MIV No",accessor:"referenceDocumentNumber"},{Header:"Date",accessor:"createdAt"},{Header:"Name of Contractors",accessor:"stock_ledgers[2].organization_store.name"},{Header:"E-Way Bill No",accessor:"eWayBillNumber"},{Header:"Total Qty",accessor:"eWayBillQty"},{Header:"Total Value of Challan ",accessor:"totalChallanValue"},{Header:"MatMovementType",accessor:"stock_ledgers[1].transaction_type.name"},{Header:"ReferenceDocNo",accessor:"ReferenceDocNo"}]),[]);(0,r.useEffect)((()=>{M((0,m.VOH)("TRANSACTION TYPE"))}),[M]);const{masterMakerOrgType:{masterObject:G}}=(0,x.$)(),J=(0,S.x)(G,w);return(0,r.useEffect)((()=>{M((0,m.uiG)()),M((0,m._G1)())}),[M]),(0,r.useEffect)((()=>{M((0,m.qV$)({organizationType:(0,S.x)(B,"COMPANY")}))}),[M,B]),(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(u.Op,{methods:H,onSubmit:R((async e=>{e.transactionTypeId=J,e.pageSize=o,e.pageIndex=b,delete e.trxnType,M((0,m.ylP)(e)),C(!N)})),children:(0,v.jsxs)(p.A,{title:"Delivery Challan Report",sx:{mb:2},children:[(0,v.jsxs)(n.Ay,{container:!0,spacing:4,children:[(0,v.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,v.jsx)(u.eu,{name:"projectId",label:"Project",InputLabelProps:{shrink:!0},menus:L,required:!0})}),(0,v.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,v.jsx)(u.eu,{name:"storeId",label:"Select Store",InputLabelProps:{shrink:!0},menus:W,required:!0})}),(0,v.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,v.jsx)(u.o3,{name:"fromDate",type:"date",label:"From Date",InputLabelProps:{shrink:!0},required:!0})}),(0,v.jsx)(n.Ay,{item:!0,md:3,xl:2,children:(0,v.jsx)(u.o3,{name:"toDate",type:"date",label:"To Date",InputLabelProps:{shrink:!0},required:!0})}),(0,v.jsx)(n.Ay,{item:!0,md:6,sx:{width:"10%"},children:(0,v.jsx)(u.gk,{name:"trxnType",title:"",mini:!0,labels:[{value:"MIN",name:"MIN"},{value:"MRN",name:"MRN"},{value:"STO",name:"STO"},{value:"PTP",name:"PTP"}],onChange:e=>{A(e.target.value)}})}),(0,v.jsx)(n.Ay,{container:!0,spacing:2,alignItems:"end",sx:{mt:2},children:(0,v.jsx)(n.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px",mb:"15px"},children:(0,v.jsx)(s.A,{type:"submit",size:"small",variant:"contained",color:"primary",children:"Proceed"})})})]}),N?(0,v.jsx)(f.default,{title:"Delivery Challan Report",data:k,count:$,setPageIndex:h,setPageSize:z,pageIndex:b,pageSize:o,columns:F,hideActions:!0}):null]})})})}}}]);