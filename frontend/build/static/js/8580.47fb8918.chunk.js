"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[8580],{91052:(e,t,a)=>{a.d(t,{A:()=>v});var r=a(9950),i=a(27081),o=a(59254),l=a(87233),n=a(94908),s=a(29024),d=a(52867),u=a(44414);const c=(0,o.Ay)("div")((()=>({height:"100px",overflowY:"auto",border:"1px solid #d9d9d9",borderRadius:"4px"}))),v=e=>{let{data:t}=e;const a=(0,i.wA)();(0,r.useEffect)((()=>{var e,r,i,o;t&&t.length>0&&(a((0,s.DYA)({transactionTypeId:null===(e=t[0])||void 0===e?void 0:e.transactionTypeId,requestNumber:null===(r=t[0])||void 0===r?void 0:r.referenceDocumentNumber,storeId:(0,d.rd)(t[0])})),a((0,s.DUm)({projectId:null===(i=t[0])||void 0===i?void 0:i.projectId,transactionTypeId:null===(o=t[0])||void 0===o?void 0:o.transactionTypeId,storeId:(0,d.j5)(t[0]),all:!0,sortBy:"rank",sortOrder:"ASC"})))}),[a,t]);const{approvers:{approversObject:{rows:o}},reqApproversList:{approversListObject:{rows:v}}}=(0,n.O)();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.A,{sx:{mb:1},children:"Approver remarks"}),(0,u.jsx)(c,{children:o&&o.length>0&&(e=>{if(null===v||void 0===v||!v.length)return[];const t={};v&&v.length>0&&v.map((e=>{t[e.approverId]||(t[e.approverId]={status:e.status,approvedMaterials:e.approvedMaterials,createdAt:(0,d.VU)(e.createdAt,"24hour"),remarks:e.remarks})}));return e&&e.map((e=>{const a={...e};return t[e.id]&&t[e.id].status&&("1"===t[e.id].status||"0"===t[e.id].status)&&(a.aprStatus=t[e.id].status,a.approvedMaterials=t[e.id].approvedMaterials,a.approvedCreationDate=t[e.id].createdAt,a.remarks=t[e.id].remarks),a}))})(o).map((e=>{var t,a;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(l.A,{variant:"h5",sx:{ml:1,mt:1},children:[null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.name,"\xa0\xa0\xa0",null===e||void 0===e?void 0:e.approvedCreationDate]},e),(0,u.jsx)(l.A,{gutterBottom:!0,variant:"body1",sx:{ml:3},children:null===e||void 0===e?void 0:e.remarks},null===e||void 0===e||null===(a=e.user)||void 0===a?void 0:a.name)]})}))})]})}},513:(e,t,a)=>{a.d(t,{A:()=>d,y:()=>s});var r=a(9950),i=a(52351),o=a(44414);const l=(0,r.lazy)((()=>a.e(2480).then(a.bind(a,42480)))),n=(0,r.lazy)((()=>Promise.all([a.e(2509),a.e(2564),a.e(6424),a.e(6457),a.e(6643),a.e(839),a.e(5796)]).then(a.bind(a,95796)))),s=(e,t)=>{const a=structuredClone(e);return Object.entries(a).map((e=>{let[r,i]=e;if(!i)return[r,i];r.includes("-paths")&&(a[r]=void 0,a[r.replace("-paths","")]=[...i,...t.filter((e=>e.key===r)).map((e=>({action:e.action,filePath:e.filePath,fileName:e.fileName,fileData:e.fileData})))])})),a},d=e=>{let{view:t,update:a,setValue:s,tasks:d,setTasks:u,data:c,fileFields:v,disabled:m}=e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.Suspense,{fallback:(0,o.jsx)(o.Fragment,{}),children:!(t||a)&&v.map((e=>(0,o.jsx)(l,{disabled:m,multiple:e.multiple,accept:e.accept,label:e.label,name:e.name,setValue:s},e.name)))}),(0,o.jsx)(r.Suspense,{fallback:i.A,children:(t||a)&&(0,o.jsx)(n,{fileFields:v,setValue:s,tasks:d,setTasks:u,data:c,update:a,view:t})})]})}},94908:(e,t,a)=>{a.d(t,{O:()=>o});var r=a(9950),i=a(27081);const o=()=>{const[e,t]=(0,r.useState)({approversObject:{},error:"",loading:!0}),[a,o]=(0,r.useState)({approversListObject:[],error:"",loading:!0}),[l,n]=(0,r.useState)({approversListObject:[],error:"",loading:!0}),s=(0,i.d4)((e=>e.approvers||[])),d=(0,i.d4)((e=>e.getAllApproversList||[])),u=(0,i.d4)((e=>e.getAllApproversData||[]));return(0,r.useEffect)((()=>{t((e=>({...e,...s})))}),[s]),(0,r.useEffect)((()=>{o((e=>({...e,...d})))}),[d]),(0,r.useEffect)((()=>{n((e=>({...e,...u})))}),[u]),{approvers:e,approversList:a,reqApproversList:l}}},68580:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var r=a(9950),i=a(27081),o=a(53065),l=a(57073),n=a(95537),s=a(4139),d=a(67535),u=a(36089),c=a(28429),v=a(26473),m=a(60666),p=a(9449),x=a(62375),h=a(12952),b=a(87233),f=a(62605),y=a(96951),j=a(84601),A=a(14351),S=a(29024),I=a(62054),g=a(3252),k=a(52867),N=a(94826),C=a(44414);const L=(0,g.A)((0,r.lazy)((()=>Promise.resolve().then(a.bind(a,95615))))),_=e=>{var t,a;let{onMaterailsInput:o,view:l,update:n,showData:u,storeLocationData:c,maxQuantity:x,showCheckboxes:h}=e;const[g,_]=(0,r.useState)(!1),[D,O]=(0,r.useState)(u&&u.rate?null===u||void 0===u?void 0:u.rate:null),[T,q]=(0,r.useState)([]),[w,F]=(0,r.useState)([]),[Q,V]=(0,r.useState)(!1),[E,M]=(0,r.useState)(!1),[z,P]=(0,r.useState)(""),[R,H]=(0,r.useState)(!1),[U,B]=(0,r.useState)(!1),Y=!(null===u||void 0===u||null===(t=u.material)||void 0===t||!t.isSerialNumber),$=(0,i.wA)();(0,r.useEffect)((()=>{$((0,S._G1)())}),[$]),(0,r.useEffect)((()=>{_(!!l)}),[l,n]);const G=(0,p.mN)({resolver:(0,v.t)(m.Ik().shape({approvedQuantity:R?j.A.checkForInteger("Quantity",x<z||!z?x:z):j.A.maxQuantity(x<z||!z?x:z,!0),fromStoreLocationId:j.A.requiredWithLabel("Company Store Location")})),defaultValues:{},mode:"all"}),{handleSubmit:W,setValue:J,reset:Z,watch:K}=G,X=K("approvedQuantity"),ee=K("fromStoreLocationId"),te=K("uom");(0,r.useEffect)((()=>{var e;(l||n)&&u&&(e=u,Object.entries(e).forEach((e=>{var t;let[a,r]=e;"actions"!==a&&J(a,r),"uom"===a&&J(a,r.name),"rate"===a&&J(a,null===(t=parseFloat(r))||void 0===t?void 0:t.toFixed(2))})),u.fromStoreLocationId&&null!==u.fromStoreLocationId||J("fromStoreLocationId",""))}),[l,n,u,Z,J]);const ae=e=>c.filter((t=>t.id===e.fromStoreLocationId))[0],{serialNumbers:re,txnByLocationMaterial:ie}=(0,f.t)(),{serialNumbersData:oe}=(0,r.useMemo)((()=>{var e;return{serialNumbersData:(null===re||void 0===re?void 0:re.data)||{},countSN:(null===re||void 0===re||null===(e=re.data)||void 0===e?void 0:e.count)||0}}),[re]);let{projectStoreLocationData:le}=(0,r.useMemo)((()=>{var e;return{projectStoreLocationData:ee&&(null===ie||void 0===ie||null===(e=ie.stocksObject)||void 0===e?void 0:e.filter((e=>e.storeLocationId===ee)))||[],isLoading:ie.loading||!1}}),[ee,ie.loading,null===ie||void 0===ie?void 0:ie.stocksObject]);(0,r.useEffect)((()=>{le&&le.length>0?(B(!1),J("qtyInStock",(0,k.$G)(le[0].quantity)),J("rate",parseFloat(le[0].rate).toFixed(2)),J("tax",le[0].tax),J("value",parseFloat(le[0].rate*u.approvedQuantity).toFixed(2)),O(le[0].rate),P(le[0].quantity)):(B(!1),J("qtyInStock","0"),J("rate","0"),J("tax","0"),J("value","0"),O(0),P(0))}),[le,J,u]);const ne=function(e,t,a,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return(0,C.jsx)(y.o3,{name:e,type:a,label:t,..."function"===typeof i&&{handleChange:i},InputLabelProps:{shrink:l},...(o||g)&&{disabled:!0},...r&&{required:!0}})};(0,r.useEffect)((()=>{var e;oe?q(oe[null===u||void 0===u||null===(e=u.material)||void 0===e?void 0:e.id]):q((null===u||void 0===u?void 0:u.material_serial_numbers)||[])}),[oe,null===u||void 0===u||null===(a=u.material)||void 0===a?void 0:a.id,null===u||void 0===u?void 0:u.material_serial_numbers]),(0,r.useEffect)((()=>{F((null===u||void 0===u?void 0:u.material_serial_numbers)||[])}),[null===u||void 0===u?void 0:u.material_serial_numbers]);(0,r.useEffect)((()=>{M(!1)}),[w]);const se=["faulty","scrap","missing","consumed","billing","installed","installer","old","service-center","service center","defective","damage","non-repairable","non repairable"];return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(A.A,{sx:{mb:2,pb:4},children:(0,C.jsxs)(y.Op,{methods:G,children:[U&&(0,C.jsx)(N.A,{}),(0,C.jsxs)(s.Ay,{container:!0,spacing:2,sx:{mt:2},children:[(0,C.jsx)(s.Ay,{item:!0,md:4,children:ne("material.code","Code","text",!0,void 0,!0)}),(0,C.jsx)(s.Ay,{item:!0,md:4,children:ne("material.name","Materials","text",!0,void 0,!0)}),(0,C.jsx)(s.Ay,{item:!0,md:4,children:(de="fromStoreLocationId",ue="Company Store Location ",ce=c&&c.filter((e=>se.every((t=>!e.name.toLowerCase().includes(t))))),ve=!0,me=e=>{var t,a,r,i,o;null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.value&&(B(!0),$((0,S.J9T)({project:null===u||void 0===u?void 0:u.projectId,store:null===u||void 0===u?void 0:u.fromStoreId,storeLocation:null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.value,material:null===u||void 0===u||null===(r=u.material)||void 0===r?void 0:r.id})),$((0,S.a2o)({project:null===u||void 0===u?void 0:u.projectId,store:null===u||void 0===u?void 0:u.fromStoreId,storeLocation:null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.value,material:null===u||void 0===u||null===(o=u.material)||void 0===o?void 0:o.id})))},(0,C.jsx)(y.eu,{name:de,label:ue,onChange:me,InputLabelProps:{shrink:!0},menus:ce,...g&&{disable:!0},...ve&&{required:!0}}))}),(0,C.jsx)(s.Ay,{item:!0,md:2,children:ne("approvedQuantity","Quantity",(0,k.VF)(te)?"text":"number",!0,(e=>{var t;(0,k.VF)(te)?H(!1):H(!0),J("value",parseFloat((null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)*D).toFixed(2)),F([])}))}),(0,C.jsx)(s.Ay,{item:!0,md:2,children:ne("qtyInStock","Qty In Stock","number",!0,void 0,!0)}),(0,C.jsx)(s.Ay,{item:!0,md:2,children:ne("uom","UOM","text",!0,void 0,!0)}),(0,C.jsx)(s.Ay,{item:!0,md:2,style:{display:"none"},children:ne("uomId","UOMId","text",!0)}),(0,C.jsx)(s.Ay,{item:!0,md:2,style:{display:"none"},children:ne("rate","Rate","text",!0,(e=>{var t;O(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)}),!0)}),(0,C.jsx)(s.Ay,{item:!0,md:2,style:{display:"none"},children:ne("value","Value","number",!0,void 0,!0)}),(0,C.jsxs)(s.Ay,{item:!0,md:1,sx:{textAlign:"center"},children:[Y&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(b.A,{mb:-1,children:"Serial No"})," ",(0,C.jsx)("br",{}),(0,C.jsx)(d.A,{size:"small",onClick:()=>{V(!0)},variant:"contained",color:"primary",children:"View"})]}),E&&Y&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("br",{}),(0,C.jsx)(b.A,{color:"error",sx:{fontSize:12,marginTop:2},children:"Count of serial numbers must be equal to quantity"})]})]}),(0,C.jsx)(s.Ay,{item:!0,xs:12,sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:!l&&(0,C.jsx)(d.A,{size:"small",onClick:W((e=>{Y&&e.approvedQuantity!==w.length?M(!0):(M(!1),parseInt(e.approvedQuantity)>parseInt(e.qtyInStock)?(0,I.A)("Quantity should be less than or equal to quantity in stock",{variant:"error"}):(e.from_store_location=ae(e),e.fromStoreLocation=ae(e),e.approvedQuantity=e.approvedQuantity>0?e.approvedQuantity:"0",o({...e,material_serial_numbers:w},u.id),Z()))})),variant:"contained",color:"primary",children:n?"Update":"Add"})})]}),Q&&(0,C.jsx)(L,{open:Q,onClose:()=>{V(!1)},maxQuantity:X,onSave:e=>{F(e)},selectedSerials:w,showCheckboxes:h,serialNumberData:T})]})})});var de,ue,ce,ve,me};var D=a(12257),O=a(74745),T=a(91052);const q=e=>{let{reqSTRData:t,setFormData:a,disableAll:i,setDisableAll:o}=e;const l=(0,p.mN)({resolver:(0,v.t)(m.Ik().shape({transporterName:j.A.inventoryNameOptional,transporterContactNumber:j.A.mobileNumberOptional,vehicleNumber:j.A.vehicleNumberOptional,invoiceDate:j.A.date})),defaultValues:{},mode:"all"}),{handleSubmit:n,setValue:u}=l,[c,x]=(0,r.useState)([]),h=function(e,t,a,r){let o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=arguments.length>5?arguments[5]:void 0,n=arguments.length>6?arguments[6]:void 0;return(0,C.jsx)(D.A,{spacing:1,children:(0,C.jsx)(y.o3,{name:e,type:a,label:t,disabled:l,InputLabelProps:{shrink:o},..."function"===typeof n&&{handleChange:n},...i&&{disabled:!0},...r&&{required:!0}})})};return(0,r.useEffect)((()=>{var e,a,r;t&&t.length>0&&(u("storeId",null===t||void 0===t||null===(e=t[0])||void 0===e?void 0:e.toStoreId),u("invoiceDate",null===t||void 0===t||null===(a=t[0])||void 0===a?void 0:a.createdAt.split("T")[0]),x([null===t||void 0===t||null===(r=t[0])||void 0===r?void 0:r.to_store]))}),[t,u]),(0,C.jsx)(y.Op,{methods:l,children:(0,C.jsx)(s.Ay,{container:!0,spacing:4,children:t&&t.length>0&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(s.Ay,{item:!0,md:3,xl:2,children:(b="storeId",f="Place Of Transfer",A=c,S=void 0,I=!0,g=!0,(0,C.jsx)(D.A,{children:(0,C.jsx)(y.eu,{name:b,label:f,disable:g,..."function"===typeof S&&{onChange:S},InputLabelProps:{shrink:!0},menus:A,...i&&{disable:!0},...I&&{required:!0}})}))}),(0,C.jsx)(s.Ay,{item:!0,md:3,xl:2,children:h("invoiceDate","Invoice Date","date",!0)}),(0,C.jsx)(s.Ay,{item:!0,md:3,xl:2,children:h("transporterName","Transporter Name","text",!1)}),(0,C.jsx)(s.Ay,{item:!0,md:3,xl:2,children:h("transporterContactNumber","Contact Number","number",!1)}),(0,C.jsx)(s.Ay,{item:!0,md:3,xl:2,children:h("vehicleNumber","Vehicle Number","text",!1)}),(0,C.jsx)(s.Ay,{item:!0,md:3,xl:2,children:h("lrNumber","LR Number","text")}),(0,C.jsx)(s.Ay,{item:!0,md:3,xl:2,children:h("placeOfSupply","Place Of Supply","text",!1,!1)}),(0,C.jsx)(s.Ay,{item:!0,md:3,xl:2,children:h("remarks","Remarks","text",!1)}),(0,C.jsx)(s.Ay,{item:!0,md:3,xl:4,children:(0,C.jsx)(T.A,{data:t})}),(0,C.jsx)(s.Ay,{container:!0,spacing:4,children:(0,C.jsx)(s.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px",mt:2},children:!i&&(0,C.jsx)(d.A,{size:"small",variant:"contained",onClick:n((e=>{o(!0),e.transactionTypeId="fadec802-92aa-4127-8ba1-e3d9b6bd4936",e.strTransactionTypeId="ba23b5a7-2ed1-44f6-a673-c924cae9ba8a",a(e)})),color:"primary",children:"Next"})})}),(0,C.jsx)(s.Ay,{container:!0,sx:{mt:3,mb:3},children:(0,C.jsx)(s.Ay,{item:!0,md:12,xl:12,children:(0,C.jsx)(O.A,{})})})]})})});var b,f,A,S,I,g};var w=a(99635),F=a(60845),Q=a(71826),V=a(62472),E=a(52351),M=a(513),z=a(95615);const P=[{Header:"Actions",accessor:"actions"},{Header:"Name",accessor:"material.name"},{Header:"Code",accessor:"material.code"},{Header:"Quantity",accessor:"approvedQuantity"},{Header:"Quantity In Stock",accessor:"qtyInStock"},{Header:"UOM",accessor:"uom.name"},{Header:"Company Store Location",accessor:"from_store_location.name"}],R=e=>{var t;let{values:a,onEdit:r,index:i,onView:n}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(o.A,{title:"Edit",placement:"bottom",children:(0,C.jsx)(l.A,{color:"secondary",onClick:()=>r(a,i),children:(0,C.jsx)(u.A,{})})}),(null===a||void 0===a||null===(t=a.material)||void 0===t?void 0:t.isSerialNumber)&&(0,C.jsx)(o.A,{title:"View Serial Number",placement:"bottom",children:(0,C.jsx)(l.A,{color:"secondary",onClick:()=>n(a),children:(0,C.jsx)(x.A,{})})})]})},H=[{name:"attachments",label:"Attachments",accept:"*",required:!1,multiple:!0}],U=()=>{var e,t;const a=(0,c.Zp)(),o=(0,i.wA)(),[l,u]=(0,r.useState)([]),[x,b]=(0,r.useState)(null),[f,S]=(0,r.useState)(null),[g,N]=(0,r.useState)(!1),[L,D]=(0,r.useState)(),[O,T]=(0,r.useState)(!1),[U,B]=(0,r.useState)(!1),[Y,$]=(0,r.useState)(!1),[G,W]=(0,r.useState)(null),[J,Z]=(0,r.useState)(!1),[K,X]=(0,r.useState)(null),ee=(0,p.mN)({resolver:(0,v.t)(m.Ik().shape({...(null===(e=H.find((e=>"attachments"===e.name)))||void 0===e?void 0:e.required)&&{attachments:j.A.requiredWithLabel("Attachments")}})),defaultValues:{},mode:"all"}),{watch:te,setValue:ae,handleSubmit:re}=ee,ie=te("attachments-paths"),oe=(0,r.useCallback)(((e,t)=>{var a;N(!0),b(e),S(null===(a=l[t])||void 0===a?void 0:a.approvedQuantity)}),[l]),le=e=>{X(e),Z(!0),null!==e&&void 0!==e&&e.material_serial_numbers||W([])};(0,r.useEffect)((()=>{null!==K&&void 0!==K&&K.material_serial_numbers&&W(null===K||void 0===K?void 0:K.material_serial_numbers)}),[K]),(0,r.useEffect)((()=>{if(!L)return;const e=structuredClone(L);delete e[0].rate,delete e[0].tax,delete e[0].value,u(e)}),[o,L]);const{companyStoreLocations:ne}=(0,h.V)(),se=(null===(t=ne.companyStoreLocationsObject)||void 0===t?void 0:t.rows)||[],de=()=>{N(!1),ve(null),T(!O),u([]),D(null)},[ue,ce]=(0,r.useState)(),ve=e=>{e&&ce(e)};return(0,r.useEffect)((()=>{o((0,F.Ru)({organizationType:"420e7b13-25fd-4d23-9959-af1c07c7e94b"}))}),[o]),(0,C.jsxs)(C.Fragment,{children:[Y&&(0,C.jsx)(E.A,{}),(0,C.jsxs)(A.A,{title:"STO (Stock Transfer Order)",sx:{mb:2,pb:4},children:[(0,C.jsx)(V.A,{fromStoreLabel:"Company Store",showFromStoreAddress:!0,fromStoreType:"COMPANY",type:"request",approvedOnly:!0,transactionType:"STR",disableAll:!(null===L||void 0===L||!L.length),setReqData:D,showBranchAlso:!0}),(0,C.jsx)(n.A,{sx:{mt:4},children:(0,C.jsx)(q,{onClick:de,disableAll:U,setDisableAll:B,setFormData:ve,reqSTRData:l})})]}),g&&(0,C.jsx)(_,{showData:x,onMaterailsInput:(e,t)=>{t&&(u(l.map((t=>t.id===e.id?{...t,approvedQuantity:e.approvedQuantity,fromStoreLocationId:e.fromStoreLocationId,from_store_location:e.from_store_location,material_serial_numbers:e.material_serial_numbers,qtyInStock:e.qtyInStock,rate:e.rate,tax:e.tax,value:e.value}:t))),N(!1))},maxQuantity:f,view:!1,update:g,storeLocationData:(pe=l,se.filter((e=>{var t;return e.organizationStoreId===(null===pe||void 0===pe||null===(t=pe[0])||void 0===t?void 0:t.fromStoreId)}))),showCheckboxes:!0}),ue&&l&&l.length>0&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(w.default,{title:"STO (Stock Transfer Order)",hideHeader:!0,hidePagination:!0,data:(me=l,null===me||void 0===me?void 0:me.filter((e=>e.approvedQuantity>0)).map(((e,t)=>({...e,actions:(0,C.jsx)(R,{values:{...e},index:t,onEdit:oe,onView:le})})))),count:l.length,columns:P,hideActions:!0}),J&&K&&G&&(0,C.jsx)(z.default,{open:J,onClose:()=>{Z(!1)},serialNumberData:G}),(0,C.jsx)(y.Op,{methods:ee,children:(0,C.jsxs)(s.Ay,{container:!0,spacing:4,sx:{mt:1},children:[(0,C.jsx)(s.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-start",gap:"20px",position:"absolute"},children:(0,C.jsx)(M.A,{fileFields:H,setValue:ae})}),(0,C.jsxs)(s.Ay,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"20px"},children:[(0,C.jsx)(d.A,{onClick:de,size:"small",variant:"outlined",color:"primary",children:"Back"}),(0,C.jsx)(d.A,{disabled:g||Y,onClick:re((async()=>{var e,t,r;$(!0);const i=function(){var e,t;const a=l.filter((e=>parseInt(e.approvedQuantity)>0&&e.material.isSerialNumber)).filter((e=>!e.material_serial_numbers||e.material_serial_numbers.length!==e.approvedQuantity));var r,i;return a.length>0?void(0,I.A)(`Incorrect count of serial numbers selected for material "${null===(r=a[0])||void 0===r||null===(i=r.material)||void 0===i?void 0:i.name}"`,{variant:"warning"}):{transactionTypeId:ue.transactionTypeId,requestTransactionTypeId:ue.strTransactionTypeId,requestNumber:null===l||void 0===l||null===(e=l[0])||void 0===e?void 0:e.referenceDocumentNumber,poNumber:null===ue||void 0===ue?void 0:ue.poNumber,poDate:null===ue||void 0===ue?void 0:ue.poDate,lrNumber:null===ue||void 0===ue?void 0:ue.lrNumber,transporterName:null===ue||void 0===ue?void 0:ue.transporterName,transporterContactNumber:null===ue||void 0===ue?void 0:ue.transporterContactNumber,vehicleNumber:null===ue||void 0===ue?void 0:ue.vehicleNumber,invoiceNumber:null===ue||void 0===ue?void 0:ue.invoiceNumber,invoiceDate:null===ue||void 0===ue?void 0:ue.invoiceDate,actualReceiptDate:null===ue||void 0===ue?void 0:ue.actualReceiptDate,remarks:null===ue||void 0===ue?void 0:ue.remarks,fromStoreId:null===l||void 0===l||null===(t=l[0])||void 0===t?void 0:t.fromStoreId,placeOfSupply:null===ue||void 0===ue?void 0:ue.placeOfSupply,attachments:ie,stock_ledgers:l.filter((e=>parseFloat(e.approvedQuantity)>0)).map((e=>{var t,a,r,i,o,l,n;return{transactionTypeId:ue.transactionTypeId,organizationId:null!==(null===e||void 0===e||null===(t=e.from_store)||void 0===t||null===(a=t.organization)||void 0===a?void 0:a.parentId)?null===e||void 0===e||null===(r=e.from_store)||void 0===r||null===(i=r.organization)||void 0===i||null===(o=i.parent)||void 0===o?void 0:o.id:null===e||void 0===e||null===(l=e.from_store)||void 0===l||null===(n=l.organization)||void 0===n?void 0:n.id,projectId:null===e||void 0===e?void 0:e.projectId,fromStoreLocationId:null===e||void 0===e?void 0:e.fromStoreLocationId,storeId:null===ue||void 0===ue?void 0:ue.storeId,requestNumber:null===e||void 0===e?void 0:e.referenceDocumentNumber,materialId:null===e||void 0===e?void 0:e.materialId,uomId:null===e||void 0===e?void 0:e.uomId,quantity:null===e||void 0===e?void 0:e.approvedQuantity,rate:null===e||void 0===e?void 0:e.rate,value:null===e||void 0===e?void 0:e.value,tax:null===e||void 0===e?void 0:e.tax,remarks:null===ue||void 0===ue?void 0:ue.remarks,serialNumber:e.material.isSerialNumber?e.material_serial_numbers:[]}}))||[]}}();if(!i)return void $(!1);if((0,k.Rh)(i.stock_ledgers,"fromStoreLocationId"))return void $(!1);const o=await(0,Q.default)("/sto-transaction-create",{method:"POST",body:i,timeoutOverride:12e4});var n;if(!o.success)return(0,I.A)((null===o||void 0===o||null===(n=o.error)||void 0===n?void 0:n.message)||"Operation failed. Please try again!",{variant:"error"}),void $(!1);const s=null!==(e=null===(t=o.data)||void 0===t?void 0:t.data)&&void 0!==e?e:{},d=s.referenceDocumentNumber||(null===(r=s[0])||void 0===r?void 0:r.referenceDocumentNumber);(0,I.A)(d?`Transaction created with reference number: ${d}`:"Transaction created successfully!",{variant:"success",autoHideDuration:1e4}),$(!1),a("/sto-receipt")})),size:"small",variant:"contained",color:"primary",children:"Submit"})]})]})})]})]});var me,pe}},62375:(e,t,a)=>{var r=a(24994);t.A=void 0;var i=r(a(79526)),o=a(44414);t.A=(0,i.default)((0,o.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")}}]);