"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[9249],{73961:(e,t,r)=>{r.d(t,{A:()=>G});var a=r(9950),n=r(81095),i=r(80294),o=r(93245),s=r(60158),l=r(44813),c=r(16335),d=r(25102),u=r(85706),p=r(67628),h=r(12257),x=r(95537),m=r(87233),v=r(57073),g=r(92089),y=r(27987),A=r(14195),f=r(7233),j=r(51496),b=r(99624),C=r(77340),S=r(18655),w=r(71201),k=r(55271),$=r(34691),D=r(59019),_=r(81052),T=r.n(_),O=r(47751),I=r(3379),M=r(78581),N=r(14351),z=r(62054),W=r(33507),H=r(52867),P=r(44414);const E=["#8884d8","#82ca9d","#ffc658","#ff8042","#8dd1e1","#a4de6c","#d0ed57","#ffc0cb"],G=e=>{let{chartData:t,xAxis:r,title:_,height:G}=e;const{user:F}=(0,W.A)(),[R,B]=(0,a.useState)(null),[V,L]=(0,a.useState)([]),[U,X]=(0,a.useState)(!1),K=(0,a.useRef)();if(!t||!t.length)return(0,P.jsx)(I.A,{title:_});const Z=Object.keys(t[0]).filter((e=>e!==r)),q=Z.length<=2?E.slice(0,2):E,Y=(()=>{var e;const r=null===(e=Object.keys(t[0]))||void 0===e?void 0:e.filter((e=>e!==Z&&!(null!==V&&void 0!==V&&V.includes(e))));return 0===(null===r||void 0===r?void 0:r.length)?1/0:Math.max(...t.map((e=>r.reduce(((t,r)=>{const a=parseInt(e[r],10);return t+(isNaN(a)?0:a)}),0))))})(),J=Y+Math.ceil(.1*Y),Q=Math.ceil(J/6),ee=()=>{B(null)},te=()=>{const e=new Date,t=new Date(e.getTime()+198e5),r=t.getUTCFullYear(),a=String(t.getUTCMonth()+1).padStart(2,"0"),n=String(t.getUTCDate()).padStart(2,"0"),i=String(t.getUTCHours()).padStart(2,"0"),o=String(t.getUTCMinutes()).padStart(2,"0"),s=String(t.getUTCSeconds()).padStart(2,"0");return`${(e=>{const[t,...r]=e.trim().split(" "),a=r.map((e=>{var t;return null===(t=e.charAt(0))||void 0===t?void 0:t.toUpperCase()})).join("");return a?`${t} ${a}`:t})(null===F||void 0===F?void 0:F.name)}_${r}-${a}-${n}_${i}-${o}-${s} IST`},re=t.length>15,ae=t.length>15?15:50;return(0,P.jsxs)(N.A,{sx:{height:500,width:"100%"},children:[_&&(0,P.jsx)(h.A,{sx:{border:"1px solid #97E7E1"},children:(0,P.jsxs)(x.A,{sx:{backgroundColor:M.H_,py:.7,display:"flex",flexDirection:"row",alignItems:"center",px:2},children:["none"!==_&&(0,P.jsx)(x.A,{sx:{flex:1,display:"flex",justifyContent:"center"},children:(0,P.jsx)(m.A,{variant:"h6",color:"common.white",children:_})}),(0,P.jsx)(v.A,{"aria-label":"export options","aria-controls":"menu","aria-haspopup":"true",onClick:e=>{B(e.currentTarget)},sx:{color:"white",display:"none"},children:(0,P.jsx)(b.A,{})}),(0,P.jsxs)(g.A,{id:"menu",anchorEl:R,keepMounted:!0,open:Boolean(R),onClose:ee,children:[(0,P.jsxs)(y.A,{onClick:()=>{const e=te();if(K.current){const t=document.createElement("div");t.style.position="relative",t.style.width=`${K.current.clientWidth}px`,t.style.height=`${K.current.clientHeight+50}px`,t.style.backgroundColor="white";const r=document.createElement("div");r.style.textAlign="center",r.style.marginBottom="10px",r.innerHTML=`<h2>${_}</h2>`,t.appendChild(r);const a=K.current.cloneNode(!0);t.appendChild(a),document.body.appendChild(t),(0,O.$E)(t,{cacheBust:!0}).then((r=>{(0,$.saveAs)(r,`${_.replace(/\s+/g,"_")}_${e}.png`),(0,z.A)("Chart exported as PNG successfully.",{variant:"success",autoHideDuration:1e3}),document.body.removeChild(t)})).catch((e=>{(0,z.A)(e.message||"Can't export as PNG.",{variant:"error",autoHideDuration:1e3}),document.body.removeChild(t)}))}else(0,z.A)("Can't export as PNG.",{variant:"error",autoHideDuration:1e3});ee()},children:[(0,P.jsx)(A.A,{children:(0,P.jsx)(C.A,{fontSize:"small"})}),"Export as PNG"]}),(0,P.jsxs)(y.A,{onClick:()=>{const e=te();setTimeout((()=>{K.current&&K.current instanceof Node?T()(K.current).then((t=>{const r=new D.jsPDF;r.text(_,r.internal.pageSize.getWidth()/2,20,{align:"center"});const a=t.toDataURL("image/png"),n=r.getImageProperties(a),i=r.internal.pageSize.getWidth(),o=n.height*i/n.width;r.addImage(a,"PNG",0,30,i,o),r.save(`${_.replace(/\s+/g,"_")}_${e}.pdf`),(0,z.A)("Chart exported as PDF successfully.",{variant:"success",autoHideDuration:1e3})})).catch((e=>{(0,z.A)(e.message||"Can't export as PDF.",{variant:"error",autoHideDuration:1e3})})):(0,z.A)("Can't export as PDF.",{variant:"error",autoHideDuration:1e3})}),1e3),ee()},children:[(0,P.jsx)(A.A,{children:(0,P.jsx)(S.A,{fontSize:"small"})}),"Export as PDF"]}),(0,P.jsxs)(y.A,{onClick:()=>{const e=te(),a=V.length>0?Z.filter((e=>!V.includes(e))):Z,n=t.map((e=>a.reduce(((t,a)=>(t[r]=e[r],t[a]=e[a],t)),{}))),i=k.Wp.json_to_sheet(n),o=[Array(a.length+1).fill("")];o[0][0]=_,k.Wp.sheet_add_aoa(i,o,{origin:"A1"}),i["!merges"]=[{s:{r:0,c:0},e:{r:0,c:a.length}}];const s=[r,...a].map((e=>e.charAt(0).toUpperCase()+e.slice(1)));k.Wp.sheet_add_aoa(i,[s],{origin:"A2"}),k.Wp.sheet_add_json(i,n,{origin:"A3",skipHeader:!0});const l=k.Wp.book_new();k.Wp.book_append_sheet(l,i,"Data"),k._h(l,`${_.replace(/\s+/g,"_")}_${e}.xlsx`),(0,z.A)("Chart exported as XLSX successfully.",{variant:"success",autoHideDuration:1e3}),ee()},children:[(0,P.jsx)(A.A,{children:(0,P.jsx)(w.A,{fontSize:"small"})}),"Export as Excel"]})]})]})}),(0,P.jsxs)(x.A,{sx:{position:"relative",mt:4},children:[(0,P.jsx)(f.A,{control:(0,P.jsx)(j.A,{checked:U,onChange:()=>X(!U),name:"showValues",color:"primary"}),label:"Show Values",sx:{display:"none",justifyContent:"flex-end",alignItems:"center",pr:"20px"}}),(0,P.jsx)(n.u,{width:"100%",height:G,ref:K,children:(0,P.jsxs)(i.E,{width:"100%",height:G,ref:K,data:t,children:[(0,P.jsx)(o.d,{strokeDasharray:"3 3"}),(0,P.jsx)(s.W,{dataKey:r,angle:re?-45:0,textAnchor:re?"end":"middle",padding:{left:10,right:10},height:200,interval:0,tickFormatter:H.XV}),(0,P.jsx)(l.h,{allowDecimals:!1,ticks:(()=>{const e=[];let t=J;for(;t>=0;)e.push(t),t-=Q;return e.includes(0)||e.push(0),e})(),domain:[0,J]}),(0,P.jsx)(c.m,{}),(0,P.jsx)(d.s,{layout:"horizontal",verticalAlign:"top",align:"center",onClick:e=>{return t=e.dataKey,void L((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t]));var t},iconType:"square",wrapperStyle:{display:"flex",justifyContent:"center",fontSize:"14px",fontWeight:"bold",marginBottom:"5px"},formatter:(e,t)=>{const r=V.includes(e);return(0,P.jsx)("span",{style:{color:r?"gray":t.color},children:e})}}),Z.map(((e,t)=>(0,P.jsx)(u.y,{dataKey:e,fill:q[t%q.length],hide:V.includes(e),maxBarSize:ae,stackId:"a",children:U&&(0,P.jsx)(p.Z,{dataKey:e,position:"top",fill:"black",fontSize:10,offset:10})},e)))]})})]})]})}},49249:(e,t,r)=>{r.r(t),r.d(t,{default:()=>v});var a=r(87233),n=r(4139),i=r(12257),o=r(95537),s=r(9950),l=r(14351),c=r(62054),d=r(71826),u=r(94826),p=r(73961),h=r(1092),x=r(35377),m=r(44414);const v=()=>{var e,t,r,v,g,y;const[A,f]=(0,s.useState)(null),j=(0,s.useCallback)((async()=>{var e;const t=await(0,d.default)("/site-exception-report",{method:"GET"});var r;t.success?f(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.data):(0,c.A)((null===(r=t.error)||void 0===r?void 0:r.message)||"Something went wrong!",{variant:"error"})}),[]);(0,s.useEffect)((()=>{j()}),[j]);const b=(()=>{var e;const t=null===A||void 0===A||null===(e=A.wcSurveyStatsData)||void 0===e?void 0:e[0];if(!t||"object"!==typeof t)return[];const r=t["Reason for Non Survey"]||{};return"object"!==typeof r?[]:Object.entries(r).map((e=>{let[t,r]=e;return{key:t,value:r}}))})(),C=(()=>{var e;const t=null===A||void 0===A||null===(e=A.wcSurveyStatsData)||void 0===e?void 0:e[0];if(!t||"object"!==typeof t)return[];const r=t["Meter Location"]||{};if("object"!==typeof r)return[];const a=Object.values(r).reduce(((e,t)=>e+t),0);return Object.keys(r).map((e=>({name:e.replace(/_/g," "),value:r[e],percentage:(r[e]/a*100).toFixed(2)})))})(),S=(()=>{var e;const t=null===A||void 0===A||null===(e=A.wcSurveyStatsData)||void 0===e?void 0:e[0];if(!t||"object"!==typeof t)return[];const r=t["Type of Premises"]||{};return Object.keys(r).map((e=>({key:e.replace(/_/g," "),value:r[e]})))})();return(0,m.jsxs)(l.A,{sx:{mb:2},children:[(0,m.jsx)(a.A,{sx:{backgroundColor:"#203764",color:"#fff",py:1,fontSize:18,textAlign:"center",fontWeight:"bold"},children:"Site Condition Cum Exception Dashboard"}),A?(0,m.jsxs)(n.Ay,{container:!0,spacing:2,children:[(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsxs)(i.A,{direction:"row",bgcolor:"#0070c0",sx:{p:1,mt:2,display:"flex",justifyContent:"space-between",gap:1},children:[(0,m.jsx)(a.A,{variant:"h5",color:"common.white",children:"DT Site Condition"}),(0,m.jsxs)(a.A,{variant:"h5",color:"common.white",children:["Total Records: ",null===(e=A.dtSurveyStatsData)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.total_records]})]})}),Object.keys(null===(r=A.dtSurveyStatsData)||void 0===r?void 0:r[0]).map((e=>{var t;return!["total_records"].includes(e)&&(0,m.jsx)(n.Ay,{item:!0,xs:12,md:6,children:(0,m.jsxs)(i.A,{direction:"row",sx:{p:1,height:"100%"},alignItems:"center",children:[(0,m.jsx)(a.A,{sx:{flex:.25},textTransform:"capitalize",variant:"h6",children:e.replace(/_/g," ")}),(0,m.jsx)(i.A,{sx:{flex:.75},direction:"row",flexWrap:"wrap",children:(0,m.jsx)(n.Ay,{container:!0,spacing:0,children:Object.keys(null===(t=A.dtSurveyStatsData)||void 0===t?void 0:t[0][e]).map((t=>{var r;return(0,m.jsxs)(n.Ay,{item:!0,sx:{flex:1},children:[(0,m.jsx)(a.A,{whiteSpace:"nowrap",textTransform:"capitalize",textAlign:"center",sx:{backgroundColor:"#00b050",color:"white"},children:t.replace(/_/g," ")}),(0,m.jsx)(a.A,{variant:"h6",textAlign:"center",sx:{backgroundColor:"#ffc000"},children:null===(r=A.dtSurveyStatsData)||void 0===r?void 0:r[0][e][t]})]},t)}))})})]})},e)})),(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsxs)(i.A,{direction:"row",bgcolor:"#0070c0",sx:{p:1,mt:2,display:"flex",justifyContent:"space-between",gap:1},children:[(0,m.jsx)(a.A,{variant:"h5",color:"common.white",children:"WC Consumer Site Condition"}),(0,m.jsxs)(a.A,{variant:"h5",color:"common.white",children:["Total Records: ",null===(v=A.wcSurveyStatsData)||void 0===v||null===(g=v[0])||void 0===g?void 0:g.total_records]})]})}),Object.keys(null===(y=A.wcSurveyStatsData)||void 0===y?void 0:y[0]).map((e=>{var t;return!["total_records","type of premises","reason for non survey","meter location"].includes(e.toLowerCase())&&(0,m.jsx)(n.Ay,{item:!0,xs:12,md:6,children:(0,m.jsxs)(i.A,{direction:"row",sx:{p:1,height:"100%"},alignItems:"center",children:[(0,m.jsx)(a.A,{sx:{flex:.25},textTransform:"capitalize",variant:"h6",children:e.replace(/_/g," ")}),(0,m.jsx)(i.A,{sx:{flex:.75},direction:"row",flexWrap:"wrap",children:(0,m.jsx)(n.Ay,{container:!0,spacing:0,children:Object.keys(null===(t=A.wcSurveyStatsData)||void 0===t?void 0:t[0][e]).map((t=>{var r;return(0,m.jsxs)(n.Ay,{item:!0,sx:{flex:1},children:[(0,m.jsx)(a.A,{whiteSpace:"nowrap",textTransform:"capitalize",textAlign:"center",sx:{backgroundColor:"#00b050",color:"white"},children:t.replace(/_/g," ")}),(0,m.jsx)(a.A,{variant:"h6",textAlign:"center",sx:{backgroundColor:"#ffc000"},children:null===(r=A.wcSurveyStatsData)||void 0===r?void 0:r[0][e][t]})]},t)}))})})]})},e)})),(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsxs)(n.Ay,{container:!0,spacing:2,children:[(0,m.jsx)(n.Ay,{item:!0,xs:6,children:(0,m.jsx)(o.A,{width:"100%",children:(0,m.jsx)(x.A,{chartData:b,yAxis:"key",title:"Reason for Non Survey",height:267})})}),(0,m.jsx)(n.Ay,{item:!0,xs:6,children:(0,m.jsx)(o.A,{width:"100%",sx:{height:0===(null===C||void 0===C?void 0:C.length)?300:null,mb:0===(null===C||void 0===C?void 0:C.length)?5:null},children:(0,m.jsx)(h.A,{data:C,nameKey:"name",title:"Meter Location"})})})]})}),(0,m.jsx)(n.Ay,{item:!0,xs:12,children:(0,m.jsx)(p.A,{chartData:S,xAxis:"key",title:"Type of Premises",height:480})})]}):(0,m.jsx)(o.A,{sx:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,m.jsx)(u.A,{})})]})}},27987:(e,t,r)=>{r.d(t,{A:()=>C});var a=r(98587),n=r(58168),i=r(9950),o=r(72004),s=r(88465),l=r(99269),c=r(59254),d=r(19608),u=r(18463),p=r(13372),h=r(17706),x=r(79044),m=r(31506),v=r(40777),g=r(92455),y=r(88543),A=r(72359),f=r(44414);const j=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],b=(0,c.Ay)(h.A,{shouldForwardProp:e=>(0,d.A)(e)||"classes"===e,name:"MuiMenuItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.dense&&t.dense,r.divider&&t.divider,!r.disableGutters&&t.gutters]}})((e=>{let{theme:t,ownerState:r}=e;return(0,n.A)({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!r.disableGutters&&{paddingLeft:16,paddingRight:16},r.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${A.A.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,l.X4)(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${A.A.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,l.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${A.A.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:(0,l.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,l.X4)(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${A.A.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${A.A.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${v.A.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${v.A.inset}`]:{marginLeft:52},[`& .${y.A.root}`]:{marginTop:0,marginBottom:0},[`& .${y.A.inset}`]:{paddingLeft:36},[`& .${g.A.root}`]:{minWidth:36}},!r.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},r.dense&&(0,n.A)({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2,{[`& .${g.A.root} svg`]:{fontSize:"1.25rem"}}))})),C=i.forwardRef((function(e,t){const r=(0,u.b)({props:e,name:"MuiMenuItem"}),{autoFocus:l=!1,component:c="li",dense:d=!1,divider:h=!1,disableGutters:v=!1,focusVisibleClassName:g,role:y="menuitem",tabIndex:C,className:S}=r,w=(0,a.A)(r,j),k=i.useContext(p.A),$=i.useMemo((()=>({dense:d||k.dense||!1,disableGutters:v})),[k.dense,d,v]),D=i.useRef(null);(0,x.A)((()=>{l&&D.current&&D.current.focus()}),[l]);const _=(0,n.A)({},r,{dense:$.dense,divider:h,disableGutters:v}),T=(e=>{const{disabled:t,dense:r,divider:a,disableGutters:i,selected:o,classes:l}=e,c={root:["root",r&&"dense",t&&"disabled",!i&&"gutters",a&&"divider",o&&"selected"]},d=(0,s.A)(c,A.Z,l);return(0,n.A)({},l,d)})(r),O=(0,m.A)(D,t);let I;return r.disabled||(I=void 0!==C?C:-1),(0,f.jsx)(p.A.Provider,{value:$,children:(0,f.jsx)(b,(0,n.A)({ref:O,role:y,tabIndex:I,component:c,focusVisibleClassName:(0,o.A)(T.focusVisible,g),className:(0,o.A)(T.root,S)},w,{ownerState:_,classes:T}))})}))},72359:(e,t,r)=>{r.d(t,{A:()=>o,Z:()=>i});var a=r(1763),n=r(423);function i(e){return(0,n.Ay)("MuiMenuItem",e)}const o=(0,a.A)("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"])}}]);