"use strict";(self.webpackChunkgenus_power=self.webpackChunkgenus_power||[]).push([[3609],{63609:(e,n,s)=>{s.r(n),s.d(n,{default:()=>O});var a=s(9950),i=s(27081),o=s(28429),t=s(4139),r=s(67535),d=s(74745),l=s(60666),u=s(9449),c=s(26473),m=s(71826),p=s(88848),g=s(55519),v=s(66004),h=s(80733),x=s(22149),j=s(96951),A=s(14351),I=s(84601),S=s(62054),b=s(29024),y=s(99635),z=s(89649),f=s(44414);const O=()=>{var e;const n=(0,o.Zp)(),s=(0,i.wA)(),{paginations:{pageSize:O,pageIndex:w},setPageIndex:T,setPageSize:k}=(0,z.A)(),[C,D]=(0,a.useState)([]),[P,E]=(0,a.useState)(""),[H,N]=(0,a.useState)(""),[q,F]=(0,a.useState)([]),[L,M]=(0,a.useState)(""),[U,B]=(0,a.useState)([]),[G,Y]=(0,a.useState)([]),[R,V]=(0,a.useState)([]),[_,Z]=(0,a.useState)(0),{organizationsDropdown:$,organizationsDropdownSecond:J}=(0,g.G)(),{projectsDropdown:K}=(0,h.Y)(),{masterMakerOrgType:Q}=(0,p.$)(),{users:W,usersSecond:X}=(0,v.k)(),{supervisorAssignments:ee}=(0,x.c)(),ne=null===K||void 0===K?void 0:K.projectsDropdownObject,se=null===Q||void 0===Q?void 0:Q.masterObject,ae=null===$||void 0===$?void 0:$.organizationDropdownObject,ie=(null===J||void 0===J||null===(e=J.organizationDropdownSecondObject)||void 0===e?void 0:e.rows)||[],{supervisorAssignmentData:oe,supervisorAssignmentCount:te}=(0,a.useMemo)((()=>{var e,n;return{supervisorAssignmentData:(null===(e=ee.supervisorAssignmentsObject)||void 0===e?void 0:e.rows)||[],supervisorAssignmentCount:(null===(n=ee.supervisorAssignmentsObject)||void 0===n?void 0:n.count)||0,isLoading:ee.loading||!1}}),[ee]),re=(0,u.mN)({resolver:(0,c.t)(l.Ik().shape({projectId:I.A.other,oraganizationType:I.A.other,oraganizationId:I.A.other,supervisorId:I.A.other})),defaultValues:{},mode:"all"}),{handleSubmit:de,setValue:le}=re,ue=(0,a.useMemo)((()=>[{Header:"Name",accessor:"name"},{Header:"Code",accessor:"code"},{Header:"Email",accessor:"email"},{Header:"Contact",accessor:"mobileNumber"}]),[]),ce=(0,a.useMemo)((()=>[{Header:"Name",accessor:"user.name"},{Header:"Supervisor Name",accessor:"supervisor.name"},{Header:"Applicable Date",accessor:"dateFrom"}]),[]);(0,a.useEffect)((()=>{s((0,b.uiG)()),s((0,b._G1)()),s((0,b.VOH)("ORGANIZATION TYPE"))}),[s]),(0,a.useEffect)((()=>{L&&null!==C&&void 0!==C&&C.length&&s((0,b.loF)({organizationId:L,projectId:C}))}),[s,L,C]),(0,a.useEffect)((()=>{P&&s((0,b.dMt)({pageIndex:w,pageSize:O,supervisorId:P}))}),[s,w,O,P]),(0,a.useEffect)((()=>{null!==U&&void 0!==U&&U.length&&null!==C&&void 0!==C&&C.length&&s((0,b.Thx)({organizationId:U,projectId:C,pageIndex:w,pageSize:O}))}),[s,U,C,w,O,P]);const{data:me,secondUsersData:pe,countUsers:ge}=(0,a.useMemo)((()=>{var e,n,s;return{data:(null===W||void 0===W||null===(e=W.usersObject)||void 0===e?void 0:e.rows)||[],secondUsersData:(null===X||void 0===X||null===(n=X.usersObject)||void 0===n?void 0:n.rows)||[],countUsers:(null===X||void 0===X||null===(s=X.usersObject)||void 0===s?void 0:s.count)||0}}),[W,X]);(0,a.useEffect)((()=>{const e=pe.filter((e=>e.id!==re.watch("supervisorId")&&e.supervisorId!==re.watch("supervisorId")));V(e),Z(ge)}),[pe,ge,re]),(0,a.useEffect)((()=>{H&&s((0,b.d8s)(H))}),[s,H]),(0,a.useEffect)((()=>{null!==q&&void 0!==q&&q.length&&s((0,b.fTs)({organizationTypeId:q,multiId:!0}))}),[s,q]),(0,a.useEffect)((()=>{le("dateFrom",(new Date).toISOString().slice(0,10))}),[le]);const ve=()=>{N(),M(),Y([]),re.reset(),n("/supervisor-assignment")},he=(e,n)=>{var s;"oraganizationType"===e?N(null===(s=n.target)||void 0===s?void 0:s.value):"oraganizationTypeSecond"===e&&F(n)},xe=(e,n)=>{var s;"oraganizationId"===e?M(null===(s=n.target)||void 0===s?void 0:s.value):"oraganizationIdSecond"===e&&B(n)};return(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(j.Op,{methods:re,onSubmit:de((async e=>{let n;if(e.userId=G,delete e.projectIdSecond,delete e.oraganizationTypeSecond,delete e.oraganizationIdSecond,n=await(0,m.default)("/supervisor-assignments-create",{method:"POST",body:{supervisorAssignmentsDetails:e}}),n.success){const e="Supervisor Assignment added successfully!";(0,S.A)(e,{variant:"success",autoHideDuration:1e4}),ve()}else{var s,a;(0,S.A)((null===(s=n)||void 0===s||null===(a=s.error)||void 0===a?void 0:a.message)||"Operation failed. Please try again.",{variant:"error"})}})),children:(0,f.jsx)(A.A,{title:"Assign Supervisor",sx:{mb:2},children:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(t.Ay,{container:!0,spacing:4,children:[(0,f.jsx)(t.Ay,{item:!0,md:3,xl:3,children:(0,f.jsx)(j.eu,{name:"projectId",label:"Project",InputLabelProps:{shrink:!0},menus:ne,onChange:e=>{var n;D([null===(n=e.target)||void 0===n?void 0:n.value])},required:!0})}),(0,f.jsx)(t.Ay,{item:!0,md:3,xl:3,children:(0,f.jsx)(j.eu,{name:"oraganizationType",label:"Organization Type",InputLabelProps:{shrink:!0},menus:se,onChange:he.bind(void 0,"oraganizationType"),required:!0})}),(0,f.jsx)(t.Ay,{item:!0,md:3,xl:3,children:(0,f.jsx)(j.eu,{name:"oraganizationId",label:"Organization Name",InputLabelProps:{shrink:!0},menus:H?ae:[],onChange:xe.bind(void 0,"oraganizationId"),required:!0})}),(0,f.jsx)(t.Ay,{item:!0,md:3,xl:3,children:(0,f.jsx)(j.eu,{name:"supervisorId",label:"Supervisor",InputLabelProps:{shrink:!0},menus:L?me.filter((e=>{let{supervisorId:n}=e;return!n})):[],onChange:e=>{var n;E(null===(n=e.target)||void 0===n?void 0:n.value)},required:!0})}),(0,f.jsx)(t.Ay,{item:!0,md:3,xl:3,children:(0,f.jsx)(j.o3,{name:"dateFrom",label:"Applicable Date",type:"date",required:!0,InputLabelProps:{shrink:!0}})}),(0,f.jsx)(t.Ay,{item:!0,xs:9,sx:{display:"flex",justifyContent:"flex-end",mt:3},children:(0,f.jsxs)(t.Ay,{item:!0,sx:{display:"flex",alignItems:"center",gap:"20px"},children:[(0,f.jsx)(r.A,{size:"small",type:"submit",variant:"contained",color:"primary",children:"Save"}),(0,f.jsx)(r.A,{size:"small",variant:"outlined",color:"primary",onClick:ve,children:"Back"})]})})]}),(0,f.jsx)(t.Ay,{container:!0,sx:{mt:3,mb:3},children:(0,f.jsx)(t.Ay,{item:!0,md:12,xl:12,children:(0,f.jsx)(d.A,{})})}),(0,f.jsxs)(t.Ay,{container:!0,spacing:4,children:[(0,f.jsx)(t.Ay,{item:!0,md:6,xl:6,children:(0,f.jsx)(j.Yq,{name:"oraganizationTypeSecond",label:"Organization Type",menus:se,onChange:he.bind(void 0,"oraganizationTypeSecond")})}),(0,f.jsx)(t.Ay,{item:!0,md:6,xl:6,children:(0,f.jsx)(j.Yq,{name:"oraganizationIdSecond",label:"Organization Name",menus:null!==q&&void 0!==q&&q.length?ie:[],onChange:xe.bind(void 0,"oraganizationIdSecond")})})]}),(0,f.jsx)(t.Ay,{item:!0,md:12,sx:{mr:2,mt:4},children:null!==U&&void 0!==U&&U.length&&null!==C&&void 0!==C&&C.length?(0,f.jsx)(y.default,{title:"Select Users",hideAddButton:!0,hideExportButton:!0,hideActions:!0,data:null!==U&&void 0!==U&&U.length?R:[],columns:ue,count:null!==U&&void 0!==U&&U.length?_:0,showCheckbox:!0,selectedRecord:G,setSelectedRecords:Y,setPageIndex:T,setPageSize:k,pageIndex:w,pageSize:O}):""}),(0,f.jsx)(t.Ay,{item:!0,md:12,sx:{mr:2,mt:4},children:P&&(0,f.jsx)(y.default,{title:"Assigned Users",hideActions:!0,hideAddButton:!0,hideExportButton:!0,data:oe,columns:ce,count:te,setPageIndex:T,setPageSize:k,pageIndex:w,pageSize:O})})]})})})})}}}]);